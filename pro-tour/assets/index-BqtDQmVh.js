var hl=Object.defineProperty;var Wr=i=>{throw TypeError(i)};var fl=(i,e,t)=>e in i?hl(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t;var re=(i,e,t)=>fl(i,typeof e!="symbol"?e+"":e,t),gl=(i,e,t)=>e.has(i)||Wr("Cannot "+t);var jr=(i,e,t)=>e.has(i)?Wr("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(i):e.set(i,t);var Nn=(i,e,t)=>(gl(i,e,"access private method"),t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(r){if(r.ep)return;r.ep=!0;const a=t(r);fetch(r.href,a)}})();const z=i=>typeof i=="string",jt=()=>{let i,e;const t=new Promise((n,r)=>{i=n,e=r});return t.resolve=i,t.reject=e,t},Vr=i=>i==null?"":""+i,pl=(i,e,t)=>{i.forEach(n=>{e[n]&&(t[n]=e[n])})},ml=/###/g,Kr=i=>i&&i.indexOf("###")>-1?i.replace(ml,"."):i,qr=i=>!i||z(i),an=(i,e,t)=>{const n=z(e)?e.split("."):e;let r=0;for(;r<n.length-1;){if(qr(i))return{};const a=Kr(n[r]);!i[a]&&t&&(i[a]=new t),Object.prototype.hasOwnProperty.call(i,a)?i=i[a]:i={},++r}return qr(i)?{}:{obj:i,k:Kr(n[r])}},Yr=(i,e,t)=>{const{obj:n,k:r}=an(i,e,Object);if(n!==void 0||e.length===1){n[r]=t;return}let a=e[e.length-1],o=e.slice(0,e.length-1),s=an(i,o,Object);for(;s.obj===void 0&&o.length;)a=`${o[o.length-1]}.${a}`,o=o.slice(0,o.length-1),s=an(i,o,Object),s&&s.obj&&typeof s.obj[`${s.k}.${a}`]<"u"&&(s.obj=void 0);s.obj[`${s.k}.${a}`]=t},bl=(i,e,t,n)=>{const{obj:r,k:a}=an(i,e,Object);r[a]=r[a]||[],r[a].push(t)},qn=(i,e)=>{const{obj:t,k:n}=an(i,e);if(t)return t[n]},yl=(i,e,t)=>{const n=qn(i,t);return n!==void 0?n:qn(e,t)},oo=(i,e,t)=>{for(const n in e)n!=="__proto__"&&n!=="constructor"&&(n in i?z(i[n])||i[n]instanceof String||z(e[n])||e[n]instanceof String?t&&(i[n]=e[n]):oo(i[n],e[n],t):i[n]=e[n]);return i},Tt=i=>i.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var vl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const _l=i=>z(i)?i.replace(/[&<>"'\/]/g,e=>vl[e]):i;class wl{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(t!==void 0)return t;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}const kl=[" ",",","?","!",";"],xl=new wl(20),Sl=(i,e,t)=>{e=e||"",t=t||"";const n=kl.filter(o=>e.indexOf(o)<0&&t.indexOf(o)<0);if(n.length===0)return!0;const r=xl.getRegExp(`(${n.map(o=>o==="?"?"\\?":o).join("|")})`);let a=!r.test(i);if(!a){const o=i.indexOf(t);o>0&&!r.test(i.substring(0,o))&&(a=!0)}return a},Bi=function(i,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!i)return;if(i[e])return i[e];const n=e.split(t);let r=i;for(let a=0;a<n.length;){if(!r||typeof r!="object")return;let o,s="";for(let l=a;l<n.length;++l)if(l!==a&&(s+=t),s+=n[l],o=r[s],o!==void 0){if(["string","number","boolean"].indexOf(typeof o)>-1&&l<n.length-1)continue;a+=l-a+1;break}r=o}return r},Yn=i=>i&&i.replace("_","-"),El={type:"logger",log(i){this.output("log",i)},warn(i){this.output("warn",i)},error(i){this.output("error",i)},output(i,e){console&&console[i]&&console[i].apply(console,e)}};class Zn{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||El,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,r){return r&&!this.debug?null:(z(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Zn(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return e=e||this.options,e.prefix=e.prefix||this.prefix,new Zn(this.logger,e)}}var Ke=new Zn;let oi=class{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(n=>{this.observers[n]||(this.observers[n]=new Map);const r=this.observers[n].get(t)||0;this.observers[n].set(t,r+1)}),this}off(e,t){if(this.observers[e]){if(!t){delete this.observers[e];return}this.observers[e].delete(t)}}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.observers[e]&&Array.from(this.observers[e].entries()).forEach(o=>{let[s,l]=o;for(let u=0;u<l;u++)s(...n)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(o=>{let[s,l]=o;for(let u=0;u<l;u++)s.apply(s,[e,...n])})}};class Zr extends oi{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=r.keySeparator!==void 0?r.keySeparator:this.options.keySeparator,o=r.ignoreJSONStructure!==void 0?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let s;e.indexOf(".")>-1?s=e.split("."):(s=[e,t],n&&(Array.isArray(n)?s.push(...n):z(n)&&a?s.push(...n.split(a)):s.push(n)));const l=qn(this.data,s);return!l&&!t&&!n&&e.indexOf(".")>-1&&(e=s[0],t=s[1],n=s.slice(2).join(".")),l||!o||!z(n)?l:Bi(this.data&&this.data[e]&&this.data[e][t],n,a)}addResource(e,t,n,r){let a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const o=a.keySeparator!==void 0?a.keySeparator:this.options.keySeparator;let s=[e,t];n&&(s=s.concat(o?n.split(o):n)),e.indexOf(".")>-1&&(s=e.split("."),r=t,t=s[1]),this.addNamespaces(t),Yr(this.data,s,r),a.silent||this.emit("added",e,t,n,r)}addResources(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const a in n)(z(n[a])||Array.isArray(n[a]))&&this.addResource(e,t,a,n[a],{silent:!0});r.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,r,a){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},s=[e,t];e.indexOf(".")>-1&&(s=e.split("."),r=n,n=t,t=s[1]),this.addNamespaces(t);let l=qn(this.data,s)||{};o.skipCopy||(n=JSON.parse(JSON.stringify(n))),r?oo(l,n,a):l={...l,...n},Yr(this.data,s,l),o.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return this.getResource(e,t)!==void 0}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(r=>t[r]&&Object.keys(t[r]).length>0)}toJSON(){return this.data}}var so={processors:{},addPostProcessor(i){this.processors[i.name]=i},handle(i,e,t,n,r){return i.forEach(a=>{this.processors[a]&&(e=this.processors[a].process(e,t,n,r))}),e}};const Jr={};class Jn extends oi{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),pl(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=Ke.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(e==null)return!1;const n=this.resolve(e,t);return n&&n.res!==void 0}extractFromKey(e,t){let n=t.nsSeparator!==void 0?t.nsSeparator:this.options.nsSeparator;n===void 0&&(n=":");const r=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator;let a=t.ns||this.options.defaultNS||[];const o=n&&e.indexOf(n)>-1,s=!this.options.userDefinedKeySeparator&&!t.keySeparator&&!this.options.userDefinedNsSeparator&&!t.nsSeparator&&!Sl(e,n,r);if(o&&!s){const l=e.match(this.interpolator.nestingRegexp);if(l&&l.length>0)return{key:e,namespaces:z(a)?[a]:a};const u=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(u[0])>-1)&&(a=u.shift()),e=u.join(r)}return{key:e,namespaces:z(a)?[a]:a}}translate(e,t,n){if(typeof t!="object"&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),typeof t=="object"&&(t={...t}),t||(t={}),e==null)return"";Array.isArray(e)||(e=[String(e)]);const r=t.returnDetails!==void 0?t.returnDetails:this.options.returnDetails,a=t.keySeparator!==void 0?t.keySeparator:this.options.keySeparator,{key:o,namespaces:s}=this.extractFromKey(e[e.length-1],t),l=s[s.length-1],u=t.lng||this.language,c=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(u&&u.toLowerCase()==="cimode"){if(c){const g=t.nsSeparator||this.options.nsSeparator;return r?{res:`${l}${g}${o}`,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:`${l}${g}${o}`}return r?{res:o,usedKey:o,exactUsedKey:o,usedLng:u,usedNS:l,usedParams:this.getUsedParamsDetails(t)}:o}const d=this.resolve(e,t);let h=d&&d.res;const f=d&&d.usedKey||o,p=d&&d.exactUsedKey||o,m=Object.prototype.toString.apply(h),y=["[object Number]","[object Function]","[object RegExp]"],k=t.joinArrays!==void 0?t.joinArrays:this.options.joinArrays,v=!this.i18nFormat||this.i18nFormat.handleAsObject,b=!z(h)&&typeof h!="boolean"&&typeof h!="number";if(v&&h&&b&&y.indexOf(m)<0&&!(z(k)&&Array.isArray(h))){if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const g=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,h,{...t,ns:s}):`key '${o} (${this.language})' returned an object instead of string.`;return r?(d.res=g,d.usedParams=this.getUsedParamsDetails(t),d):g}if(a){const g=Array.isArray(h),w=g?[]:{},_=g?p:f;for(const x in h)if(Object.prototype.hasOwnProperty.call(h,x)){const S=`${_}${a}${x}`;w[x]=this.translate(S,{...t,joinArrays:!1,ns:s}),w[x]===S&&(w[x]=h[x])}h=w}}else if(v&&z(k)&&Array.isArray(h))h=h.join(k),h&&(h=this.extendTranslation(h,e,t,n));else{let g=!1,w=!1;const _=t.count!==void 0&&!z(t.count),x=Jn.hasDefaultValue(t),S=_?this.pluralResolver.getSuffix(u,t.count,t):"",N=t.ordinal&&_?this.pluralResolver.getSuffix(u,t.count,{ordinal:!1}):"",L=_&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),M=L&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${S}`]||t[`defaultValue${N}`]||t.defaultValue;!this.isValidLookup(h)&&x&&(g=!0,h=M),this.isValidLookup(h)||(w=!0,h=o);const A=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&w?void 0:h,F=x&&M!==h&&this.options.updateMissing;if(w||g||F){if(this.logger.log(F?"updateKey":"missingKey",u,l,o,F?M:h),a){const P=this.resolve(o,{...t,keySeparator:!1});P&&P.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let G=[];const W=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if(this.options.saveMissingTo==="fallback"&&W&&W[0])for(let P=0;P<W.length;P++)G.push(W[P]);else this.options.saveMissingTo==="all"?G=this.languageUtils.toResolveHierarchy(t.lng||this.language):G.push(t.lng||this.language);const Z=(P,V,K)=>{const ne=x&&K!==h?K:A;this.options.missingKeyHandler?this.options.missingKeyHandler(P,l,V,ne,F,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(P,l,V,ne,F,t),this.emit("missingKey",P,l,V,h)};this.options.saveMissing&&(this.options.saveMissingPlurals&&_?G.forEach(P=>{const V=this.pluralResolver.getSuffixes(P,t);L&&t[`defaultValue${this.options.pluralSeparator}zero`]&&V.indexOf(`${this.options.pluralSeparator}zero`)<0&&V.push(`${this.options.pluralSeparator}zero`),V.forEach(K=>{Z([P],o+K,t[`defaultValue${K}`]||M)})}):Z(G,o,M))}h=this.extendTranslation(h,e,t,d,n),w&&h===o&&this.options.appendNamespaceToMissingKey&&(h=`${l}:${o}`),(w||g)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?h=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${l}:${o}`:o,g?h:void 0):h=this.options.parseMissingKeyHandler(h))}return r?(d.res=h,d.usedParams=this.getUsedParamsDetails(t),d):h}extendTranslation(e,t,n,r,a){var o=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...n},n.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init({...n,interpolation:{...this.options.interpolation,...n.interpolation}});const u=z(e)&&(n&&n.interpolation&&n.interpolation.skipOnVariables!==void 0?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let c;if(u){const h=e.match(this.interpolator.nestingRegexp);c=h&&h.length}let d=n.replace&&!z(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(d={...this.options.interpolation.defaultVariables,...d}),e=this.interpolator.interpolate(e,d,n.lng||this.language||r.usedLng,n),u){const h=e.match(this.interpolator.nestingRegexp),f=h&&h.length;c<f&&(n.nest=!1)}!n.lng&&this.options.compatibilityAPI!=="v1"&&r&&r.res&&(n.lng=this.language||r.usedLng),n.nest!==!1&&(e=this.interpolator.nest(e,function(){for(var h=arguments.length,f=new Array(h),p=0;p<h;p++)f[p]=arguments[p];return a&&a[0]===f[0]&&!n.context?(o.logger.warn(`It seems you are nesting recursively key: ${f[0]} in key: ${t[0]}`),null):o.translate(...f,t)},n)),n.interpolation&&this.interpolator.reset()}const s=n.postProcess||this.options.postProcess,l=z(s)?[s]:s;return e!=null&&l&&l.length&&n.applyPostProcessor!==!1&&(e=so.handle(l,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...r,usedParams:this.getUsedParamsDetails(n)},...n}:n,this)),e}resolve(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n,r,a,o,s;return z(e)&&(e=[e]),e.forEach(l=>{if(this.isValidLookup(n))return;const u=this.extractFromKey(l,t),c=u.key;r=c;let d=u.namespaces;this.options.fallbackNS&&(d=d.concat(this.options.fallbackNS));const h=t.count!==void 0&&!z(t.count),f=h&&!t.ordinal&&t.count===0&&this.pluralResolver.shouldUseIntlApi(),p=t.context!==void 0&&(z(t.context)||typeof t.context=="number")&&t.context!=="",m=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);d.forEach(y=>{this.isValidLookup(n)||(s=y,!Jr[`${m[0]}-${y}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(s)&&(Jr[`${m[0]}-${y}`]=!0,this.logger.warn(`key "${r}" for languages "${m.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),m.forEach(k=>{if(this.isValidLookup(n))return;o=k;const v=[c];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(v,c,k,y,t);else{let g;h&&(g=this.pluralResolver.getSuffix(k,t.count,t));const w=`${this.options.pluralSeparator}zero`,_=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(h&&(v.push(c+g),t.ordinal&&g.indexOf(_)===0&&v.push(c+g.replace(_,this.options.pluralSeparator)),f&&v.push(c+w)),p){const x=`${c}${this.options.contextSeparator}${t.context}`;v.push(x),h&&(v.push(x+g),t.ordinal&&g.indexOf(_)===0&&v.push(x+g.replace(_,this.options.pluralSeparator)),f&&v.push(x+w))}}let b;for(;b=v.pop();)this.isValidLookup(n)||(a=b,n=this.getResource(k,y,b,t))}))})}),{res:n,usedKey:r,exactUsedKey:a,usedLng:o,usedNS:s}}isValidLookup(e){return e!==void 0&&!(!this.options.returnNull&&e===null)&&!(!this.options.returnEmptyString&&e==="")}getResource(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}getUsedParamsDetails(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!z(e.replace);let r=n?e.replace:e;if(n&&typeof e.count<"u"&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r={...this.options.interpolation.defaultVariables,...r}),!n){r={...r};for(const a of t)delete r[a]}return r}static hasDefaultValue(e){const t="defaultValue";for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t===n.substring(0,t.length)&&e[n]!==void 0)return!0;return!1}}const xi=i=>i.charAt(0).toUpperCase()+i.slice(1);class Xr{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Ke.create("languageUtils")}getScriptPartFromCode(e){if(e=Yn(e),!e||e.indexOf("-")<0)return null;const t=e.split("-");return t.length===2||(t.pop(),t[t.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(t.join("-"))}getLanguagePartFromCode(e){if(e=Yn(e),!e||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(z(e)&&e.indexOf("-")>-1){if(typeof Intl<"u"&&typeof Intl.getCanonicalLocales<"u")try{let r=Intl.getCanonicalLocales(e)[0];if(r&&this.options.lowerCaseLng&&(r=r.toLowerCase()),r)return r}catch{}const t=["hans","hant","latn","cyrl","cans","mong","arab"];let n=e.split("-");return this.options.lowerCaseLng?n=n.map(r=>r.toLowerCase()):n.length===2?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=xi(n[1].toLowerCase()))):n.length===3&&(n[0]=n[0].toLowerCase(),n[1].length===2&&(n[1]=n[1].toUpperCase()),n[0]!=="sgn"&&n[2].length===2&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=xi(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=xi(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(n=>{if(t)return;const r=this.formatLanguageCode(n);(!this.options.supportedLngs||this.isSupportedCode(r))&&(t=r)}),!t&&this.options.supportedLngs&&e.forEach(n=>{if(t)return;const r=this.getLanguagePartFromCode(n);if(this.isSupportedCode(r))return t=r;t=this.options.supportedLngs.find(a=>{if(a===r)return a;if(!(a.indexOf("-")<0&&r.indexOf("-")<0)&&(a.indexOf("-")>0&&r.indexOf("-")<0&&a.substring(0,a.indexOf("-"))===r||a.indexOf(r)===0&&r.length>1))return a})}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if(typeof e=="function"&&(e=e(t)),z(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){const n=this.getFallbackCodes(t||this.options.fallbackLng||[],e),r=[],a=o=>{o&&(this.isSupportedCode(o)?r.push(o):this.logger.warn(`rejecting language code not found in supportedLngs: ${o}`))};return z(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&a(this.formatLanguageCode(e)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&a(this.getScriptPartFromCode(e)),this.options.load!=="currentOnly"&&a(this.getLanguagePartFromCode(e))):z(e)&&a(this.formatLanguageCode(e)),n.forEach(o=>{r.indexOf(o)<0&&a(this.formatLanguageCode(o))}),r}}let Tl=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Cl={1:i=>+(i>1),2:i=>+(i!=1),3:i=>0,4:i=>i%10==1&&i%100!=11?0:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?1:2,5:i=>i==0?0:i==1?1:i==2?2:i%100>=3&&i%100<=10?3:i%100>=11?4:5,6:i=>i==1?0:i>=2&&i<=4?1:2,7:i=>i==1?0:i%10>=2&&i%10<=4&&(i%100<10||i%100>=20)?1:2,8:i=>i==1?0:i==2?1:i!=8&&i!=11?2:3,9:i=>+(i>=2),10:i=>i==1?0:i==2?1:i<7?2:i<11?3:4,11:i=>i==1||i==11?0:i==2||i==12?1:i>2&&i<20?2:3,12:i=>+(i%10!=1||i%100==11),13:i=>+(i!==0),14:i=>i==1?0:i==2?1:i==3?2:3,15:i=>i%10==1&&i%100!=11?0:i%10>=2&&(i%100<10||i%100>=20)?1:2,16:i=>i%10==1&&i%100!=11?0:i!==0?1:2,17:i=>i==1||i%10==1&&i%100!=11?0:1,18:i=>i==0?0:i==1?1:2,19:i=>i==1?0:i==0||i%100>1&&i%100<11?1:i%100>10&&i%100<20?2:3,20:i=>i==1?0:i==0||i%100>0&&i%100<20?1:2,21:i=>i%100==1?1:i%100==2?2:i%100==3||i%100==4?3:0,22:i=>i==1?0:i==2?1:(i<0||i>10)&&i%10==0?2:3};const Nl=["v1","v2","v3"],Al=["v4"],Qr={zero:0,one:1,two:2,few:3,many:4,other:5},Ll=()=>{const i={};return Tl.forEach(e=>{e.lngs.forEach(t=>{i[t]={numbers:e.nr,plurals:Cl[e.fc]}})}),i};class Dl{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=Ke.create("pluralResolver"),(!this.options.compatibilityJSON||Al.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=Ll(),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi()){const n=Yn(e==="dev"?"en":e),r=t.ordinal?"ordinal":"cardinal",a=JSON.stringify({cleanedCode:n,type:r});if(a in this.pluralRulesCache)return this.pluralRulesCache[a];let o;try{o=new Intl.PluralRules(n,{type:r})}catch{if(!e.match(/-|_/))return;const l=this.languageUtils.getLanguagePartFromCode(e);o=this.getRule(l,t)}return this.pluralRulesCache[a]=o,o}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}getPluralFormsOfKey(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(e,n).map(r=>`${t}${r}`)}getSuffixes(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=this.getRule(e,t);return n?this.shouldUseIntlApi()?n.resolvedOptions().pluralCategories.sort((r,a)=>Qr[r]-Qr[a]).map(r=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${r}`):n.numbers.map(r=>this.getSuffix(e,r,t)):[]}getSuffix(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=this.getRule(e,n);return r?this.shouldUseIntlApi()?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r.select(t)}`:this.getSuffixRetroCompatible(r,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const n=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let r=e.numbers[n];this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1&&(r===2?r="plural":r===1&&(r=""));const a=()=>this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString();return this.options.compatibilityJSON==="v1"?r===1?"":typeof r=="number"?`_plural_${r.toString()}`:a():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&e.numbers.length===2&&e.numbers[0]===1?a():this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString()}shouldUseIntlApi(){return!Nl.includes(this.options.compatibilityJSON)}}const ea=function(i,e,t){let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,a=yl(i,e,t);return!a&&r&&z(t)&&(a=Bi(i,t,n),a===void 0&&(a=Bi(e,t,n))),a},Si=i=>i.replace(/\$/g,"$$$$");class Fl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ke.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(t=>t),this.init(e)}init(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:n,useRawValueToEscape:r,prefix:a,prefixEscaped:o,suffix:s,suffixEscaped:l,formatSeparator:u,unescapeSuffix:c,unescapePrefix:d,nestingPrefix:h,nestingPrefixEscaped:f,nestingSuffix:p,nestingSuffixEscaped:m,nestingOptionsSeparator:y,maxReplaces:k,alwaysFormat:v}=e.interpolation;this.escape=t!==void 0?t:_l,this.escapeValue=n!==void 0?n:!0,this.useRawValueToEscape=r!==void 0?r:!1,this.prefix=a?Tt(a):o||"{{",this.suffix=s?Tt(s):l||"}}",this.formatSeparator=u||",",this.unescapePrefix=c?"":d||"-",this.unescapeSuffix=this.unescapePrefix?"":c||"",this.nestingPrefix=h?Tt(h):f||Tt("$t("),this.nestingSuffix=p?Tt(p):m||Tt(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=k||1e3,this.alwaysFormat=v!==void 0?v:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(t,n)=>t&&t.source===n?(t.lastIndex=0,t):new RegExp(n,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,n,r){let a,o,s;const l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},u=f=>{if(f.indexOf(this.formatSeparator)<0){const k=ea(t,l,f,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(k,void 0,n,{...r,...t,interpolationkey:f}):k}const p=f.split(this.formatSeparator),m=p.shift().trim(),y=p.join(this.formatSeparator).trim();return this.format(ea(t,l,m,this.options.keySeparator,this.options.ignoreJSONStructure),y,n,{...r,...t,interpolationkey:m})};this.resetRegExp();const c=r&&r.missingInterpolationHandler||this.options.missingInterpolationHandler,d=r&&r.interpolation&&r.interpolation.skipOnVariables!==void 0?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:f=>Si(f)},{regex:this.regexp,safeValue:f=>this.escapeValue?Si(this.escape(f)):Si(f)}].forEach(f=>{for(s=0;a=f.regex.exec(e);){const p=a[1].trim();if(o=u(p),o===void 0)if(typeof c=="function"){const y=c(e,a,r);o=z(y)?y:""}else if(r&&Object.prototype.hasOwnProperty.call(r,p))o="";else if(d){o=a[0];continue}else this.logger.warn(`missed to pass in variable ${p} for interpolating ${e}`),o="";else!z(o)&&!this.useRawValueToEscape&&(o=Vr(o));const m=f.safeValue(o);if(e=e.replace(a[0],m),d?(f.regex.lastIndex+=o.length,f.regex.lastIndex-=a[0].length):f.regex.lastIndex=0,s++,s>=this.maxReplaces)break}}),e}nest(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r,a,o;const s=(l,u)=>{const c=this.nestingOptionsSeparator;if(l.indexOf(c)<0)return l;const d=l.split(new RegExp(`${c}[ ]*{`));let h=`{${d[1]}`;l=d[0],h=this.interpolate(h,o);const f=h.match(/'/g),p=h.match(/"/g);(f&&f.length%2===0&&!p||p.length%2!==0)&&(h=h.replace(/'/g,'"'));try{o=JSON.parse(h),u&&(o={...u,...o})}catch(m){return this.logger.warn(`failed parsing options string in nesting for key ${l}`,m),`${l}${c}${h}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,l};for(;r=this.nestingRegexp.exec(e);){let l=[];o={...n},o=o.replace&&!z(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let u=!1;if(r[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(r[1])){const c=r[1].split(this.formatSeparator).map(d=>d.trim());r[1]=c.shift(),l=c,u=!0}if(a=t(s.call(this,r[1].trim(),o),o),a&&r[0]===e&&!z(a))return a;z(a)||(a=Vr(a)),a||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),a=""),u&&(a=l.reduce((c,d)=>this.format(c,d,n.lng,{...n,interpolationkey:r[1].trim()}),a.trim())),e=e.replace(r[0],a),this.regexp.lastIndex=0}return e}}const Rl=i=>{let e=i.toLowerCase().trim();const t={};if(i.indexOf("(")>-1){const n=i.split("(");e=n[0].toLowerCase().trim();const r=n[1].substring(0,n[1].length-1);e==="currency"&&r.indexOf(":")<0?t.currency||(t.currency=r.trim()):e==="relativetime"&&r.indexOf(":")<0?t.range||(t.range=r.trim()):r.split(";").forEach(o=>{if(o){const[s,...l]=o.split(":"),u=l.join(":").trim().replace(/^'+|'+$/g,""),c=s.trim();t[c]||(t[c]=u),u==="false"&&(t[c]=!1),u==="true"&&(t[c]=!0),isNaN(u)||(t[c]=parseInt(u,10))}})}return{formatName:e,formatOptions:t}},Ct=i=>{const e={};return(t,n,r)=>{let a=r;r&&r.interpolationkey&&r.formatParams&&r.formatParams[r.interpolationkey]&&r[r.interpolationkey]&&(a={...a,[r.interpolationkey]:void 0});const o=n+JSON.stringify(a);let s=e[o];return s||(s=i(Yn(n),r),e[o]=s),s(t)}};class Ml{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=Ke.create("formatter"),this.options=e,this.formats={number:Ct((t,n)=>{const r=new Intl.NumberFormat(t,{...n});return a=>r.format(a)}),currency:Ct((t,n)=>{const r=new Intl.NumberFormat(t,{...n,style:"currency"});return a=>r.format(a)}),datetime:Ct((t,n)=>{const r=new Intl.DateTimeFormat(t,{...n});return a=>r.format(a)}),relativetime:Ct((t,n)=>{const r=new Intl.RelativeTimeFormat(t,{...n});return a=>r.format(a,n.range||"day")}),list:Ct((t,n)=>{const r=new Intl.ListFormat(t,{...n});return a=>r.format(a)})},this.init(e)}init(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=Ct(t)}format(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const a=t.split(this.formatSeparator);if(a.length>1&&a[0].indexOf("(")>1&&a[0].indexOf(")")<0&&a.find(s=>s.indexOf(")")>-1)){const s=a.findIndex(l=>l.indexOf(")")>-1);a[0]=[a[0],...a.splice(1,s)].join(this.formatSeparator)}return a.reduce((s,l)=>{const{formatName:u,formatOptions:c}=Rl(l);if(this.formats[u]){let d=s;try{const h=r&&r.formatParams&&r.formatParams[r.interpolationkey]||{},f=h.locale||h.lng||r.locale||r.lng||n;d=this.formats[u](s,f,{...c,...r,...h})}catch(h){this.logger.warn(h)}return d}else this.logger.warn(`there was no format function for ${u}`);return s},e)}}const Pl=(i,e)=>{i.pending[e]!==void 0&&(delete i.pending[e],i.pendingCount--)};class Il extends oi{constructor(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=r,this.logger=Ke.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(n,r.backend,r)}queueLoad(e,t,n,r){const a={},o={},s={},l={};return e.forEach(u=>{let c=!0;t.forEach(d=>{const h=`${u}|${d}`;!n.reload&&this.store.hasResourceBundle(u,d)?this.state[h]=2:this.state[h]<0||(this.state[h]===1?o[h]===void 0&&(o[h]=!0):(this.state[h]=1,c=!1,o[h]===void 0&&(o[h]=!0),a[h]===void 0&&(a[h]=!0),l[d]===void 0&&(l[d]=!0)))}),c||(s[u]=!0)}),(Object.keys(a).length||Object.keys(o).length)&&this.queue.push({pending:o,pendingCount:Object.keys(o).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(a),pending:Object.keys(o),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}loaded(e,t,n){const r=e.split("|"),a=r[0],o=r[1];t&&this.emit("failedLoading",a,o,t),!t&&n&&this.store.addResourceBundle(a,o,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);const s={};this.queue.forEach(l=>{bl(l.loaded,[a],o),Pl(l,e),t&&l.errors.push(t),l.pendingCount===0&&!l.done&&(Object.keys(l.loaded).forEach(u=>{s[u]||(s[u]={});const c=l.loaded[u];c.length&&c.forEach(d=>{s[u][d]===void 0&&(s[u][d]=!0)})}),l.done=!0,l.errors.length?l.callback(l.errors):l.callback())}),this.emit("loaded",s),this.queue=this.queue.filter(l=>!l.done)}read(e,t,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,o=arguments.length>5?arguments[5]:void 0;if(!e.length)return o(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:e,ns:t,fcName:n,tried:r,wait:a,callback:o});return}this.readingCalls++;const s=(u,c)=>{if(this.readingCalls--,this.waitingReads.length>0){const d=this.waitingReads.shift();this.read(d.lng,d.ns,d.fcName,d.tried,d.wait,d.callback)}if(u&&c&&r<this.maxRetries){setTimeout(()=>{this.read.call(this,e,t,n,r+1,a*2,o)},a);return}o(u,c)},l=this.backend[n].bind(this.backend);if(l.length===2){try{const u=l(e,t);u&&typeof u.then=="function"?u.then(c=>s(null,c)).catch(s):s(null,u)}catch(u){s(u)}return}return l(e,t,s)}prepareLoading(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},r=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();z(e)&&(e=this.languageUtils.toResolveHierarchy(e)),z(t)&&(t=[t]);const a=this.queueLoad(e,t,n,r);if(!a.toLoad.length)return a.pending.length||r(),null;a.toLoad.forEach(o=>{this.loadOne(o)})}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const n=e.split("|"),r=n[0],a=n[1];this.read(r,a,"read",void 0,void 0,(o,s)=>{o&&this.logger.warn(`${t}loading namespace ${a} for language ${r} failed`,o),!o&&s&&this.logger.log(`${t}loaded namespace ${a} for language ${r}`,s),this.loaded(e,o,s)})}saveMissing(e,t,n,r,a){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t)){this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(n==null||n==="")){if(this.backend&&this.backend.create){const l={...o,isUpdate:a},u=this.backend.create.bind(this.backend);if(u.length<6)try{let c;u.length===5?c=u(e,t,n,r,l):c=u(e,t,n,r),c&&typeof c.then=="function"?c.then(d=>s(null,d)).catch(s):s(null,c)}catch(c){s(c)}else u(e,t,n,r,s,l)}!e||!e[0]||this.store.addResource(e[0],t,n,r)}}}const ta=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:i=>{let e={};if(typeof i[1]=="object"&&(e=i[1]),z(i[1])&&(e.defaultValue=i[1]),z(i[2])&&(e.tDescription=i[2]),typeof i[2]=="object"||typeof i[3]=="object"){const t=i[3]||i[2];Object.keys(t).forEach(n=>{e[n]=t[n]})}return e},interpolation:{escapeValue:!0,format:i=>i,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),na=i=>(z(i.ns)&&(i.ns=[i.ns]),z(i.fallbackLng)&&(i.fallbackLng=[i.fallbackLng]),z(i.fallbackNS)&&(i.fallbackNS=[i.fallbackNS]),i.supportedLngs&&i.supportedLngs.indexOf("cimode")<0&&(i.supportedLngs=i.supportedLngs.concat(["cimode"])),i),An=()=>{},Gl=i=>{Object.getOwnPropertyNames(Object.getPrototypeOf(i)).forEach(t=>{typeof i[t]=="function"&&(i[t]=i[t].bind(i))})};class fn extends oi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;if(super(),this.options=na(e),this.services={},this.logger=Ke,this.modules={external:[]},Gl(this),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(){var e=this;let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof t=="function"&&(n=t,t={}),!t.defaultNS&&t.defaultNS!==!1&&t.ns&&(z(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const r=ta();this.options={...r,...this.options,...na(t)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...r.interpolation,...this.options.interpolation}),t.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=t.keySeparator),t.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=t.nsSeparator);const a=c=>c?typeof c=="function"?new c:c:null;if(!this.options.isClone){this.modules.logger?Ke.init(a(this.modules.logger),this.options):Ke.init(null,this.options);let c;this.modules.formatter?c=this.modules.formatter:typeof Intl<"u"&&(c=Ml);const d=new Xr(this.options);this.store=new Zr(this.options.resources,this.options);const h=this.services;h.logger=Ke,h.resourceStore=this.store,h.languageUtils=d,h.pluralResolver=new Dl(d,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),c&&(!this.options.interpolation.format||this.options.interpolation.format===r.interpolation.format)&&(h.formatter=a(c),h.formatter.init(h,this.options),this.options.interpolation.format=h.formatter.format.bind(h.formatter)),h.interpolator=new Fl(this.options),h.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},h.backendConnector=new Il(a(this.modules.backend),h.resourceStore,h,this.options),h.backendConnector.on("*",function(f){for(var p=arguments.length,m=new Array(p>1?p-1:0),y=1;y<p;y++)m[y-1]=arguments[y];e.emit(f,...m)}),this.modules.languageDetector&&(h.languageDetector=a(this.modules.languageDetector),h.languageDetector.init&&h.languageDetector.init(h,this.options.detection,this.options)),this.modules.i18nFormat&&(h.i18nFormat=a(this.modules.i18nFormat),h.i18nFormat.init&&h.i18nFormat.init(this)),this.translator=new Jn(this.services,this.options),this.translator.on("*",function(f){for(var p=arguments.length,m=new Array(p>1?p-1:0),y=1;y<p;y++)m[y-1]=arguments[y];e.emit(f,...m)}),this.modules.external.forEach(f=>{f.init&&f.init(this)})}if(this.format=this.options.interpolation.format,n||(n=An),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const c=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);c.length>0&&c[0]!=="dev"&&(this.options.lng=c[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(c=>{this[c]=function(){return e.store[c](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(c=>{this[c]=function(){return e.store[c](...arguments),e}});const l=jt(),u=()=>{const c=(d,h)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),l.resolve(h),n(d,h)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return c(null,this.t.bind(this));this.changeLanguage(this.options.lng,c)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),l}loadResources(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:An;const r=z(e)?e:this.language;if(typeof e=="function"&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&r.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return n();const a=[],o=s=>{if(!s||s==="cimode")return;this.services.languageUtils.toResolveHierarchy(s).forEach(u=>{u!=="cimode"&&a.indexOf(u)<0&&a.push(u)})};r?o(r):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(l=>o(l)),this.options.preload&&this.options.preload.forEach(s=>o(s)),this.services.backendConnector.load(a,this.options.ns,s=>{!s&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),n(s)})}else n(null)}reloadResources(e,t,n){const r=jt();return typeof e=="function"&&(n=e,e=void 0),typeof t=="function"&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=An),this.services.backendConnector.reload(e,t,a=>{r.resolve(),n(a)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return e.type==="backend"&&(this.modules.backend=e),(e.type==="logger"||e.log&&e.warn&&e.error)&&(this.modules.logger=e),e.type==="languageDetector"&&(this.modules.languageDetector=e),e.type==="i18nFormat"&&(this.modules.i18nFormat=e),e.type==="postProcessor"&&so.addPostProcessor(e),e.type==="formatter"&&(this.modules.formatter=e),e.type==="3rdParty"&&this.modules.external.push(e),this}setResolvedLanguage(e){if(!(!e||!this.languages)&&!(["cimode","dev"].indexOf(e)>-1))for(let t=0;t<this.languages.length;t++){const n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}changeLanguage(e,t){var n=this;this.isLanguageChangingTo=e;const r=jt();this.emit("languageChanging",e);const a=l=>{this.language=l,this.languages=this.services.languageUtils.toResolveHierarchy(l),this.resolvedLanguage=void 0,this.setResolvedLanguage(l)},o=(l,u)=>{u?(a(u),this.translator.changeLanguage(u),this.isLanguageChangingTo=void 0,this.emit("languageChanged",u),this.logger.log("languageChanged",u)):this.isLanguageChangingTo=void 0,r.resolve(function(){return n.t(...arguments)}),t&&t(l,function(){return n.t(...arguments)})},s=l=>{!e&&!l&&this.services.languageDetector&&(l=[]);const u=z(l)?l:this.services.languageUtils.getBestMatchFromCodes(l);u&&(this.language||a(u),this.translator.language||this.translator.changeLanguage(u),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(u)),this.loadResources(u,c=>{o(c,u)})};return!e&&this.services.languageDetector&&!this.services.languageDetector.async?s(this.services.languageDetector.detect()):!e&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e),r}getFixedT(e,t,n){var r=this;const a=function(o,s){let l;if(typeof s!="object"){for(var u=arguments.length,c=new Array(u>2?u-2:0),d=2;d<u;d++)c[d-2]=arguments[d];l=r.options.overloadTranslationOptionHandler([o,s].concat(c))}else l={...s};l.lng=l.lng||a.lng,l.lngs=l.lngs||a.lngs,l.ns=l.ns||a.ns,l.keyPrefix!==""&&(l.keyPrefix=l.keyPrefix||n||a.keyPrefix);const h=r.options.keySeparator||".";let f;return l.keyPrefix&&Array.isArray(o)?f=o.map(p=>`${l.keyPrefix}${h}${p}`):f=l.keyPrefix?`${l.keyPrefix}${h}${o}`:o,r.t(f,l)};return z(e)?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=n,a}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=t.lng||this.resolvedLanguage||this.languages[0],r=this.options?this.options.fallbackLng:!1,a=this.languages[this.languages.length-1];if(n.toLowerCase()==="cimode")return!0;const o=(s,l)=>{const u=this.services.backendConnector.state[`${s}|${l}`];return u===-1||u===0||u===2};if(t.precheck){const s=t.precheck(this,o);if(s!==void 0)return s}return!!(this.hasResourceBundle(n,e)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||o(n,e)&&(!r||o(a,e)))}loadNamespaces(e,t){const n=jt();return this.options.ns?(z(e)&&(e=[e]),e.forEach(r=>{this.options.ns.indexOf(r)<0&&this.options.ns.push(r)}),this.loadResources(r=>{n.resolve(),t&&t(r)}),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){const n=jt();z(e)&&(e=[e]);const r=this.options.preload||[],a=e.filter(o=>r.indexOf(o)<0&&this.services.languageUtils.isSupportedCode(o));return a.length?(this.options.preload=r.concat(a),this.loadResources(o=>{n.resolve(),t&&t(o)}),n):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],n=this.services&&this.services.languageUtils||new Xr(ta());return t.indexOf(n.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;return new fn(e,t)}cloneInstance(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:An;const n=e.forkResourceStore;n&&delete e.forkResourceStore;const r={...this.options,...e,isClone:!0},a=new fn(r);return(e.debug!==void 0||e.prefix!==void 0)&&(a.logger=a.logger.clone(e)),["store","services","language"].forEach(s=>{a[s]=this[s]}),a.services={...this.services},a.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},n&&(a.store=new Zr(this.store.data,r),a.services.resourceStore=a.store),a.translator=new Jn(a.services,r),a.translator.on("*",function(s){for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];a.emit(s,...u)}),a.init(r,t),a.translator.options=r,a.translator.backendConnector.services.utils={hasLoadedNamespace:a.hasLoadedNamespace.bind(a)},a}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const he=fn.createInstance();he.createInstance=fn.createInstance;he.createInstance;he.dir;he.init;he.loadResources;he.reloadResources;he.use;he.changeLanguage;he.getFixedT;he.t;he.exists;he.setDefaultNamespace;he.hasLoadedNamespace;he.loadNamespaces;he.loadLanguages;const sr={en:{translation:{"label.appTitle":"Pro Football Tour Planner","label.language":"Language","label.theme":"Theme","label.tourStartDate":"Time window begin","label.tourEndDate":"Time window end","label.routesHeading":"Best scored tours","label.routesHeading.running":"Searching for tours","label.helpTopicsHeading":"How the app works","label.weight":"Weight","label.unknownStadium":"Unknown stadium","label.unknownCity":"Unknown city","label.unknownLocation":"Unknown location","label.homeTeamUnknown":"Home team unknown","label.homeTeamFallback":"Home","label.awayTeamFallback":"Away","label.stadiumTbd":"TBD","label.gameDetailsHeading":"Game Details","label.game":"Game","label.week":"Week","label.kickoff":"Kickoff","label.stadium":"Stadium","label.location":"Location","label.routeScore":"Score","label.travelDistance":"Travel distance","label.travelTime":"Travel time","label.routeLength_one":"{{count}} game","label.routeLength_other":"{{count}} games","label.routeTitle.single":"{{firstCity}}","label.routeTitle.range":"From {{firstCity}} to {{lastCity}}","label.routeTitle.via":"From {{firstCity}} to {{lastCity}} via {{viaList}}","label.routeTitle.viaOverflow":"From {{firstCity}} to {{lastCity}} via {{viaList}} and {{remainingLabel}}","label.routeTitle.remaining_one":"{{count}} more","label.routeTitle.remaining_other":"{{count}} more","label.editRouteTitle":"Edit title","label.routeWeekSingle":"Week {{week}}","label.routeWeeksRange":"Weeks {{start}}  {{end}}","label.weekNumber":"Week {{week}}","label.weekUnknown":"Week ?","label.durationZeroHours":"0.0 hours","label.durationDays_one":"{{count}} day","label.durationDays_other":"{{count}} days","label.graphNode":"Week {{week}}: {{away}} @ {{home}}{{tagSuffix}}","label.graphNodeTagSuffix":" ({{tag}})","label.unknown":"Unknown","message.routesLoading":"Tours are loading","message.routesAwaitingSearch":"Tours will appear here once a search completes.","message.routesEmpty":"No tours found within the configured tour window.","message.calculatingRoutes":"Calculating tours","message.graphSelectPrompt":"Select a game to see the details.","message.favoritesEmpty":"No tours saved yet.","message.favoritesImportSummary":"Imported {{added}} tours  Skipped {{skipped}} duplicates.","error.favoritesImportInvalid":"Could not import tours: invalid file.","message.favoritesRemoveConfirm":"Really remove tour","message.help.empty":"Help content is not available yet.","button.help":"Help","button.searchStart":"Start search","button.searchStop":"End search","button.addFavorite":"Save tour","button.favoriteAdded":"Tour already saved","button.removeFavorite":"Remove tour","button.moveUp":"Move up","button.moveDown":"Move down","button.exportFavorites":"Export tours","button.importFavorites":"Import tours","button.close":"Close","button.cancel":"Cancel","button.remove":"Remove","button.save":"Save","button.restoreDefaults":"Restore defaults","dialog.teamPreferences.title":"Team preferences","dialog.cityPreferences.title":"City preferences","dialog.routingParameters.title":"Routing parameters","dialog.routingGraph.title":"Routing graph","dialog.favorites.title":"Saved tours","dialog.favorites.importStatusTitle":"Tour import status","dialog.favorites.removeConfirmTitle":"Remove saved tour","dialog.help.title":"Help","option.language.en":"English","option.language.de":"German","option.theme.system":"System","option.theme.light":"Light","option.theme.dark":"Dark","option.startDay.any":"Any day","option.startDay.sunday":"Sunday","option.startDay.monday":"Monday","option.startDay.thursday":"Thursday","option.enabled":"Enabled","option.disabled":"Disabled","aria.closeDialog":"Close dialog","aria.teamLogo":"{{team}} logo","aria.languageSelector":"Select interface language","aria.themeSelector":"Select interface theme","aria.appMenuOpen":"Open menu","aria.appMenuClose":"Close menu","status.searchStopped":"Stopped","status.searchFinished":"Finished","status.nodeSummary":"Processed {{processed}} of {{total}} start nodes.","log.elapsed":"Runtime:","log.progress":"Start games checked:","log.evaluated":"Tours evaluated:","log.remaining":"Remaining time:","label.routing.maxRoutes":"Max results","label.routing.maxTourLength":"Tour duration (days)","label.routing.allowFlights":"Allow flights","label.routing.expertMode":"Expert mode","label.routing.requiredStartDay":"Start day","label.routing.estimatedMaxGamesPerWeek":"Max games per week","label.routing.estimatedMinGamesPerWeek":"Min games per week","label.routing.maxSearchMinutesPerStartGame":"Max search minutes per game","label.routing.beamWidthPerStartGame":"Beam width/start game","label.routing.specialGameDayPenalty":"Special game day score multiplier","label.routing.cacheBucketHours":"Cache bucket (hours)","label.routing.minTimeToNextGameHoursFlight":"Min hours to next game (flight)","label.routing.maxTimeToNextGameHours":"Max hours to next game","label.routing.oneDayGap":"One-day gap (hours)","label.routing.maxDriveOneDayGap":"Max drive time on one day","label.routing.twoDayGap":"Two-day gap (hours)","label.routing.maxDriveTwoDayGap":"Max drive time two days","label.routing.threeDayGap":"Three-day gap (hours)","label.routing.maxDriveThreeDayGap":"Max drive time three days","label.routing.fourDayGap":"Four-day gap (hours)","label.routing.maxDriveFourDayGap":"Max drive time four days","label.routing.revisitMultiplierFloor":"City revisit score multiplier","label.routing.travelMultiplierFloor":"Travel multiplier floor","label.routing.travelMultiplierCeilingFlight":"Flight travel score multiplier","label.routing.enableRouteCache":"Enable route cache"}},de:{translation:{"label.appTitle":"Pro-Football Tour Planer ","label.language":"Sprache","label.theme":"Design","label.tourStartDate":"Zeitfenster von","label.tourEndDate":"Zeitfenster bis","label.routesHeading":"Bestbewertete Touren","label.routesHeading.running":"Tourensuche luft","label.helpTopicsHeading":"So funktioniert die App","label.weight":"Gewichtung","label.unknownStadium":"Unbekanntes Stadion","label.unknownCity":"Unbekannte Stadt","label.unknownLocation":"Unbekannter Ort","label.homeTeamUnknown":"Heimmannschaft unbekannt","label.homeTeamFallback":"Heim","label.awayTeamFallback":"Auswrts","label.stadiumTbd":"Noch offen","label.gameDetailsHeading":"Spieldetails","label.game":"Spiel","label.week":"Woche","label.kickoff":"Kickoff","label.stadium":"Stadion","label.location":"Ort","label.routeScore":"Wertung","label.travelDistance":"Reisedistanz","label.travelTime":"Reisezeit","label.routeLength_one":"{{count}} Spiel","label.routeLength_other":"{{count}} Spiele","label.routeTitle.single":"{{firstCity}}","label.routeTitle.range":"Von {{firstCity}} nach {{lastCity}}","label.routeTitle.via":"Von {{firstCity}} nach {{lastCity}} ber {{viaList}}","label.routeTitle.viaOverflow":"Von {{firstCity}} nach {{lastCity}} ber {{viaList}} und {{remainingLabel}}","label.routeTitle.remaining_one":"{{count}} weitere Stadt","label.routeTitle.remaining_other":"{{count}} weitere Stdte","label.editRouteTitle":"Titel bearbeiten","label.routeWeekSingle":"Woche {{week}}","label.routeWeeksRange":"Wochen {{start}}{{end}}","label.weekNumber":"Woche {{week}}","label.weekUnknown":"Woche ?","label.durationZeroHours":"0,0 Stunden","label.durationDays_one":"{{count}} Tag","label.durationDays_other":"{{count}} Tage","label.graphNode":"Woche {{week}}: {{away}} @ {{home}}{{tagSuffix}}","label.graphNodeTagSuffix":" ({{tag}})","label.unknown":"Unbekannt","message.routesLoading":"Touren werden geladen","message.routesAwaitingSearch":"Touren erscheinen hier nach einer abgeschlossenen Suche.","message.routesEmpty":"Keine Touren innerhalb des gewhlten Reisezeitraums gefunden.","message.calculatingRoutes":"Surche Touren","message.graphSelectPrompt":"Spiel auswhlen, um Details anzuzeigen.","message.favoritesEmpty":"Noch keine Touren gespeichert.","message.favoritesImportSummary":"Importiert: {{added}}  bersprungen: {{skipped}}.","error.favoritesImportInvalid":"Touren konnten nicht importiert werden: Datei ungltig.","message.favoritesRemoveConfirm":"Tour wirklich entfernen?","message.help.empty":"Hilfeinhalte sind derzeit nicht verfgbar.","button.help":"Hilfe","button.searchStart":"Suche starten","button.searchStop":"Suche beenden","button.addFavorite":"Tour merken","button.favoriteAdded":"Tour bereits gemerkt","button.removeFavorite":"Tour entfernen","button.moveUp":"Nach oben","button.moveDown":"Nach unten","button.exportFavorites":"Touren exportieren","button.importFavorites":"Touren importieren","button.close":"Schlieen","button.cancel":"Abbrechen","button.remove":"Entfernen","button.save":"Speichern","button.restoreDefaults":"Auf Standardwerte zurcksetzen","dialog.teamPreferences.title":"Teamprferenzen","dialog.cityPreferences.title":"Stadtprferenzen","dialog.routingParameters.title":"Routing-Parameter","dialog.routingGraph.title":"Routing-Graph","dialog.favorites.title":"Gemerkte Touren","dialog.favorites.importStatusTitle":"Tour-Importstatus","dialog.favorites.removeConfirmTitle":"Gemerkte Tour entfernen","dialog.help.title":"Hilfe","option.language.en":"English","option.language.de":"Deutsch","option.theme.system":"System","option.theme.light":"Hell","option.theme.dark":"Dunkel","option.startDay.any":"Beliebiger Tag","option.startDay.sunday":"Sonntag","option.startDay.monday":"Montag","option.startDay.thursday":"Donnerstag","option.enabled":"Aktiviert","option.disabled":"Deaktiviert","aria.closeDialog":"Dialog schlieen","aria.teamLogo":"{{team}} Logo","aria.languageSelector":"Sprache auswhlen","aria.themeSelector":"Design auswhlen","aria.appMenuOpen":"Men ffnen","aria.appMenuClose":"Men schlieen","status.searchStopped":"Angehalten","status.searchFinished":"Abgeschlossen","status.nodeSummary":"{{processed}} von {{total}} Spielen verarbeitet.","log.elapsed":"Laufzeit:","log.progress":"Startspiele geprft:","log.evaluated":"Touren geprft:","log.remaining":"Restzeit:","label.routing.maxRoutes":"Max Anzahl Ergebnisse","label.routing.maxTourLength":"Reisedauer (Tage)","label.routing.allowFlights":"Flge erlauben","label.routing.expertMode":"Experten-Modus","label.routing.requiredStartDay":"Starttag","label.routing.estimatedMaxGamesPerWeek":"Max Spiele pro Woche","label.routing.estimatedMinGamesPerWeek":"Min Spiele pro Woche","label.routing.maxSearchMinutesPerStartGame":"Max Suchminuten pro Spiel","label.routing.beamWidthPerStartGame":"Beam-Width/Startspiel","label.routing.cacheBucketHours":"Cache-Bucket (Stunden)","label.routing.minTimeToNextGameHoursFlight":"Min Stunden bis zum nchsten Spiel (Flug)","label.routing.maxTimeToNextGameHours":"Max Stunden bis zum nchsten Spiel","label.routing.oneDayGap":"Ein-Tages-Abstand (Stunden)","label.routing.maxDriveOneDayGap":"Max Fahrtzeit an einem Tag","label.routing.twoDayGap":"Zwei-Tages-Abstand (Stunden)","label.routing.maxDriveTwoDayGap":"Max Fahrtzeit an zwei Tagen","label.routing.threeDayGap":"Drei-Tages-Abstand (Stunden)","label.routing.maxDriveThreeDayGap":"Max Fahrtzeit an drei Tagen","label.routing.fourDayGap":"Vier-Tages-Abstand (Stunden)","label.routing.maxDriveFourDayGap":"Max Fahrtzeit an vier Tagen","label.routing.specialGameDayPenalty":"Bewertungsmultiplikator fr besondere Spieltage","label.routing.travelMultiplierFloor":"Mindestmultiplikator fr Reisezeit","label.routing.revisitMultiplierFloor":"Bewertungsmultiplikator fr Stadt-Wiederbesuche","label.routing.travelMultiplierCeilingFlight":"Bewertungsmultiplikator fr Flge","label.routing.enableRouteCache":"Route-Cache aktivieren"}}};let ia=!1;async function $l(){if(ia)return;const i=lo();await he.init({lng:i,fallbackLng:"en",resources:sr,interpolation:{escapeValue:!1}}),ia=!0}function T(i,e){return he.t(i,e)}function Ol(i){return he.changeLanguage(i)}function st(){return he.language||lo()}function zl(){return Object.keys(sr)}function Ot(i){return he.on("languageChanged",i),()=>he.off("languageChanged",i)}function lo(){if(typeof navigator>"u")return"en";const i=Array.isArray(navigator.languages)&&navigator.languages.length>0?navigator.languages[0]:navigator.language;return typeof i=="string"&&i.toLowerCase().startsWith("de")?"de":"en"}const uo=[{season:2025,stadium:"State Farm Stadium",home_team:["ARI"],location_name:"Glendale, Arizona",city_name:"Arizona",timezone:"America/Phoenix",timezone_label:"MT",stadium_id:"PHO00",location_geo:[-112.263,33.528],googleMapUrl:"https://www.google.com/maps?q=33.528,-112.263"},{season:2025,stadium:"Mercedes-Benz Stadium",home_team:["ATL"],location_name:"Atlanta, Georgia",city_name:"Atlanta",timezone:"America/New_York",timezone_label:"ET",stadium_id:"ATL97",location_geo:[-84.4,33.75555555555555],googleMapUrl:"https://www.google.com/maps?q=33.75555555555555,-84.4"},{season:2025,stadium:"M&T Bank Stadium",home_team:["BAL"],location_name:"Baltimore, Maryland",city_name:"Baltimore",timezone:"America/New_York",timezone_label:"ET",stadium_id:"BAL00",location_geo:[-76.62277777777777,39.278055555555554],googleMapUrl:"https://www.google.com/maps?q=39.278055555555554,-76.62277777777777"},{season:2025,stadium:"Highmark Stadium",home_team:["BUF"],location_name:"Orchard Park, New York",city_name:"Buffalo",timezone:"America/New_York",timezone_label:"ET",stadium_id:"BUF00",location_geo:[-78.787,42.774],googleMapUrl:"https://www.google.com/maps?q=42.774,-78.787"},{season:2025,stadium:"Bank of America Stadium",home_team:["CAR"],location_name:"Charlotte, NC",city_name:"Carolina",timezone:"America/New_York",timezone_label:"ET",stadium_id:"CAR00",location_geo:[-80.85277777777777,35.225833333333334],googleMapUrl:"https://www.google.com/maps?q=35.225833333333334,-80.85277777777777"},{season:2025,stadium:"Soldier Field",home_team:["CHI"],location_name:"Chicago, Illinois",city_name:"Chicago",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"CHI98",location_geo:[-87.6167,41.8623],googleMapUrl:"https://www.google.com/maps?q=41.8623,-87.6167"},{season:2025,stadium:"Paycor Stadium",home_team:["CIN"],location_name:"Cincinnati, Ohio",city_name:"Cincinnati",timezone:"America/New_York",timezone_label:"ET",stadium_id:"CIN00",location_geo:[-84.516,39.095],googleMapUrl:"https://www.google.com/maps?q=39.095,-84.516"},{season:2025,stadium:"Huntington Bank Field",home_team:["CLE"],location_name:"Cleveland, Ohio",city_name:"Cleveland",timezone:"America/New_York",timezone_label:"ET",stadium_id:"CLE00",location_geo:[-81.699444,41.506111],googleMapUrl:"https://www.google.com/maps?q=41.506111,-81.699444"},{season:2025,stadium:"AT&T Stadium",home_team:["DAL"],location_name:"Arlington, Texas",city_name:"Dallas",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"DAL00",location_geo:[-97.09277777777777,32.74777777777778],googleMapUrl:"https://www.google.com/maps?q=32.74777777777778,-97.09277777777777"},{season:2025,stadium:"Empower Field at Mile High",home_team:["DEN"],location_name:"Denver, Colorado",city_name:"Denver",timezone:"America/Denver",timezone_label:"MT",stadium_id:"DEN00",location_geo:[-104.9849,39.7392],googleMapUrl:"https://www.google.com/maps?q=39.7392,-104.9849"},{season:2025,stadium:"Ford Field",home_team:["DET"],location_name:"Detroit, Michigan",city_name:"Detroit",timezone:"America/Detroit",timezone_label:"ET",stadium_id:"DET00",location_geo:[-83.04555555555555,42.34],googleMapUrl:"https://www.google.com/maps?q=42.34,-83.04555555555555"},{season:2025,stadium:"Lambeau Field",home_team:["GB"],location_name:"Green Bay, Wisconsin",city_name:"Green Bay",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"GNB00",location_geo:[-88.06222222222222,44.50138888888889],googleMapUrl:"https://www.google.com/maps?q=44.50138888888889,-88.06222222222222"},{season:2025,stadium:"NRG Stadium",home_team:["HOU"],location_name:"Houston, Texas",city_name:"Houston",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"HOU00",location_geo:[-95.41083333333334,29.684722222222224],googleMapUrl:"https://www.google.com/maps?q=29.684722222222224,-95.41083333333334"},{season:2025,stadium:"Lucas Oil Stadium",home_team:["IND"],location_name:"Indianapolis, Indiana",city_name:"Indianapolis",timezone:"America/Indiana/Indianapolis",timezone_label:"ET",stadium_id:"IND00",location_geo:[-86.16380555555556,39.76005555555555],googleMapUrl:"https://www.google.com/maps?q=39.76005555555555,-86.16380555555556"},{season:2025,stadium:"EverBank Stadium",home_team:["JAX"],location_name:"Jacksonville, Florida",city_name:"Jacksonville",timezone:"America/New_York",timezone_label:"ET",stadium_id:"JAX00",location_geo:[-81.6375,30.323888888888888],googleMapUrl:"https://www.google.com/maps?q=30.323888888888888,-81.6375"},{season:2025,stadium:"GEHA Field at Arrowhead Stadium",home_team:["KC"],location_name:"Kansas City, Missouri",city_name:"Kansas City",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"KAN00",location_geo:[-94.483889,39.048889],googleMapUrl:"https://www.google.com/maps?q=39.048889,-94.483889"},{season:2025,stadium:"SoFi Stadium",home_team:["LAC","LA"],location_name:"Inglewood, CA",city_name:"Los Angeles",timezone:"America/Los_Angeles",timezone_label:"PT",stadium_id:"LAX01",location_geo:[-118.339,33.953],googleMapUrl:"https://www.google.com/maps?q=33.953,-118.339"},{season:2025,stadium:"Allegiant Stadium",home_team:["LV"],location_name:"Paradise, Nevada",city_name:"Las Vegas",timezone:"America/Los_Angeles",timezone_label:"PT",stadium_id:"VEG00",location_geo:[-115.18388888888889,36.09055555555556],googleMapUrl:"https://www.google.com/maps?q=36.09055555555556,-115.18388888888889"},{season:2025,stadium:"Hard Rock Stadium",home_team:["MIA"],location_name:"Coral Gables, Florida",city_name:"Miami",timezone:"America/New_York",timezone_label:"ET",stadium_id:"MIA00",location_geo:[-80.2388888888889,25.958055555555553],googleMapUrl:"https://www.google.com/maps?q=25.958055555555553,-80.2388888888889"},{season:2025,stadium:"U.S. Bank Stadium",home_team:["MIN"],location_name:"Minneapolis, Minnesota",city_name:"Minnesota",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"MIN01",location_geo:[-93.258,44.974],googleMapUrl:"https://www.google.com/maps?q=44.974,-93.258"},{season:2025,stadium:"Gillette Stadium",home_team:["NE"],location_name:"Foxborough, Massachusetts",city_name:"New England",timezone:"America/New_York",timezone_label:"ET",stadium_id:"BOS00",location_geo:[-71.264,42.091],googleMapUrl:"https://www.google.com/maps?q=42.091,-71.264"},{season:2025,stadium:"Caesars Superdome",home_team:["NO"],location_name:"New Orleans, Louisiana",city_name:"New Orleans",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"NOR00",location_geo:[-90.08111111111111,29.950833333333332],googleMapUrl:"https://www.google.com/maps?q=29.950833333333332,-90.08111111111111"},{season:2025,stadium:"MetLife Stadium",home_team:["NYG","NYJ"],location_name:"East Rutherford, New Jersey",city_name:"New York",timezone:"America/New_York",timezone_label:"ET",stadium_id:"NYC01",location_geo:[-74.074444,40.813611],googleMapUrl:"https://www.google.com/maps?q=40.813611,-74.074444"},{season:2025,stadium:"Lincoln Financial Field",home_team:["PHI"],location_name:"Philadelphia, Pennsylvania",city_name:"Philadelphia",timezone:"America/New_York",timezone_label:"ET",stadium_id:"PHI00",location_geo:[-75.1675,39.90083333333333],googleMapUrl:"https://www.google.com/maps?q=39.90083333333333,-75.1675"},{season:2025,stadium:"Acrisure Stadium",home_team:["PIT"],location_name:"Pittsburgh, Pennsylvania",city_name:"Pittsburgh",timezone:"America/New_York",timezone_label:"ET",stadium_id:"PIT00",location_geo:[-80.015833,40.446667],googleMapUrl:"https://www.google.com/maps?q=40.446667,-80.015833"},{season:2025,stadium:"Lumen Field",home_team:["SEA"],location_name:"Seattle, WA",city_name:"Seattle",timezone:"America/Los_Angeles",timezone_label:"PT",stadium_id:"SEA00",location_geo:[-122.3316,47.5952],googleMapUrl:"https://www.google.com/maps?q=47.5952,-122.3316"},{season:2025,stadium:"Levi's Stadium",home_team:["SF"],location_name:"Santa Clara, California",city_name:"San Francisco",timezone:"America/Los_Angeles",timezone_label:"PT",stadium_id:"SFO01",location_geo:[-121.97,37.403],googleMapUrl:"https://www.google.com/maps?q=37.403,-121.97"},{season:2025,stadium:"Raymond James Stadium",home_team:["TB"],location_name:"Tampa Bay, Florida",city_name:"Tampa Bay",timezone:"America/New_York",timezone_label:"ET",stadium_id:"TAM00",location_geo:[-82.50333333333333,27.97583333333333],googleMapUrl:"https://www.google.com/maps?q=27.97583333333333,-82.50333333333333"},{season:2025,stadium:"Nissan Stadium",home_team:["TEN"],location_name:"Nashville, Tennessee",city_name:"Tennessee",timezone:"America/Chicago",timezone_label:"CT",stadium_id:"NAS00",location_geo:[-86.7713888888889,36.16638888888889],googleMapUrl:"https://www.google.com/maps?q=36.16638888888889,-86.7713888888889"},{season:2025,stadium:"Northwest Stadium",home_team:["WAS"],location_name:"Landover, Maryland",city_name:"Washington",timezone:"America/New_York",timezone_label:"ET",stadium_id:"WAS00",location_geo:[-76.864444,38.907778],googleMapUrl:"https://www.google.com/maps?q=38.907778,-76.864444"}],co=[{season:2025,team:"ARI",team_name:"Arizona Cardinals",team_id:"3800",team_nick:"Cardinals",team_conf:"NFC",team_division:"NFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/7/72/Arizona_Cardinals_logo.svg/179px-Arizona_Cardinals_logo.svg.png",team_wordmark:"/images/wordmarks/ARI.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/ARI.png",stadium_id:"PHO00",stadium:"State Farm Stadium",color_city_dot:"#fff",color_helmet_shell:"#fff",color_city_border:"#97233F",color_helmet_logo:"#97233F",color_helmet_mask:"#8b999d"},{season:2025,team:"ATL",team_name:"Atlanta Falcons",team_id:"200",team_nick:"Falcons",team_conf:"NFC",team_division:"NFC South",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/c/c5/Atlanta_Falcons_logo.svg/192px-Atlanta_Falcons_logo.svg.png",team_wordmark:"/images/wordmarks/ATL.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/ATL.png",stadium_id:"ATL97",stadium:"Mercedes-Benz Stadium",color_city_dot:"#000",color_helmet_shell:"#000",color_city_border:"#a30d2d",color_helmet_logo:"#a30d2d",color_helmet_mask:"#8b999d"},{season:2025,team:"BAL",team_name:"Baltimore Ravens",team_id:"325",team_nick:"Ravens",team_conf:"AFC",team_division:"AFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/1/16/Baltimore_Ravens_logo.svg/193px-Baltimore_Ravens_logo.svg.png",team_wordmark:"/images/wordmarks/BAL.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/BAL.png",stadium_id:"BAL00",stadium:"M&T Bank Stadium",color_city_dot:"#b79a3e",color_helmet_shell:"#241773",color_city_border:"#513481",color_helmet_logo:"#9E7C0C",color_helmet_mask:"#9E7C0C"},{season:2025,team:"BUF",team_name:"Buffalo Bills",team_id:"610",team_nick:"Bills",team_conf:"AFC",team_division:"AFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/7/77/Buffalo_Bills_logo.svg/189px-Buffalo_Bills_logo.svg.png",team_wordmark:"/images/wordmarks/BUF.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/BUF.png",stadium_id:"BUF00",stadium:"Highmark Stadium",color_city_dot:"#00338D",color_helmet_shell:"#C60C30",color_city_border:"#C60C30",color_helmet_logo:"#00338D",color_helmet_mask:"#eee"},{season:2025,team:"CAR",team_name:"Carolina Panthers",team_id:"750",team_nick:"Panthers",team_conf:"NFC",team_division:"NFC South",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/1/1c/Carolina_Panthers_logo.svg/100px-Carolina_Panthers_logo.svg.png",team_wordmark:"/images/wordmarks/CAR.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/CAR.png",stadium_id:"CAR00",stadium:"Bank of America Stadium",color_city_dot:"#0085CA",color_helmet_shell:"#0085CA",color_city_border:"#000",color_helmet_logo:"#000",color_helmet_mask:"#8b999d"},{season:2025,team:"CHI",team_name:"Chicago Bears",team_id:"810",team_nick:"Bears",team_conf:"NFC",team_division:"NFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Chicago_Bears_logo.svg/100px-Chicago_Bears_logo.svg.png",team_wordmark:"/images/wordmarks/CHI.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/CHI.png",stadium_id:"CHI98",stadium:"Soldier Field",color_city_dot:"#E64100",color_helmet_shell:"#0B162A",color_city_border:"#0B162A",color_helmet_logo:"#E64100",color_helmet_mask:"#0B162A"},{season:2025,team:"CIN",team_name:"Cincinnati Bengals",team_id:"920",team_nick:"Bengals",team_conf:"AFC",team_division:"AFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/8/81/Cincinnati_Bengals_logo.svg/100px-Cincinnati_Bengals_logo.svg.png",team_wordmark:"/images/wordmarks/CIN.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/CIN.png",stadium_id:"CIN00",stadium:"Paycor Stadium",color_city_dot:"#000",color_helmet_shell:"#FB4F14",color_city_border:"#FB4F14",color_helmet_logo:"#000",color_helmet_mask:"#000"},{season:2025,team:"CLE",team_name:"Cleveland Browns",team_id:"1050",team_nick:"Browns",team_conf:"AFC",team_division:"AFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/d/d9/Cleveland_Browns_logo.svg/100px-Cleveland_Browns_logo.svg.png",team_wordmark:"/images/wordmarks/CLE.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/CLE.png",stadium_id:"CLE00",stadium:"Huntington Bank Field",color_city_dot:"#FF3C00",color_helmet_shell:"#FF3C00",color_city_border:"#FF3C00",color_helmet_logo:"#FF3C00",color_helmet_mask:"#a5acaf"},{season:2025,team:"DAL",team_name:"Dallas Cowboys",team_id:"1200",team_nick:"Cowboys",team_conf:"NFC",team_division:"NFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/1/15/Dallas_Cowboys.svg/100px-Dallas_Cowboys.svg.png",team_wordmark:"/images/wordmarks/DAL.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/DAL.png",stadium_id:"DAL00",stadium:"AT&T Stadium",color_city_dot:"#002244",color_helmet_shell:"#acc0c6",color_city_border:"#acc0c6",color_helmet_logo:"#002244",color_helmet_mask:"#8b999d"},{season:2025,team:"DEN",team_name:"Denver Broncos",team_id:"1400",team_nick:"Broncos",team_conf:"AFC",team_division:"AFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/4/44/Denver_Broncos_logo.svg/100px-Denver_Broncos_logo.svg.png",team_wordmark:"/images/wordmarks/DEN.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/DEN.png",stadium_id:"DEN00",stadium:"Empower Field at Mile High",color_city_dot:"#f75",color_helmet_shell:"#002244",color_city_border:"#002244",color_helmet_logo:"#FB4F14",color_helmet_mask:"#00234c"},{season:2025,team:"DET",team_name:"Detroit Lions",team_id:"1540",team_nick:"Lions",team_conf:"NFC",team_division:"NFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/7/71/Detroit_Lions_logo.svg/100px-Detroit_Lions_logo.svg.png",team_wordmark:"/images/wordmarks/DET.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/DET.png",stadium_id:"DET00",stadium:"Ford Field",color_city_dot:"#B0B7BC",color_helmet_shell:"#0076B6",color_city_border:"#0076B6",color_helmet_logo:"#B0B7BC",color_helmet_mask:"#B0B7BC"},{season:2025,team:"GB",team_name:"Green Bay Packers",team_id:"1800",team_nick:"Packers",team_conf:"NFC",team_division:"NFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/Green_Bay_Packers_logo.svg/100px-Green_Bay_Packers_logo.svg.png",team_wordmark:"/images/wordmarks/GB.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/GB.png",stadium_id:"GNB00",stadium:"Lambeau Field",color_city_dot:"#FFB612",color_helmet_shell:"#FFB612",color_city_border:"#1c2d25",color_helmet_logo:"#1c2d25",color_helmet_mask:"#1c2d25"},{season:2025,team:"HOU",team_name:"Houston Texans",team_id:"2120",team_nick:"Texans",team_conf:"AFC",team_division:"AFC South",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/2/28/Houston_Texans_logo.svg/100px-Houston_Texans_logo.svg.png",team_wordmark:"/images/wordmarks/HOU.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/HOU.png",stadium_id:"HOU00",stadium:"NRG Stadium",color_city_dot:"#A71930",color_helmet_shell:"#03202F",color_city_border:"#03202F",color_helmet_logo:"#A71930",color_helmet_mask:"#00071c"},{season:2025,team:"IND",team_name:"Indianapolis Colts",team_id:"2200",team_nick:"Colts",team_conf:"AFC",team_division:"AFC South",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/0/00/Indianapolis_Colts_logo.svg/100px-Indianapolis_Colts_logo.svg.png",team_wordmark:"/images/wordmarks/IND.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/IND.png",stadium_id:"IND00",stadium:"Lucas Oil Stadium",color_city_dot:"#fff",color_helmet_shell:"#fff",color_city_border:"#002C5F",color_helmet_logo:"#002C5F",color_helmet_mask:"#8b999d"},{season:2025,team:"JAX",team_name:"Jacksonville Jaguars",team_id:"2250",team_nick:"Jaguars",team_conf:"AFC",team_division:"AFC South",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/7/74/Jacksonville_Jaguars_logo.svg/100px-Jacksonville_Jaguars_logo.svg.png",team_wordmark:"/images/wordmarks/JAX.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/JAX.png",stadium_id:"JAX00",stadium:"EverBank Stadium",color_city_dot:"#000",color_helmet_shell:"#006778",color_city_border:"#006778",color_helmet_logo:"#9f792c",color_helmet_mask:"#9f792c"},{season:2025,team:"KC",team_name:"Kansas City Chiefs",team_id:"2310",team_nick:"Chiefs",team_conf:"AFC",team_division:"AFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/e/e1/Kansas_City_Chiefs_logo.svg/100px-Kansas_City_Chiefs_logo.svg.png",team_wordmark:"/images/wordmarks/KC.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/KC.png",stadium_id:"KAN00",stadium:"GEHA Field at Arrowhead Stadium",color_city_dot:"#fff",color_helmet_shell:"#E31837",color_city_border:"#E31837",color_helmet_logo:"#fff",color_helmet_mask:"#FFB612"},{season:2025,team:"LAC",team_name:"Los Angeles Chargers",team_id:"4400",team_nick:"Chargers",team_conf:"AFC",team_division:"AFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/7/72/NFL_Chargers_logo.svg/100px-NFL_Chargers_logo.svg.png",team_wordmark:"/images/wordmarks/LAC.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/LAC.png",stadium_id:"LAX01",stadium:"SoFi Stadium",color_city_dot:"#fff",color_helmet_shell:"#007BC7",color_city_border:"#007BC7",color_helmet_logo:"#ffc20e",color_helmet_mask:"#ffb612"},{season:2025,team:"LA",team_name:"Los Angeles Rams",team_id:"2510",team_nick:"Rams",team_conf:"NFC",team_division:"NFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/8/8a/Los_Angeles_Rams_logo.svg/100px-Los_Angeles_Rams_logo.svg.png",team_wordmark:"/images/wordmarks/LA.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/LA.png",stadium_id:"LAX01",stadium:"SoFi Stadium",color_city_dot:"#FFD100",color_helmet_shell:"#003594",color_city_border:"#003594",color_helmet_logo:"#FFD100",color_helmet_mask:"#002467"},{season:2025,team:"LV",team_name:"Las Vegas Raiders",team_id:"2520",team_nick:"Raiders",team_conf:"AFC",team_division:"AFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/4/48/Las_Vegas_Raiders_logo.svg/100px-Las_Vegas_Raiders_logo.svg.png",team_wordmark:"/images/wordmarks/LV.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/LV.png",stadium_id:"VEG00",stadium:"Allegiant Stadium",color_city_dot:"#A5ACAF",color_helmet_shell:"#000",color_city_border:"#000",color_helmet_logo:"#A5ACAF",color_helmet_mask:"#a6aeb0"},{season:2025,team:"MIA",team_name:"Miami Dolphins",team_id:"2700",team_nick:"Dolphins",team_conf:"AFC",team_division:"AFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/3/37/Miami_Dolphins_logo.svg/100px-Miami_Dolphins_logo.svg.png",team_wordmark:"/images/wordmarks/MIA.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/MIA.png",stadium_id:"MIA00",stadium:"Hard Rock Stadium",color_city_dot:"#F58220",color_helmet_shell:"#008E97",color_city_border:"#008E97",color_helmet_logo:"#fff",color_helmet_mask:"#F58220"},{season:2025,team:"MIN",team_name:"Minnesota Vikings",team_id:"3000",team_nick:"Vikings",team_conf:"NFC",team_division:"NFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/4/48/Minnesota_Vikings_logo.svg/98px-Minnesota_Vikings_logo.svg.png",team_wordmark:"/images/wordmarks/MIN.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/MIN.png",stadium_id:"MIN01",stadium:"U.S. Bank Stadium",color_city_dot:"#fff",color_helmet_shell:"#4F2683",color_city_border:"#4F2683",color_helmet_logo:"#fff",color_helmet_mask:"#FFC62F"},{season:2025,team:"NE",team_name:"New England Patriots",team_id:"3200",team_nick:"Patriots",team_conf:"AFC",team_division:"AFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/b/b9/New_England_Patriots_logo.svg/100px-New_England_Patriots_logo.svg.png",team_wordmark:"/images/wordmarks/NE.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/NE.png",stadium_id:"BOS00",stadium:"Gillette Stadium",color_city_dot:"#b0b7bc",color_helmet_shell:"#b0b7bc",color_city_border:"#002244",color_helmet_logo:"#002244",color_helmet_mask:"#C60C30"},{season:2025,team:"NO",team_name:"New Orleans Saints",team_id:"3300",team_nick:"Saints",team_conf:"NFC",team_division:"NFC South",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/5/50/New_Orleans_Saints_logo.svg/98px-New_Orleans_Saints_logo.svg.png",team_wordmark:"/images/wordmarks/NO.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/NO.png",stadium_id:"NOR00",stadium:"Caesars Superdome",color_city_dot:"#000",color_helmet_shell:"#9f8958",color_city_border:"#D3BC8D",color_helmet_logo:"#000",color_helmet_mask:"#000"},{season:2025,team:"NYG",team_name:"New York Giants",team_id:"3410",team_nick:"Giants",team_conf:"NFC",team_division:"NFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/New_York_Giants_logo.svg/100px-New_York_Giants_logo.svg.png",team_wordmark:"/images/wordmarks/NYG.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/NYG.png",stadium_id:"NYC01",stadium:"MetLife Stadium",color_city_dot:"#A71930",color_helmet_shell:"#0B2265",color_city_border:"#0B2265",color_helmet_logo:"#fff",color_helmet_mask:"#A71930"},{season:2025,team:"NYJ",team_name:"New York Jets",team_id:"3430",team_nick:"Jets",team_conf:"AFC",team_division:"AFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/6/6b/New_York_Jets_logo.svg/100px-New_York_Jets_logo.svg.png",team_wordmark:"/images/wordmarks/NYJ.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/NYJ.png",stadium_id:"NYC01",stadium:"MetLife Stadium",color_city_dot:"#fff",color_helmet_shell:"#003F2D",color_city_border:"#003F2D",color_helmet_logo:"#fff",color_helmet_mask:"#006347"},{season:2025,team:"PHI",team_name:"Philadelphia Eagles",team_id:"3700",team_nick:"Eagles",team_conf:"NFC",team_division:"NFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/8/8e/Philadelphia_Eagles_logo.svg/100px-Philadelphia_Eagles_logo.svg.png",team_wordmark:"/images/wordmarks/PHI.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/PHI.png",stadium_id:"PHI00",stadium:"Lincoln Financial Field",color_city_dot:"#004C54",color_helmet_shell:"#004C54",color_city_border:"#b0b7bc",color_helmet_logo:"#b0b7bc",color_helmet_mask:"#000"},{season:2025,team:"PIT",team_name:"Pittsburgh Steelers",team_id:"3900",team_nick:"Steelers",team_conf:"AFC",team_division:"AFC North",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/de/Pittsburgh_Steelers_logo.svg/100px-Pittsburgh_Steelers_logo.svg.png",team_wordmark:"/images/wordmarks/PIT.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/PIT.png",stadium_id:"PIT00",stadium:"Acrisure Stadium",color_city_dot:"#FFB612",color_helmet_shell:"#000000",color_city_border:"#000000",color_helmet_logo:"#fff",color_helmet_mask:"#FFB612"},{season:2025,team:"SEA",team_name:"Seattle Seahawks",team_id:"4600",team_nick:"Seahawks",team_conf:"NFC",team_division:"NFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/8/8e/Seattle_Seahawks_logo.svg/100px-Seattle_Seahawks_logo.svg.png",team_wordmark:"/images/wordmarks/SEA.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/SEA.png",stadium_id:"SEA00",stadium:"Lumen Field",color_city_dot:"#002244",color_helmet_shell:"#002244",color_city_border:"#69be28",color_helmet_logo:"#69be28",color_helmet_mask:"#a5acaf"},{season:2025,team:"SF",team_name:"San Francisco 49ers",team_id:"4500",team_nick:"49ers",team_conf:"NFC",team_division:"NFC West",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/San_Francisco_49ers_logo.svg/100px-San_Francisco_49ers_logo.svg.png",team_wordmark:"/images/wordmarks/SF.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/SF.png",stadium_id:"SFO01",stadium:"Levi's Stadium",color_city_dot:"#AA0000",color_helmet_shell:"#a18a54",color_city_border:"#a18a54",color_helmet_logo:"#AA0000",color_helmet_mask:"#AA0000"},{season:2025,team:"TB",team_name:"Tampa Bay Buccaneers",team_id:"4900",team_nick:"Buccaneers",team_conf:"NFC",team_division:"NFC South",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/en/thumb/a/a2/Tampa_Bay_Buccaneers_logo.svg/100px-Tampa_Bay_Buccaneers_logo.svg.png",team_wordmark:"/images/wordmarks/TB.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/TB.png",stadium_id:"TAM00",stadium:"Raymond James Stadium",color_city_dot:"#A71930",color_helmet_shell:"#50483d",color_city_border:"#6c5d49",color_helmet_logo:"#A71930",color_helmet_mask:"#000"},{season:2025,team:"TEN",team_name:"Tennessee Titans",team_id:"2100",team_nick:"Titans",team_conf:"AFC",team_division:"AFC South",team_logo_wikipedia:"https://github.com/nflverse/nflverse-pbp/raw/master/titans.png",team_wordmark:"/images/wordmarks/TEN.png",team_conference_logo:"/images/conferences/AFC.png",team_logo_squared:"/images/logos/TEN.png",stadium_id:"NAS00",stadium:"Nissan Stadium",color_city_dot:"#002244",color_helmet_shell:"#4B92DB",color_city_border:"#4B92DB",color_helmet_logo:"#002244",color_helmet_mask:"#c60c30"},{season:2025,team:"WAS",team_name:"Washington Commanders",team_id:"5110",team_nick:"Commanders",team_conf:"NFC",team_division:"NFC East",team_logo_wikipedia:"https://upload.wikimedia.org/wikipedia/commons/thumb/e/e2/Washington_commanders.svg/100px-Washington_commanders.svg.png",team_wordmark:"/images/wordmarks/WAS.png",team_conference_logo:"/images/conferences/NFC.png",team_logo_squared:"/images/logos/WAS.png",stadium_id:"WAS00",stadium:"Northwest Stadium",color_city_dot:"#FFB612",color_helmet_shell:"#5A1414",color_city_border:"#6c1010",color_helmet_logo:"#FFB612",color_helmet_mask:"#FFB612"}],Bl="../data/pro-tour-schedule.js";async function lr(){var n;if(!((n=globalThis==null?void 0:globalThis.location)!=null&&n.origin))throw new Error("Cannot resolve schedule URL without a browser location.");const e=await import(new URL(Bl,globalThis.location.origin).href),t=e==null?void 0:e.proTourSchedule;if(!t)throw new Error("Schedule module did not provide proTourSchedule.");return t}const ur="America/New_York";function Ui(i,e=ur){return new Intl.DateTimeFormat("en-CA",{timeZone:e,year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date(i))}function Ul(i,e,t,n=ur){var d;const r=new Date(Date.UTC(i,e-1,t,12,0,0)),s=(((d=new Intl.DateTimeFormat("en-US",{timeZone:n,timeZoneName:"shortOffset",hour:"numeric"}).formatToParts(r).find(h=>h.type==="timeZoneName"))==null?void 0:d.value)??"GMT").match(/GMT([+-])(\d{1,2})(?::?(\d{2}))?/i);if(!s)return 0;const l=s[1]==="-"?-1:1,u=Number(s[2]),c=s[3]?Number(s[3]):0;return l*(u*60+c)}function ho(i,e=ur){if(typeof i!="string"||!/^\d{4}-\d{2}-\d{2}$/.test(i))return null;const[t,n,r]=i.split("-"),a=Number(t),o=Number(n),s=Number(r);if(!Number.isFinite(a)||!Number.isFinite(o)||!Number.isFinite(s))return null;const l=Ul(a,o,s,e);return Date.UTC(a,o-1,s,0,0,0)-l*60*1e3}const Hl=/^\d{4}-\d{2}-\d{2}$/,Wl=24*60*60*1e3;function jl(i,{endOfDay:e=!1}={}){if(i==null)return null;if(typeof i=="number"&&Number.isFinite(i))return i;if(i instanceof Date)return i.getTime();if(typeof i=="string"&&Hl.test(i)){const n=ho(i);return Number.isFinite(n)?e?n+Wl-1:n:null}const t=Date.parse(i);return Number.isFinite(t)?t:null}function Ln(i){return Number.isFinite(i)?Ui(i):Ui(Date.now())}function Vl(i=[]){let e=1/0,t=-1/0;if((i??[]).forEach(n=>{const r=typeof(n==null?void 0:n.gamedate)=="string"?n.gamedate:n==null?void 0:n.gameday,a=Date.parse(r);Number.isFinite(a)&&(a<e&&(e=a),a>t&&(t=a))}),!Number.isFinite(e)||!Number.isFinite(t)){const n=Date.now();return{startMs:n,endMs:n,startDate:Ln(n),endDate:Ln(n)}}return{startMs:e,endMs:t,startDate:Ln(e),endDate:Ln(t)}}async function Kl(i){const e=await lr(),t=ql(),n=Yl(),r=Zl(e),a=Vl(e);return{stadiumLookup:t,teamLookup:n,scheduleLookup:r,scheduleRange:a}}function ql(){const i=new Map;return(uo??[]).forEach(e=>{e!=null&&e.stadium_id&&i.set(e.stadium_id,e)}),i}function Yl(){const i=new Map;return(co??[]).forEach(e=>{e!=null&&e.team&&i.set(e.team.toUpperCase(),e)}),i}function Zl(i=[]){const e=new Map;return(i??[]).forEach(t=>{t!=null&&t.game_id&&!e.has(t.game_id)&&e.set(t.game_id,t)}),e}function Jl(i){const e=typeof i=="string"?i.toUpperCase():"";return e?(uo??[]).find(t=>Array.isArray(t==null?void 0:t.home_team)?t.home_team.some(n=>String(n).toUpperCase()===e):!1)??null:null}function Xl(i,e){const t=e.get(String(i).toUpperCase());return(t==null?void 0:t.team_name)??i}const _e={dateStart:null,dateEnd:null,requiredStartDayOfWeek:null,maxTourLengthDays:14,allowFlights:!1,expertMode:!1,maxDriveOneDayGap:5,maxDriveTwoDayGap:10,maxDriveThreeDayGap:15,maxDriveFourDayGap:18,maxRoutesToFind:20,oneDayGap:12,twoDayGap:36,threeDayGap:12+24*2,fourDayGap:12+24*3,minTimeToNextGameHoursFlight:36,maxTimeToNextGameHours:8*24+16,specialGameDayPenalty:.75,revisitMultiplierFloor:.1,travelMultiplierFloor:.1,travelMultiplierCeilingFlight:.2,maxSearchMinutesPerStartGame:1,estimatedMaxGamesPerWeek:2.4,estimatedMinGamesPerWeek:1.4,beamWidthPerStartGame:20,cacheBucketHours:36,enableRouteCache:!0,shortWindowDays:21},fo={ATL97:1,BAL00:1,BOS00:1,BUF00:1,CAR00:1,CHI98:1,CIN00:1,CLE00:1,DAL00:1,DEN00:1,DET00:1,GNB00:1,HOU00:1,IND00:1,JAX00:1,KAN00:1,LAX01:1,MIA00:1,MIN01:1,NAS00:1,NOR00:1,NYC01:1,PHI00:1,PHO00:1,PIT00:1,SEA00:1,SFO01:1,TAM00:1,VEG00:1,WAS00:1},go={ARI:1,ATL:1,BAL:1,BUF:1,CAR:1,CHI:1,CIN:1,CLE:1,DAL:1,DEN:1,DET:1,GB:1,HOU:1,IND:1,JAX:1,KC:1,LA:1,LAC:1,LV:1,MIA:1,MIN:1,NE:1,NO:1,NYG:1,NYJ:1,PHI:1,PIT:1,SEA:1,SF:1,TB:1,TEN:1,WAS:1},lt={restrictions:"pro-tour-restrictions",teamWeights:"pro-tour-team-weights",stadiumWeights:"pro-tour-stadium-weights",favorites:"pro-tour-favorites"},Ql=/^\d{4}-\d{2}-\d{2}$/,Mt=[{value:"Any day",labelKey:"option.startDay.any"},{value:"Sunday",labelKey:"option.startDay.sunday"},{value:"Monday",labelKey:"option.startDay.monday"},{value:"Thursday",labelKey:"option.startDay.thursday"}];function Xn(i){return Number.isFinite(i)?Ui(new Date(i)):""}function ot(i){if(!i)return null;if(i instanceof Date)return i.getTime();if(typeof i=="string"&&Ql.test(i)){const t=ho(i);return Number.isFinite(t)?t:null}const e=Date.parse(i);return Number.isFinite(e)?e:null}function Dn(i,e,t){if(!Number.isFinite(i))return i;const n=Number.isFinite(e)?e:i,r=Number.isFinite(t)?t:i;return Math.min(Math.max(i,n),r)}const ra={en:"en-US",de:"de-DE"},eu={weekday:"short",month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit"},tu={weekday:"short",day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"};function nu(i){return typeof i!="string"?"en":i.toLowerCase().startsWith("de")?"de":"en"}function iu(i,e,t={}){if(!(i instanceof Date)||Number.isNaN(i.getTime()))return"";const n=nu(e),r=n==="de"?ra.de:ra.en,o={...n==="de"?tu:eu};t.timeZone&&typeof t.timeZone=="string"&&(o.timeZone=t.timeZone);try{return new Intl.DateTimeFormat(r,o).format(i)}catch{return""}}function po(i,e){const t=(i==null?void 0:i.gamedateTimestamp)??(i==null?void 0:i.gamedate);if(!t)return T("label.unknown");const n=new Date(t);if(Number.isNaN(n.getTime()))return String(t);const r=i!=null&&i.stadium_id?e.get(i.stadium_id):null,a=r==null?void 0:r.timezone,o=r==null?void 0:r.timezone_label,s=st();let l=iu(n,s,{timeZone:a});return l||(l=n.toISOString()),o?`${l} ${o}`:l}let Ze=null,mo=null;function ru(i){mo=i;const e=cu(_e,i);return Ze={teamWeights:aa(go,lt.teamWeights),stadiumWeights:aa(fo,lt.stadiumWeights),restrictions:e,isSearching:!1,isExpertMode:!!(e!=null&&e.expertMode)},Ze}function je(){if(!Ze)throw new Error("Application state is not initialized.");return Ze}function Qn(){return je().teamWeights}function au(i){return je().teamWeights=pt(i),Ze.teamWeights}function ei(){return je().stadiumWeights}function ou(i){return je().stadiumWeights=pt(i),Ze.stadiumWeights}function Te(){return je().restrictions}function su(i){const e=mo;if(!e)return je().restrictions=i?JSON.parse(JSON.stringify(i)):{},Ze.restrictions;const t=i?JSON.parse(JSON.stringify(i)):_e;return je().restrictions=cr(t,e),Ze.restrictions}function bo(){return!!je().isSearching}function lu(i){return je().isSearching=!!i,Ze.isSearching}function gn(){return!!je().isExpertMode}function uu(i){return je().isExpertMode=!!i,Ze.isExpertMode}function pt(i={}){return Object.fromEntries(Object.entries(i).map(([e,t])=>[e,Number.isFinite(Number(t))?Number(t):1]))}function cu(i={},e){const t=du(),n=t&&typeof t=="object"?{...i,...t}:i,r=cr(n,e);return t&&Rt(r),r}function cr(i,e){const t=JSON.parse(JSON.stringify(i??{})),n=ot(t==null?void 0:t.dateStart),r=ot(t==null?void 0:t.dateEnd);return t.dateStart=Xn(Number.isFinite(n)?n:e.startMs),t.dateEnd=Xn(Number.isFinite(r)?r:e.endMs),(!Number.isFinite(t.shortWindowDays)||t.shortWindowDays<=0)&&(t.shortWindowDays=_e.shortWindowDays),typeof t.expertMode=="string"?t.expertMode=t.expertMode.toLowerCase()==="true":t.expertMode=!!t.expertMode,t}function Hi(i,e,t,n,r){const a=r.startMs,o=r.endMs;let s=ot(t),l=ot(n);if(i==="dateStart")s=Dn(ot(e)??s??a,a,o),(!Number.isFinite(l)||s>l)&&(l=s);else{const u=ot(e);Number.isFinite(u)?l=u+24*60*60*1e3-1:l=Dn(l??o,a,o),(!Number.isFinite(s)||l<s)&&(s=l)}return s=Dn(Number.isFinite(s)?s:a,a,o),l=Dn(Number.isFinite(l)?l:o,a,o),{dateStart:Xn(s),dateEnd:Xn(l)}}function Rt(i){_o(lt.restrictions,i)}function yo({label:i=T("button.restoreDefaults"),getDefaults:e,applyDefaults:t}){const n=document.createElement("button");return n.type="button",n.textContent=i,n.classList.add("btn","btn-text","btn-muted","btn-restore"),n.addEventListener("click",()=>{const r=e==null?void 0:e();r!==void 0&&(t==null||t(r))}),n}function aa(i={},e){const t=vo(e),n=t&&typeof t=="object"?{...i,...t}:i,r=pt(n);return t&&_o(e,r),r}function du(){const i=vo(lt.restrictions);return i&&typeof i=="object"?i:null}function vo(i){if(typeof window>"u"||!window.localStorage)return null;try{const e=window.localStorage.getItem(i);return e?JSON.parse(e):null}catch{return null}}function _o(i,e){if(!(typeof window>"u"||!window.localStorage))try{window.localStorage.setItem(i,JSON.stringify(e))}catch{}}function hu(i,e){if(!i||!e)return;const t=e.startDate??"",n=e.endDate??"";t&&(i.min=t),n&&(i.max=n)}function wo(i,e,t){if(!i||!e||!t)return{refresh:()=>{}};const n=t.startDate??"",r=t.endDate??"",a=()=>{const s=i.value??"",l=e.value??"";if(n){i.min=n;const u=s&&s!==n?s:n;e.min=u||n}else i.removeAttribute("min"),e.removeAttribute("min");if(r){e.max=r;const u=l&&l!==r?l:r;i.max=u||r}else i.removeAttribute("max"),e.removeAttribute("max")},o=()=>{a()};return i.addEventListener("change",o),e.addEventListener("change",o),a(),{refresh:a}}const Un=Object.freeze([{value:"true",labelKey:"option.enabled"},{value:"false",labelKey:"option.disabled"}]),Wi=[{key:"dateStart",labelKey:"label.tourStartDate",type:"date",expert:!1},{key:"dateEnd",labelKey:"label.tourEndDate",type:"date",expert:!1},{key:"requiredStartDayOfWeek",labelKey:"label.routing.requiredStartDay",type:"select",options:Mt,expert:!1},{key:"maxTourLengthDays",labelKey:"label.routing.maxTourLength",type:"number",min:1,step:1,expert:!1},{key:"allowFlights",labelKey:"label.routing.allowFlights",type:"select",options:Un,valueType:"boolean",expert:!1},{key:"maxDriveOneDayGap",labelKey:"label.routing.maxDriveOneDayGap",type:"number",min:0,step:1,expert:!1},{key:"maxDriveTwoDayGap",labelKey:"label.routing.maxDriveTwoDayGap",type:"number",min:0,step:1,expert:!1},{key:"maxDriveThreeDayGap",labelKey:"label.routing.maxDriveThreeDayGap",type:"number",min:0,step:1,expert:!1},{key:"maxDriveFourDayGap",labelKey:"label.routing.maxDriveFourDayGap",type:"number",min:0,step:1,expert:!1},{key:"maxRoutesToFind",labelKey:"label.routing.maxRoutes",type:"number",min:1,step:1,expert:!0},{key:"oneDayGap",labelKey:"label.routing.oneDayGap",type:"number",min:0,step:1,expert:!0},{key:"twoDayGap",labelKey:"label.routing.twoDayGap",type:"number",min:0,step:1,expert:!0},{key:"threeDayGap",labelKey:"label.routing.threeDayGap",type:"number",min:0,step:1,expert:!0},{key:"fourDayGap",labelKey:"label.routing.fourDayGap",type:"number",min:0,step:1,expert:!0},{key:"minTimeToNextGameHoursFlight",labelKey:"label.routing.minTimeToNextGameHoursFlight",type:"number",min:0,step:.5,expert:!0},{key:"maxTimeToNextGameHours",labelKey:"label.routing.maxTimeToNextGameHours",type:"number",min:1,step:1,expert:!0},{key:"specialGameDayPenalty",labelKey:"label.routing.specialGameDayPenalty",type:"number",min:0,step:.05,expert:!0},{key:"revisitMultiplierFloor",labelKey:"label.routing.revisitMultiplierFloor",type:"number",min:0,step:.05,expert:!0},{key:"travelMultiplierCeilingFlight",labelKey:"label.routing.travelMultiplierCeilingFlight",type:"number",min:0,step:.05,expert:!0},{key:"travelMultiplierFloor",labelKey:"label.routing.travelMultiplierFloor",type:"number",min:0,step:.05,expert:!0},{key:"estimatedMinGamesPerWeek",labelKey:"label.routing.estimatedMinGamesPerWeek",type:"number",min:0,step:.1,expert:!0},{key:"estimatedMaxGamesPerWeek",labelKey:"label.routing.estimatedMaxGamesPerWeek",type:"number",min:0,step:.1,expert:!0},{key:"beamWidthPerStartGame",labelKey:"label.routing.beamWidthPerStartGame",type:"number",min:1,step:1,expert:!0},{key:"cacheBucketHours",labelKey:"label.routing.cacheBucketHours",type:"number",min:1,step:1,expert:!0},{key:"maxSearchMinutesPerStartGame",labelKey:"label.routing.maxSearchMinutesPerStartGame",type:"number",min:0,step:.1,expert:!0},{key:"enableRouteCache",labelKey:"label.routing.enableRouteCache",type:"select",options:Un,valueType:"boolean",expert:!0},{key:"expertMode",labelKey:"label.routing.expertMode",type:"select",options:Un,valueType:"boolean",expert:!1}],Nt=5,Ei=35,fu=24*60*60*1e3;var ao;const Fn=((ao=Mt==null?void 0:Mt[0])==null?void 0:ao.value)??"";function gu({ui:i,scheduleRange:e}){const t=wo(i.tourStartInput,i.tourEndInput,e);function n(){b({refreshBounds:!0})}function r(){const g=Te();i.tourStartInput.value=g.dateStart??e.startDate,i.tourEndInput.value=g.dateEnd??e.endDate,b({refreshBounds:!0})}function a(g,w){const _=Te(),x=Hi(g,w,_.dateStart,_.dateEnd,e);_.dateStart=x.dateStart,_.dateEnd=x.dateEnd,r(),Rt(_)}function o(g){const w=typeof g=="string"&&g.length>0?g:Fn,_=Te();_.requiredStartDayOfWeek=w,h(),Rt(_)}function s(g){const w=Te(),_=y(),x=Number(g),S=m(Number.isFinite(x)?x:w.maxTourLengthDays,_);w.maxTourLengthDays=S,p(),Rt(w)}function l(g){const w=Te();w.allowFlights=g==="true",f(),Rt(w)}function u(g){lu(g),i.teamButton.disabled=g,i.cityButton.disabled=g,i.routingButton.disabled=g,i.tourStartInput.disabled=g,i.tourEndInput.disabled=g,i.requiredStartDaySelect.disabled=g,i.maxTourLengthSelect.disabled=g,i.allowFlightsInput.disabled=g,c(g),g&&i.searchButton.removeAttribute("disabled"),i.searchButton.classList.toggle("btn-primary",!g)}return Ot(()=>{u(bo()),b({refreshBounds:!1})}),{initializeDateInputs:n,syncDateInputs:r,handleDateInputChange:a,handleRequiredStartDayChange:o,handleMaxTourLengthChange:s,handleAllowFlightsChange:l,setSearchState:u};function c(g){const w=i.searchButton,_=i.routesHeading,x=i.routesPanel,S=g?"button.searchStop":"button.searchStart",N=g?"label.routesHeading.running":"label.routesHeading",L=T(S);w&&(w.textContent=L,w.setAttribute("data-i18n",S),w.setAttribute("aria-label",L)),_&&(_.textContent=T(N),_.setAttribute("data-i18n",N)),x&&(x.classList.toggle("search-running",!!g),x.classList.toggle("search-finished",!g))}function d(){const g=i.requiredStartDaySelect;if(!g)return;const w=document.createDocumentFragment();(Mt??[]).forEach(_=>{const x=document.createElement("option");x.value=_.value,x.textContent=_.labelKey?T(_.labelKey):_.label??_.value,w.appendChild(x)}),g.innerHTML="",g.appendChild(w)}function h(){const g=i.requiredStartDaySelect;if(!g)return;const w=Te(),_=typeof w.requiredStartDayOfWeek=="string"&&w.requiredStartDayOfWeek.length>0?w.requiredStartDayOfWeek:Fn,S=new Set((Mt??[]).map(N=>N.value)).has(_)?_:Fn;g.value=S,w.requiredStartDayOfWeek!==S&&(S!==Fn||w.requiredStartDayOfWeek)&&(w.requiredStartDayOfWeek=S)}function f(){const g=i.allowFlightsInput;g&&(g.value=Te().allowFlights?"true":"false")}function p(){const g=i.maxTourLengthSelect;if(!g)return;const w=y(),_=document.createDocumentFragment();for(let N=Nt;N<=w;N+=1){const L=document.createElement("option");L.value=String(N),L.textContent=String(N),_.appendChild(L)}g.innerHTML="",g.appendChild(_);const x=Te(),S=m(x.maxTourLengthDays,w);g.value=String(S),x.maxTourLengthDays!==S&&(x.maxTourLengthDays=S)}function m(g,w){const _=Te(),x=Number.isFinite(_==null?void 0:_.maxTourLengthDays)?_.maxTourLengthDays:Number(_e==null?void 0:_e.maxTourLengthDays)||Nt,S=Number.isFinite(g)?Math.trunc(g):x,N=Math.max(Nt,Number(w)||Ei);return Math.min(Math.max(S,Nt),N)}function y(){const g=Te(),w=Number.isFinite(g==null?void 0:g.maxTourLengthDays)?g.maxTourLengthDays:Number(_e==null?void 0:_e.maxTourLengthDays)||Nt,_=k();return Number.isFinite(_)?Math.min(Math.max(Math.floor(_),Nt),Math.max(Ei,w)):Ei}function k(){const g=ot(i.tourStartInput.value),w=ot(i.tourEndInput.value);if(!Number.isFinite(g)||!Number.isFinite(w))return null;const _=Math.floor((w-g)/fu)+1;return _>0?_:null}function v(){const g=i.allowFlightsInput;if(!g)return;const w=document.createDocumentFragment();(Un??[]).forEach(_=>{const x=document.createElement("option");x.value=_.value,x.textContent=_.labelKey?T(_.labelKey):_.label??_.value,w.appendChild(x)}),g.innerHTML="",g.appendChild(w)}function b({refreshBounds:g=!0}={}){g&&t.refresh(),d(),v(),p(),h(),f()}}const oa="has-open-modal";function pu({root:i}){const e=i??document.body;let t=0,n=null,r=0;const a=new Map;function o(f){if(!f||!f.isConnected)return;const p=f.parentElement;p&&p.lastElementChild!==f&&p.appendChild(f)}function s(){t+=1,t===1&&(n=document.body.style.overflow,document.body.style.overflow="hidden")}function l(){t=Math.max(t-1,0),t===0&&n!==null&&(document.body.style.overflow=n,n=null)}function u({onBackgroundPointerDown:f,className:p}={}){const m=document.createElement("div");return m.className=["modal-overlay",p].filter(Boolean).join(" "),m.addEventListener("click",k=>{k.target===m&&typeof f=="function"&&f(k)}),e.appendChild(m),s(),requestAnimationFrame(()=>{m.classList.add("open")}),{overlay:m,dispose:()=>{m.classList.remove("open"),setTimeout(()=>{m.remove()},200),l()}}}function c(){r>0?document.documentElement.classList.add(oa):document.documentElement.classList.remove(oa)}function d({title:f,size:p="medium",build:m,onClose:y,id:k}){var Z;if(k&&a.has(k)){const P=a.get(k);return o(P.overlay),(Z=P.focus)==null||Z.call(P),P.instance}const{overlay:v,dispose:b}=u();r+=1,c();const g=document.createElement("div");g.className=`modal-dialog${p?" "+p:""}`;const w=document.createElement("div");w.className="modal-header";const _=document.createElement("h2");_.textContent=f;const x=document.createElement("button");x.type="button",x.className="btn btn-icon btn-muted modal-close-button";const S=T("aria.closeDialog");x.setAttribute("aria-label",S),x.setAttribute("title",S),x.textContent="",w.append(_,x);const N=document.createElement("div");N.className="modal-body";const L=document.createElement("div");L.className="modal-actions",g.append(w,N,L),v.appendChild(g);const M=P=>{P.key==="Escape"&&(P.preventDefault(),E())},E=()=>{if(document.removeEventListener("keydown",M),b(),r=Math.max(r-1,0),c(),k){const P=a.get(k);(P==null?void 0:P.instance.close)===E&&a.delete(k)}y==null||y()};x.addEventListener("click",E),document.addEventListener("keydown",M);let A=null;const F=(m==null?void 0:m({body:N,actions:L,close:E}))??{};A=(F==null?void 0:F.focusTarget)??null;const G=()=>{const P=A??x;typeof(P==null?void 0:P.focus)=="function"&&requestAnimationFrame(()=>{P.focus()})};G();const W={close:E,overlay:v,dialog:g};return k&&a.set(k,{overlay:v,instance:W,focus:G}),W}function h(f){var m;if(!f)return!1;const p=a.get(f);return p?(o(p.overlay),(m=p.focus)==null||m.call(p),!0):!1}return{open:d,createOverlay:u,focusDialog:h}}function ko({form:i,entries:e,getDefaults:t,onRestore:n}){return yo({getDefaults:t,applyDefaults:r=>{e.forEach(([a])=>{const o=i.elements[a];if(!o)return;const s=Number.isFinite(r[a])?r[a]:1;o.value=s}),n==null||n()}})}function xo(i,e){var t;try{(t=window.localStorage)==null||t.setItem(i,JSON.stringify(e))}catch{}}function So({id:i,name:e,value:t,labelKey:n="label.weight",isExpertMode:r=!1}){const a=document.createElement("div");a.className="preference-input-row";const o=document.createElement("label");o.htmlFor=i,o.textContent=T(n);const s=Number.isFinite(t)?t:1,l=document.createElement("input");if(l.name=e,l.id=i,l.step="0.1",r)l.type="number",l.min="0",l.value=s;else{const d=Math.min(Math.max(s,0),2);l.type="range",l.min=String(0),l.max=String(2),l.step="0.1",l.value=d.toFixed(1)}return a.append(o,l),{wrapper:a,input:l}}function mn({topicId:i,openHelpTopic:e}){const t=document.createElement("button");return t.type="button",t.className="btn btn-text btn-muted",t.textContent=T("button.help"),t.addEventListener("click",()=>{typeof e=="function"&&i&&e(i)}),t}const mu=["item-disabled","item-downgraded","item-default","item-upgraded"];function bu(i){return Number.isFinite(i)?i<=0?"item-disabled":i<1?"item-downgraded":i===1?"item-default":"item-upgraded":"item-default"}function Eo(i,e){if(!i||!e)return;const t=()=>{const n=Number(e.value),r=bu(n);i.classList.remove(...mu),i.classList.add(r)};return e.addEventListener("input",t),e.addEventListener("change",t),e.addEventListener("blur",t),t(),{applyState:t}}const yu="city-preferences-dialog";function vu({dialogKit:i,stadiumLookup:e,teamLookup:t,openHelpTopic:n}){function r(){const a=Object.entries(ei()).sort(([o],[s])=>o.localeCompare(s,"en-US"));i.open({title:T("dialog.cityPreferences.title"),size:"large",id:yu,build({body:o,actions:s,close:l}){const u=document.createElement("form");u.className="preference-form";const c=document.createElement("div");c.className="preference-grid city-grid",a.forEach(([y,k])=>{const v=document.createElement("div");v.className="preference-item city-item";const b=e.get(y),g=document.createElement("div");g.className="item-text";const w=document.createElement("strong");w.textContent=(b==null?void 0:b.location_name)??T("label.unknownLocation");const _=document.createElement("span");_.textContent=(b==null?void 0:b.stadium)??y;const x=document.createElement("span"),N=(Array.isArray(b==null?void 0:b.home_team)?b.home_team:[]).map(A=>{const F=t.get(String(A).toUpperCase());return(F==null?void 0:F.team_name)??String(A)}).filter(Boolean);x.textContent=N.length>0?N.join(", "):T("label.homeTeamUnknown"),g.append(w,_,x);const{wrapper:L,input:M}=So({id:`stadium-weight-${y}`,name:y,value:k,isExpertMode:gn()}),E=Eo(v,M);v.append(g,L),c.appendChild(v),E!=null&&E.applyState&&(M._applyPreferenceState=E.applyState)}),u.appendChild(c),o.appendChild(u);const d=document.createElement("button");d.type="button",d.textContent=T("button.cancel"),d.classList.add("btn","btn-text","btn-muted"),d.addEventListener("click",l);const h=ko({form:u,entries:a,getDefaults:()=>pt(fo),onRestore:()=>{u.querySelectorAll("input").forEach(y=>{typeof y._applyPreferenceState=="function"&&y._applyPreferenceState()})}}),f=mn({topicId:"help-dialog-city-preferences",openHelpTopic:n}),p=document.createElement("button");return p.type="button",p.textContent=T("button.save"),p.classList.add("btn","btn-text","btn-primary"),s.append(h,f,d,p),p.addEventListener("click",()=>{u.requestSubmit()}),u.addEventListener("submit",y=>{y.preventDefault();const k=new FormData(u),v=pt(ei());a.forEach(([g])=>{const w=k.get(g),_=Number(w);v[g]=Number.isFinite(_)&&_>=0?_:0});const b=ou(v);xo(lt.stadiumWeights,b),l()}),{focusTarget:u.querySelector("input")??p}}})}return{openCityPreferences:r}}const _u="routing-parameters-dialog";function wu({dialogKit:i,scheduleRange:e,controls:t,onExpertModeChange:n,openHelpTopic:r}){function a(){i.open({title:T("dialog.routingParameters.title"),size:"large",id:_u,build({body:o,actions:s,close:l}){var _;const u=document.createElement("form");u.className="preference-form";const c=document.createElement("div");c.className="routing-parameters-list";const d=[],h=Te(),f=gn();Wi.forEach(x=>{if(!(x.key in h))return;const S=document.createElement("label");S.className="routing-parameter",x.expert&&(S.dataset.expertField="true",sa(S,f),d.push(S));const N=document.createElement("span");N.textContent=T(x.labelKey);const L=ku(x,h[x.key],e);S.append(N,L),c.appendChild(S)}),u.appendChild(c),o.appendChild(u);const p=wo(u.elements.dateStart,u.elements.dateEnd,e),m=(_=u.elements)==null?void 0:_.expertMode,y=()=>{const x=(m==null?void 0:m.value)==="true";d.forEach(S=>{sa(S,x)})};m==null||m.addEventListener("change",y),y();const k=document.createElement("button");k.type="button",k.textContent=T("button.cancel"),k.classList.add("btn","btn-text","btn-muted"),k.addEventListener("click",l);const v=yo({getDefaults:()=>cr(_e,e),applyDefaults:x=>{xu(u,x),p.refresh(),y()}}),b=mn({topicId:"help-dialog-routing-parameters",openHelpTopic:r}),g=document.createElement("button");return g.type="button",g.textContent=T("button.save"),g.classList.add("btn","btn-text","btn-primary"),s.append(v,b,k,g),g.addEventListener("click",()=>{u.requestSubmit()}),u.addEventListener("submit",x=>{x.preventDefault();const S=new FormData(u),N=Te(),L=JSON.parse(JSON.stringify(N)),M=S.get("expertMode")==="true";L.expertMode=M,Wi.forEach(A=>{if(A.key in L&&!(A.key!=="expertMode"&&A.expert&&!M))if(A.type==="checkbox")L[A.key]=S.get(A.key)==="on";else if(A.type==="date")L[A.key]=S.get(A.key)||L[A.key];else if(A.type==="select"){const F=S.get(A.key),G=dr(A,L[A.key]),W=typeof F=="string"&&F.length>0?F:G;L[A.key]=Su(A,W)}else{const F=S.get(A.key),G=Number(F);Number.isFinite(G)&&(L[A.key]=G)}});let E=Hi("dateStart",L.dateStart,N.dateStart,N.dateEnd,e);E=Hi("dateEnd",L.dateEnd,E.dateStart,E.dateEnd,e),L.dateStart=E.dateStart,L.dateEnd=E.dateEnd,su(L),uu(M),t.syncDateInputs(),Rt(Te()),n==null||n(gn()),l()}),{focusTarget:u.querySelector("input")??g}}})}return{openRoutingParameters:a}}function ku(i,e,t){if(i.type==="checkbox"){const r=document.createElement("input");return r.type="checkbox",r.name=i.key,r.id=i.key,r.checked=!!e,r}if(i.type==="select"){const r=document.createElement("select");r.name=i.key,r.id=i.key;const a=dr(i,e);return(i.options??[]).forEach(o=>{const s=document.createElement("option"),l=To(o.value);s.value=l,s.textContent=o.labelKey?T(o.labelKey):o.label??o.value,l===a&&(s.selected=!0),r.appendChild(s)}),r.value=a,r}const n=document.createElement("input");return n.type=i.type??"number",n.name=i.key,n.id=i.key,i.min!=null&&(n.min=String(i.min)),i.step!=null&&(n.step=String(i.step)),n.value=e??"",i.type==="date"&&hu(n,t),n}function xu(i,e){Wi.forEach(t=>{if(!(t.key in e))return;const n=i.elements[t.key];n&&(t.type==="checkbox"?n.checked=!!e[t.key]:t.type==="select"?n.value=dr(t,e[t.key]):n.value=e[t.key]??"")})}function sa(i,e){i&&(i.hidden=!e,i.style.display=e?"":"none")}function dr(i,e){var n,r;if((i==null?void 0:i.valueType)==="boolean")return e?"true":"false";if(typeof e=="number")return String(e);if(typeof e=="string"&&e.length>0)return e;const t=(r=(n=i==null?void 0:i.options)==null?void 0:n[0])==null?void 0:r.value;return To(t)}function Su(i,e){return(i==null?void 0:i.valueType)==="boolean"?e==="true":e}function To(i){return typeof i=="boolean"?i?"true":"false":typeof i=="number"?String(i):typeof i=="string"?i:""}const on="team-logo";let At;function ji({team:i,variant:e="default",altText:t="",loading:n="lazy"}={}){var c;if(!i)return"";const r=Vi(t||i.team_name||""),a=Cu(),o=(c=a==null?void 0:a.content)==null?void 0:c.firstElementChild;if(!o)return Eu({team:i,variant:e,altText:r,loading:n});const s=o.cloneNode(!0);s.classList.add("helmet",`helmet-${e}`),s.setAttribute("role","img"),s.setAttribute("focusable","false"),s.setAttribute("aria-label",r);const l=Nu(i),u=Tu(l);return`<span class="${on} ${on}-${e}"${u}>${s.outerHTML}</span>`}function Eu({team:i,variant:e,altText:t,loading:n}){if(!(i!=null&&i.team_logo_squared))return"";const r=[`src="${Vi(i.team_logo_squared)}"`,`alt="${t}"`];return n&&r.push(`loading="${Vi(n)}"`),`<span class="${on} ${on}-${e} ${on}-image"><img ${r.join(" ")} /></span>`}function Tu(i){const e=[];return i.shell&&e.push(`--helmet-shell:${i.shell}`),i.mask&&e.push(`--helmet-mask:${i.mask}`),i.logo&&e.push(`--helmet-logo:${i.logo}`),e.length?` style="${e.join("; ")}"`:""}function Cu(){return At!==void 0?At:typeof document>"u"?(At=null,At):(At=document.getElementById("helmet-template"),At)}function Nu(i){return{shell:Ti((i==null?void 0:i.color_helmet_shell)??(i==null?void 0:i.color_helmet_logo)??(i==null?void 0:i.color_helmet_mask)),logo:Ti((i==null?void 0:i.color_helmet_logo)??(i==null?void 0:i.color_helmet_shell)??(i==null?void 0:i.color_helmet_mask)),mask:Ti((i==null?void 0:i.color_helmet_mask)??(i==null?void 0:i.color_helmet_shell))}}function Ti(i){if(!i)return"";const e=String(i).trim();return e&&/^#?[0-9a-fA-F]{3,8}$/.test(e)?e.startsWith("#")?e:`#${e}`:""}function Vi(i){return i==null?"":String(i).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}const Au="team-preferences-dialog";function Lu({dialogKit:i,teamLookup:e,stadiumLookup:t,openHelpTopic:n}){function r(){const a=Object.entries(Qn()).sort(([o],[s])=>o.localeCompare(s,"en-US"));i.open({title:T("dialog.teamPreferences.title"),size:"large",id:Au,build({body:o,actions:s,close:l}){const u=document.createElement("form");u.className="preference-form";const c=document.createElement("div");c.className="preference-grid team-grid",a.forEach(([y,k])=>{const v=document.createElement("div");v.className="preference-item team-item";const b=String(y).toUpperCase(),g=e.get(b),w=Xl(y,e),_=g!=null&&g.stadium_id&&t.has(g.stadium_id)?t.get(g.stadium_id):Jl(b),x=document.createElement("div");x.className="item-header";const S=ji({team:g,variant:"default",altText:T("aria.teamLogo",{team:w})});S&&x.insertAdjacentHTML("beforeend",S);const N=document.createElement("div");N.className="item-text";const L=document.createElement("strong");L.textContent=w;const M=document.createElement("span");M.textContent=(_==null?void 0:_.stadium)??T("label.unknownStadium");const E=document.createElement("span");E.className="item-city",E.textContent=(_==null?void 0:_.location_name)??T("label.unknownCity"),N.append(L,M,E),x.appendChild(N);const{wrapper:A,input:F}=So({id:`team-weight-${y}`,name:y,value:k,isExpertMode:gn()}),G=Eo(v,F);v.append(x,A),c.appendChild(v),G!=null&&G.applyState&&(F._applyPreferenceState=G.applyState)}),u.appendChild(c),o.appendChild(u);const d=document.createElement("button");d.type="button",d.textContent=T("button.cancel"),d.classList.add("btn","btn-text","btn-muted"),d.addEventListener("click",l);const h=ko({form:u,entries:a,getDefaults:()=>pt(go),onRestore:()=>{u.querySelectorAll("input").forEach(y=>{typeof y._applyPreferenceState=="function"&&y._applyPreferenceState()})}}),f=mn({topicId:"help-dialog-team-preferences",openHelpTopic:n}),p=document.createElement("button");return p.type="button",p.textContent=T("button.save"),p.classList.add("btn","btn-text","btn-primary"),s.append(h,f,d,p),p.addEventListener("click",()=>{u.requestSubmit()}),u.addEventListener("submit",y=>{y.preventDefault();const k=new FormData(u),v=pt(Qn());a.forEach(([g])=>{const w=k.get(g),_=Number(w);v[g]=Number.isFinite(_)&&_>=0?_:0});const b=au(v);xo(lt.teamWeights,b),l()}),{focusTarget:u.querySelector("input")??p}}})}return{openTeamPreferences:r}}function la(i){if(!Number.isFinite(i)||i<0)return null;const e=Math.floor(i/1e3),t=e%60,n=Math.floor(e/60)%60,r=Math.floor(e/3600)%24,a=Math.floor(e/86400);return a>0?`${a}d ${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(t).padStart(2,"0")}`:r>0?`${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}:${String(t).padStart(2,"0")}`:n>0||t>0?`${String(n).padStart(2,"0")}:${String(t).padStart(2,"0")}`:`${i.toFixed(0)} ms`}function Du(i){if(!Number.isFinite(i)||i<=0)return null;const e=i/1e3;if(e<60)return`${Math.round(e)}s`;if(e<3600){const r=Math.floor(e/60),a=Math.round(e%60);return a>0?`${r}m ${a}s`:`${r}m`}if(e<86400){const r=Math.floor(e/3600),a=Math.round(e%3600/60);return a>0?`${r}h ${a}m`:`${r}h`}const t=Math.floor(e/86400),n=Math.round(e%86400/3600);return n>0?`${t}d ${n}h`:`${t}d`}function Fu(i){return!Number.isFinite(i)||i<=0?null:`${Math.round(i).toLocaleString()} km`}function Ru(i){return!Number.isFinite(i)||i<=0?null:Math.max(Math.round(i*100).toFixed(0),1)}function Mu(i){return!Number.isFinite(i)||i<0?null:i>=1e9?`${(i/1e9).toFixed(1)}B`:i>=1e6?`${(i/1e6).toFixed(1)}M`:i>=1e3?`${(i/1e3).toFixed(1)}K`:i.toLocaleString()}function Co(i){return!Number.isFinite(i)||i<=0?"0":String(Math.floor(i*100))}function No(i){if(!Number.isFinite(i)||i<=0)return T("label.durationZeroHours");const e=Math.ceil(i/(60*60*1e3)/24),t=Math.max(Math.round(e),1);return T("label.durationDays",{count:t})}function Ao(i,e){return i===e?T("label.routeWeekSingle",{week:i}):T("label.routeWeeksRange",{start:i,end:e})}function Pu(i){const e=(i==null?void 0:i.attributes)??{},t=e.game_id??(i==null?void 0:i.id)??`${e.away_team??"?"}-${e.home_team??"?"}`,n=e.gamedateTimestamp??e.gamedate??"";return`${t}::${n}`}function Lo(i){const e=Array.isArray(i==null?void 0:i.nodes)?i.nodes:[];return e.length===0?"":e.map(t=>Pu(t)).join(">")}function Ki(i){return(Array.isArray(i==null?void 0:i.nodes)?i.nodes:Array.isArray(i)?i:[]).map(t=>({id:(t==null?void 0:t.id)??null,attributes:{...(t==null?void 0:t.attributes)??{}}}))}function Iu(i){return Array.isArray(i)?i.map(e=>({gameId:typeof(e==null?void 0:e.nodeKey)=="string"?e.nodeKey:null,score:Number.isFinite(e==null?void 0:e.score)?e.score:null,travelDurationMs:Number.isFinite(e==null?void 0:e.travelDurationMs)?e.travelDurationMs:null,travelDistanceKm:Number.isFinite(e==null?void 0:e.travelDistanceKm)?e.travelDistanceKm:null,isFlight:(e==null?void 0:e.isFlight)===!0})):[]}function Gu(i){return{nodes:Ki(i),score:Number.isFinite(i==null?void 0:i.score)?i.score:null,totalDurationMs:Number.isFinite(i==null?void 0:i.totalDurationMs)?i.totalDurationMs:null,totalDurationDays:Number.isFinite(i==null?void 0:i.totalDurationDays)?i.totalDurationDays:null,routeTitle:typeof(i==null?void 0:i.routeTitle)=="string"?i.routeTitle:null,nodeMetrics:Iu(i==null?void 0:i.nodeMetrics)}}const $u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Ou={amp:"&",lt:"<",gt:">",quot:'"',"#39":"'"},zu=/[&<>"']/g,Bu=/&(amp|lt|gt|quot|#39);/g;function sn(i){return i==null?"":String(i).replace(zu,e=>$u[e]??e)}function hr(i){return i==null?"":String(i).replace(Bu,(e,t)=>Ou[t]??e)}function ft(i){return typeof i!="string"?"":sn(hr(i))}function Uu(){let i=Hu();const e=new Set;function t(){const f=n();e.forEach(p=>p(f))}function n(){return i.map(f=>{var y,k;const p=typeof((y=f.route)==null?void 0:y.routeTitle)=="string"&&f.route.routeTitle.trim().length>0?ft(f.route.routeTitle.trim()):null,m={...f.route??{},nodes:Ki(((k=f.route)==null?void 0:k.nodes)??f.route)};return p?m.routeTitle=p:delete m.routeTitle,{routeId:f.routeId,addedAt:f.addedAt,route:m}})}function r(f){return i.some(p=>p.routeId===f)}function a(f){const p=Lo(f);if(!p||r(p))return{added:!1,routeId:p};const m={routeId:p,addedAt:Date.now(),route:Gu(f)};return i=[...i,m],Lt(i),t(),{added:!0,entry:m}}function o(f){const p=i.filter(y=>y.routeId!==f),m=p.length!==i.length;return m&&(i=p,Lt(i),t()),m}function s(f,p){const m=i.findIndex(b=>b.routeId===f);if(m===-1)return!1;const y=p==="up"?m-1:m+1;if(y<0||y>=i.length)return!1;const k=[...i],[v]=k.splice(m,1);return k.splice(y,0,v),i=k,Lt(i),t(),!0}function l(){i=[],Lt(i),t()}function u(f,p){var x;if(!f)return!1;const m=i.findIndex(S=>S.routeId===f);if(m===-1)return!1;const y=typeof p=="string"?p.trim():"",k=y.length>0?ft(y):null,v=i[m],b=typeof((x=v==null?void 0:v.route)==null?void 0:x.routeTitle)=="string"?v.route.routeTitle:null;if((b&&b.trim().length>0?ft(b):null)===k)return!1;const w={...v.route??{}};k?w.routeTitle=k:delete w.routeTitle;const _=[...i];return _[m]={...v,route:w},i=_,Lt(i),t(),!0}function c(){const f={version:1,generatedAt:new Date().toISOString(),favorites:i};return JSON.stringify(f,null,2)}function d(f){if(!f||typeof f!="object")throw new Error("invalidPayload");const p=Array.isArray(f.favorites)?f.favorites:[];let m=0,y=0;const k=[...i];return p.forEach(v=>{var S,N,L;const b=typeof(v==null?void 0:v.routeId)=="string"?v.routeId:null,g=Array.isArray((S=v==null?void 0:v.route)==null?void 0:S.nodes)?v.route.nodes:[];if(!b||g.length===0||k.some(M=>M.routeId===b)){y+=1;return}const w=typeof((N=v==null?void 0:v.route)==null?void 0:N.routeTitle)=="string"&&v.route.routeTitle.trim().length>0?ft(v.route.routeTitle.trim()):null,_=Ki(((L=v.route)==null?void 0:L.nodes)??v.route).map(M=>{const E={...(M==null?void 0:M.attributes)??{}};return typeof E.stadium=="string"&&E.stadium.trim().length>0&&(E.stadium=ft(E.stadium.trim())),{...M,attributes:E}}),x={...v.route??{},nodes:_};w?x.routeTitle=w:delete x.routeTitle,k.push({routeId:b,addedAt:Number.isFinite(v==null?void 0:v.addedAt)?v.addedAt:Date.now(),route:x}),m+=1}),i=k,Lt(i),t(),{added:m,skipped:y}}function h(f){return e.add(f),()=>{e.delete(f)}}return{addFavorite:a,removeFavorite:o,moveFavoriteUp:f=>s(f,"up"),moveFavoriteDown:f=>s(f,"down"),clearFavorites:l,updateFavoriteTitle:u,getFavorites:n,isFavorite:r,exportFavorites:c,importFavorites:d,subscribe:h}}function Hu(){if(typeof window>"u"||!window.localStorage)return[];try{const i=window.localStorage.getItem(lt.favorites);if(!i)return[];const e=JSON.parse(i);return Array.isArray(e)?e:[]}catch{return[]}}function Lt(i){if(!(typeof window>"u"||!window.localStorage))try{window.localStorage.setItem(lt.favorites,JSON.stringify(i))}catch{}}function Wu(i,e,t="text/plain"){const n=new Blob([e],{type:t}),r=URL.createObjectURL(n),a=document.createElement("a");a.href=r,a.download=i,a.style.display="none",document.body.appendChild(a),a.click(),a.remove(),URL.revokeObjectURL(r)}function Do({node:i,index:e,stadiumLookup:t,teamLookup:n,metric:r}={}){const a=(i==null?void 0:i.attributes)??{},o=a.stadium_id?t.get(a.stadium_id):null,s=a.stadium??(o==null?void 0:o.stadium)??a.stadium_id??T("label.stadiumTbd"),l=o!=null&&o.location_name?`  ${o.location_name}`:"",u=po(a,t),c=Number.isFinite(a.week)?T("label.weekNumber",{week:a.week}):T("label.weekUnknown"),d=a.game_label&&String(a.game_label).trim().length>0?a.game_label:"",h=a.home_team?n.get(String(a.home_team).toUpperCase()):null,f=a.away_team?n.get(String(a.away_team).toUpperCase()):null,p=(h==null?void 0:h.team_name)??a.home_team??T("label.homeTeamFallback"),m=(f==null?void 0:f.team_name)??a.away_team??T("label.awayTeamFallback"),y=ji({team:h,variant:"home",altText:T("aria.teamLogo",{team:p})}),k=ji({team:f,variant:"away",altText:T("aria.teamLogo",{team:m})}),v=Ru(r==null?void 0:r.score),b=Number.isFinite(r==null?void 0:r.travelDurationMs)&&!(r!=null&&r.isFlight)&&r.travelDurationMs>0?Du(r.travelDurationMs):null,g=Number.isFinite(r==null?void 0:r.travelDistanceKm)&&r.travelDistanceKm>0?Fu(r.travelDistanceKm):null,w=r!=null&&r.isFlight?"":"",_=[];v&&_.push(`<span class="game-card-score">${T("label.routeScore")}: ${v}</span>`);const x=[];if(b&&x.push(`<span class="game-card-travel-time">${T("label.travelTime")}: ${b}</span>`),g){const N=`${g} ${w}`;x.push(`<span class="game-card-travel-distance">${T("label.travelDistance")}: ${N}</span>`)}x.length>0&&_.push(`<span class="game-card-travel">${x.join("  ")}</span>`);const S=_.length>0?`<div class="game-card-meta">${_.join("")}</div>`:"";return`
    <li class="game-card">
      <div class="game-card-header">
        <span class="game-card-order">${e+1}</span>
        <span class="game-card-week">${c}</span>
        ${d?`<span class="game-card-tag">${d}</span>`:""}
        <span class="game-card-kickoff">${u}</span>
      </div>
      <div class="game-card-matchup">
        <div class="route-team route-team-away">
          ${k}
          <span class="route-team-name">${m}</span>
        </div>
        <span class="game-card-at">@</span>
        <div class="route-team route-team-home">
          ${y}
          <span class="route-team-name">${p}</span>
        </div>
      </div>
      <div class="game-card-location">${s}${l}</div>
      ${S}
    </li>
  `}const Ci=new Map,qi=4;function ju({ui:i,stadiumLookup:e,teamLookup:t,favoritesManager:n}){let r=[],a={elapsedMs:0},o=null,s=null,l=T("message.routesAwaitingSearch"),u=new Set,c=new Map,d=new Map,h=!1;const f=i.routesPanel??null;n&&(N(n.getFavorites()??[]),n.subscribe(E=>{N(E),_(r,{emptyMessage:l,force:!0})})),i.routesElement&&i.routesElement.addEventListener("click",E=>{const A=E.target.closest('button[data-action="add-favorite"]');if(!A||!n)return;const F=A.dataset.routeId;!F||!d.has(F)||u.has(F)||(E.preventDefault(),n.addFavorite(d.get(F)))}),Ot(()=>{s?w({...s}):_(r,{emptyMessage:T("message.routesAwaitingSearch"),force:!0})});function p(){f&&f.classList.add("routes-panel-inactive")}function m(){f&&f.classList.remove("routes-panel-inactive")}function y(){if(h){m();return}h=!0,m()}function k(){h=!1,p(),_([],{emptyMessage:T("message.routesAwaitingSearch")}),w({evaluatedRoutes:0,bestRoutes:[],elapsedMs:0,totalStartNodes:0,startNodesProcessed:0,remainingStartNodes:0,estimatedRemainingMs:null,isComplete:!1})}function v(){y(),r=[],a={elapsedMs:0},o=null,w({evaluatedRoutes:0,bestRoutes:[],elapsedMs:0,totalStartNodes:0,startNodesProcessed:0,remainingStartNodes:0,estimatedRemainingMs:null,isComplete:!1})}function b(E,A){r=Array.isArray(E)?E:[],a={elapsedMs:(A==null?void 0:A.elapsedMs)??0}}function g(){_(r,{emptyMessage:l,force:!0})}function w({evaluatedRoutes:E,bestRoutes:A=[],elapsedMs:F=0,totalStartNodes:G,startNodesProcessed:W=0,remainingStartNodes:Z,estimatedRemainingMs:P,isComplete:V=!1,aborted:K=!1}){if(b(A,{elapsedMs:F}),s={evaluatedRoutes:E,bestRoutes:A,elapsedMs:F,totalStartNodes:G,startNodesProcessed:W,remainingStartNodes:Z,estimatedRemainingMs:P,isComplete:V,aborted:K},i.routesProgressElement){const fe=la(F)??"00:00",ae=Mu(E)??"0",ke=Number.isFinite(G)&&G>0?G:null,Ne=Number.isFinite(W)?W+(V?0:1):0,Le=ke!=null?Math.min(Ne,ke):Ne,Oe=V?null:la(P);let pe=`
          <div class="log-item log-elapsed">
            <span class="log-label">${T("log.elapsed")}</span>
            <span class="log-data">${fe}</span>
          </div>
          <div class="log-item log-progress">
            <span class="log-label">${T("log.progress")}</span>
            <span class="log-data">${Le} / ${ke}</span>
          </div>
          <div class="log-item log-evaluated">
            <span class="log-label">${T("log.evaluated")}</span>
            <span class="log-data">${ae!="0"?ae:"..."}</span>
          </div>
      `;V||(pe=`
            ${pe}
            <div class="log-item log-remaining">
              <span class="log-label">${T("log.remaining")}</span>
              <span class="log-data">${Oe||"..."}</span>
            </div>
        `),pe=`
        <div class="log-display log-${V?"finished":"running"}">${pe}</div>
      `,i.routesProgressElement.innerHTML=pe}const ne=T(V?"message.routesEmpty":"message.calculatingRoutes");_(r,{emptyMessage:ne,force:V})}function _(E,{emptyMessage:A,force:F=!1}={}){if(!i.routesElement)return;if(!E||E.length===0){const P=A??T("message.routesEmpty");l=P,d=new Map,i.routesElement.innerHTML=`<p class="empty-state">${P}</p>`;return}A&&(l=A);const G=Vu(E);if(!F&&G===o)return;o=G;const W=new Map,Z=E.map((P,V)=>{const K=P&&typeof P=="object"?P:{},ne=(K==null?void 0:K.nodes)??[],fe=Lo(K),ae=M({routeData:K,games:ne,routeId:fe}),ke={...K,routeTitle:ae};return fe&&W.set(fe,ke),x(ke,V,fe)}).join("");d=W,i.routesElement.innerHTML=Z}function x(E,A,F){var Oe,pe;const G=(E==null?void 0:E.nodes)??[],W=Array.isArray(E==null?void 0:E.nodeMetrics)?E.nodeMetrics:[],Z=((Oe=G[0])==null?void 0:Oe.attributes)??{},P=((pe=G[G.length-1])==null?void 0:pe.attributes)??Z,V=No((E==null?void 0:E.totalDurationMs)??0),K=Number.isFinite(Z==null?void 0:Z.week)?Z.week:"?",ne=Number.isFinite(P==null?void 0:P.week)?P.week:K,fe=Ao(K,ne),ae=T("label.routeLength",{count:G.length}),ke=M({routeData:E,games:G,routeId:F}),Ne=G.map((De,ut)=>Do({node:De,index:ut,stadiumLookup:e,teamLookup:t,metric:W[ut]})).join(""),Le=S(F);return`
      <article class="route-card">
        <header class="route-card-header">
          <h3 class="route-title">${ke}</h3>
          <div class="route-card-items">
            <span class="route-rank">#${A+1}</span>
            <span class="route-length">${ae}</span>
            <div class="route-score">
              <span class="route-score-label">${T("label.routeScore")}</span>
              <span class="route-score-value">${Co((E==null?void 0:E.score)??0)}</span>
            </div>
            ${Le}
          </div>
        </header>
        <div class="route-meta">${V}  ${fe}</div>
        <ol class="game-card-list">${Ne}</ol>
      </article>
    `}function S(E){if(!n||!E)return"";const A=u.has(E),F=T(A?"button.favoriteAdded":"button.addFavorite");return`
      <div class="route-favorite">
        <button
          type="button"
          class="btn btn-icon favorite-toggle ${A?"is-favorite":""}"
          data-action="add-favorite"
          data-route-id="${E}"
          ${A?"disabled":""}
          aria-label="${F}"
          title="${F}"
        >${A?"":""}</button>
      </div>
    `}function N(E=[]){u=new Set(E.map(A=>A.routeId).filter(Boolean)),c=new Map(E.filter(A=>A==null?void 0:A.routeId).map(A=>[A.routeId,A.route??{}]))}function L(E){var F;if(!E||!c.has(E))return null;const A=(F=c.get(E))==null?void 0:F.routeTitle;return typeof A=="string"&&A.trim().length>0?A:null}function M({routeData:E,games:A,routeId:F}){const G=F?L(F):null;if(G&&G.trim().length>0)return ft(G);const W=typeof(E==null?void 0:E.routeTitle)=="string"?E.routeTitle.trim():"";return W.length>0?ft(W):sn(Fo({games:A,stadiumLookup:e,routeId:F}))}return{initialize:k,reset:v,setRoutes:b,showProgress:w,refresh:g,getRoutes:()=>r,getMetadata:()=>a}}function Vu(i){return!Array.isArray(i)||i.length===0?"__EMPTY__":i.map(e=>{var o,s,l,u,c;const t=((s=(o=e==null?void 0:e.nodes)==null?void 0:o[0])==null?void 0:s.id)??"",n=((u=(l=e==null?void 0:e.nodes)==null?void 0:l[e.nodes.length-1])==null?void 0:u.id)??"",r=Number.isFinite(e==null?void 0:e.score)?e.score:0,a=Number.isFinite(e==null?void 0:e.totalDurationMs)?e.totalDurationMs:0;return`${t}-${n}-${((c=e==null?void 0:e.nodes)==null?void 0:c.length)??0}-${r.toFixed(4)}-${a}`}).join("|")}function Fo({games:i=[],stadiumLookup:e,routeId:t}){const n=Ku(i,e);if(n.length===0)return T("label.unknownCity");const r=n[0];if(n.length===1)return T("label.routeTitle.single",{firstCity:r});const a=n[n.length-1]??r;if(n.length===2)return T("label.routeTitle.range",{firstCity:r,lastCity:a});const o=n.slice(1,-1);if(o.length<=qi){const h=ua(o);return T("label.routeTitle.via",{firstCity:r,lastCity:a,viaList:h})}const s=Math.max(qi-1,1),l=Yu(o,t??`${r}-${a}-${n.length}`,s),u=ua(l,{includeConjunction:!1}),c=Math.max(o.length-l.length,0),d=T("label.routeTitle.remaining",{count:c});return T("label.routeTitle.viaOverflow",{firstCity:r,lastCity:a,viaList:u,remainingLabel:d})}function Ku(i=[],e){return i.map(t=>{const n=(t==null?void 0:t.attributes)??{},r=n.stadium_id&&(e!=null&&e.get)?e.get(n.stadium_id):null,a=(r==null?void 0:r.city_name)??n.city_name??n.location_city??n.city??null,o=typeof a=="string"?a.trim():"";return o.length>0?o:T("label.unknownCity")})}function ua(i,{includeConjunction:e=!0}={}){if(!Array.isArray(i)||i.length===0)return"";const t=st();if(e){const n=qu(t);if(n)return n.format(i)}return i.join(", ")}function qu(i){if(!i)return null;if(Ci.has(i))return Ci.get(i);if(typeof Intl>"u"||typeof Intl.ListFormat>"u")return null;const e=new Intl.ListFormat(i,{style:"long",type:"conjunction"});return Ci.set(i,e),e}function Yu(i,e="",t=qi){if(!Array.isArray(i)||i.length===0)return[];const n=Math.min(Math.max(t,1),i.length);if(i.length<=n)return[...i];const r=Zu(e),a=new Set;for(;a.size<n;){const o=Math.floor(r()*i.length);a.add(Math.min(Math.max(o,0),i.length-1))}return Array.from(a).sort((o,s)=>o-s).map(o=>i[o])}function Zu(i=""){let e=0;const t=typeof i=="string"&&i.length>0?i:"route-title";for(let n=0;n<t.length;n+=1)e=e*31+t.charCodeAt(n)>>>0;return e===0&&(e=439041101),function(){e+=1831565813;let r=e;return r=Math.imul(r^r>>>15,r|1),r^=r+Math.imul(r^r>>>7,r|61),((r^r>>>14)>>>0)/4294967296}}const Ju="favorites-dialog";function Xu({dialogKit:i,favoritesManager:e,stadiumLookup:t,teamLookup:n,openHelpTopic:r,onDialogClose:a}){function o(){let c=null;return i.open({title:T("dialog.favorites.title"),size:"large",id:Ju,onClose:()=>{c==null||c(),a==null||a()},build({body:h,actions:f,close:p}){const m=document.createElement("div");m.className="favorites-list";const y=document.createElement("div");y.className="favorites-control-bar";const k=document.createElement("button");k.type="button",k.textContent=T("button.importFavorites"),k.classList.add("btn","btn-text","btn-muted");const v=document.createElement("button");v.type="button",v.textContent=T("button.exportFavorites"),v.classList.add("btn","btn-text","btn-muted"),y.append(k,v);const b=document.createElement("input");b.type="file",b.accept="application/json",b.hidden=!0,h.append(m,b);const g=document.createElement("button");g.type="button",g.textContent=T("button.close"),g.classList.add("btn","btn-text","btn-primary"),g.addEventListener("click",p);const w=mn({topicId:"help-dialog-favorites",openHelpTopic:r});f.append(y,w,g);const _=()=>{const x=e.getFavorites();if(m.innerHTML="",!x.length){const S=document.createElement("p");S.className="empty-state",S.textContent=T("message.favoritesEmpty"),m.appendChild(S);return}x.forEach((S,N)=>{var Ne,Le,Oe,pe,De,ut;const L=document.createElement("article");L.className="route-card favorite-card",L.dataset.routeId=S.routeId;const M=((Ne=S.route)==null?void 0:Ne.nodes)??[],E=Array.isArray((Le=S.route)==null?void 0:Le.nodeMetrics)?S.route.nodeMetrics:[],A=((Oe=M[0])==null?void 0:Oe.attributes)??{},F=((pe=M[M.length-1])==null?void 0:pe.attributes)??A,G=No(((De=S.route)==null?void 0:De.totalDurationMs)??0),W=Number.isFinite(A==null?void 0:A.week)?A.week:"?",Z=Number.isFinite(F==null?void 0:F.week)?F.week:W,P=Ao(W,Z),V=T("label.routeLength",{count:M.length}),K=sn(Ni(S,t)),ne=M.map((Ht,ct)=>Do({node:Ht,index:ct,stadiumLookup:t,teamLookup:n,metric:E[ct]})).join(""),fe=N>0?`<button type="button" class="btn btn-icon btn-muted favorite-move" data-action="favorite-move-up" data-route-id="${S.routeId}" aria-label="${T("button.moveUp")}" title="${T("button.moveUp")}"></button>`:"",ae=N<x.length-1?`<button type="button" class="btn btn-icon btn-muted favorite-move" data-action="favorite-move-down" data-route-id="${S.routeId}" aria-label="${T("button.moveDown")}" title="${T("button.moveDown")}"></button>`:"";L.innerHTML=`
              <header class="route-card-header">
                <h3 class="route-title">${K}</h3>
                <div class="route-card-items">
                  <span class="route-length">${V}</span>
                  <div class="route-score">
                    <span class="route-score-label">${T("label.routeScore")}</span>
                    <span class="route-score-value">${Co(((ut=S.route)==null?void 0:ut.score)??0)}</span>
                  </div>
                  <div class="favorite-card-actions">
                    ${fe}
                    ${ae}
                    <button type="button" class="btn btn-icon btn-danger favorite-remove" data-action="favorite-remove" data-route-id="${S.routeId}" aria-label="${T("button.removeFavorite")}" title="${T("button.removeFavorite")}"></button>
                  </div>                  
                </div>
              </header>
              <div class="route-meta">${G}  ${P}</div>
              <ol class="game-card-list">${ne}</ol>
            `,m.appendChild(L);const ke=L.querySelector(".route-title");u({titleElement:ke,entry:S})})};return m.addEventListener("click",x=>{const S=x.target.closest("button[data-action]");if(!S)return;const N=S.dataset.routeId,L=S.dataset.action;N&&(L==="favorite-remove"?l(N):L==="favorite-move-up"?e.moveFavoriteUp(N):L==="favorite-move-down"&&e.moveFavoriteDown(N))}),v.addEventListener("click",()=>{const x=e.exportFavorites(),S=`pro-football-tours-${new Date().toISOString().replace(/[:.]/g,"-")}.json`;Wu(S,x,"application/json")}),k.addEventListener("click",()=>{b.value="",b.click()}),b.addEventListener("change",async x=>{var N;const S=(N=x.target.files)==null?void 0:N[0];if(S)try{const L=await S.text(),M=JSON.parse(L),E=e.importFavorites(M);s("message.favoritesImportSummary",{added:E.added,skipped:E.skipped})}catch{s("error.favoritesImportInvalid")}}),_(),c=e.subscribe(_),{focusTarget:m}}})}function s(c,d){i.open({title:T("dialog.favorites.importStatusTitle"),size:"small",build({body:h,actions:f,close:p}){const m=document.createElement("p");m.textContent=T(c,d??{}),h.appendChild(m);const y=document.createElement("button");return y.type="button",y.textContent=T("button.close"),y.classList.add("btn","btn-text","btn-primary"),y.addEventListener("click",p),f.append(y),{focusTarget:y}}})}function l(c){c&&i.open({title:T("dialog.favorites.removeConfirmTitle"),size:"small",build({body:d,actions:h,close:f}){const p=document.createElement("p");p.textContent=T("message.favoritesRemoveConfirm"),d.appendChild(p);const m=document.createElement("button");m.type="button",m.textContent=T("button.cancel"),m.classList.add("btn","btn-text","btn-muted"),m.addEventListener("click",f);const y=document.createElement("button");return y.type="button",y.textContent=T("button.remove"),y.classList.add("btn","btn-text","btn-danger"),y.addEventListener("click",()=>{e.removeFavorite(c),f()}),h.append(m,y),{focusTarget:y}}})}return{openFavorites:o};function u({titleElement:c,entry:d}){if(!c||!(d!=null&&d.routeId))return;c.classList.add("route-title-editable"),c.setAttribute("tabindex","0");const h=p=>{(p.key==="Enter"||p.key===" ")&&(p.preventDefault(),f())},f=()=>{var w;const m=(typeof((w=d==null?void 0:d.route)==null?void 0:w.routeTitle)=="string"&&d.route.routeTitle.trim().length>0?hr(d.route.routeTitle):null)??c.textContent??"",{height:y}=c.getBoundingClientRect(),k=document.createElement("textarea");k.value=m,k.className="route-title route-title-input",Number.isFinite(y)&&y>0&&k.style.setProperty("--route-title-input-height",`${y}px`),k.setAttribute("aria-label",T("label.editRouteTitle")),c.replaceWith(k),k.focus(),k.select();const v=(_,{restoreFocus:x=!0}={})=>{k.removeEventListener("blur",b),k.removeEventListener("keydown",g);const S=k.value.trim(),N=S.length>0?S:null,L=N?sn(N):null;_&&(d.route||(d.route={}),L?d.route.routeTitle=L:delete d.route.routeTitle);const M=_?N??Ni(d,t):Ni(d,t),E=document.createElement("h3");E.className="route-title",E.innerHTML=sn(M),k.replaceWith(E),u({titleElement:E,entry:d}),x&&E.focus(),_&&e.updateFavoriteTitle(d.routeId,L)},b=()=>v(!0,{restoreFocus:!1}),g=_=>{_.key==="Enter"?(_.preventDefault(),v(!0,{restoreFocus:!0})):_.key==="Escape"&&(_.preventDefault(),v(!1,{restoreFocus:!0}))};k.addEventListener("blur",b),k.addEventListener("keydown",g)};c.addEventListener("click",f),c.addEventListener("keydown",h)}}function Ni(i,e){var r,a;const t=(r=i==null?void 0:i.route)==null?void 0:r.routeTitle;if(typeof t=="string"&&t.trim().length>0)return hr(t);const n=((a=i==null?void 0:i.route)==null?void 0:a.nodes)??[];return Fo({games:n,stadiumLookup:e,routeId:i==null?void 0:i.routeId})}function fr(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let vt=fr();function Ro(i){vt=i}const Mo=/[&<>"']/,Qu=new RegExp(Mo.source,"g"),Po=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,ec=new RegExp(Po.source,"g"),tc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},ca=i=>tc[i];function Ae(i,e){if(e){if(Mo.test(i))return i.replace(Qu,ca)}else if(Po.test(i))return i.replace(ec,ca);return i}const nc=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function ic(i){return i.replace(nc,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const rc=/(^|[^\[])\^/g;function X(i,e){let t=typeof i=="string"?i:i.source;e=e||"";const n={replace:(r,a)=>{let o=typeof a=="string"?a:a.source;return o=o.replace(rc,"$1"),t=t.replace(r,o),n},getRegex:()=>new RegExp(t,e)};return n}function da(i){try{i=encodeURI(i).replace(/%25/g,"%")}catch{return null}return i}const ln={exec:()=>null};function ha(i,e){const t=i.replace(/\|/g,(a,o,s)=>{let l=!1,u=o;for(;--u>=0&&s[u]==="\\";)l=!l;return l?"|":" |"}),n=t.split(/ \|/);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function Rn(i,e,t){const n=i.length;if(n===0)return"";let r=0;for(;r<n&&i.charAt(n-r-1)===e;)r++;return i.slice(0,n-r)}function ac(i,e){if(i.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<i.length;n++)if(i[n]==="\\")n++;else if(i[n]===e[0])t++;else if(i[n]===e[1]&&(t--,t<0))return n;return-1}function fa(i,e,t,n){const r=e.href,a=e.title?Ae(e.title):null,o=i[1].replace(/\\([\[\]])/g,"$1");if(i[0].charAt(0)!=="!"){n.state.inLink=!0;const s={type:"link",raw:t,href:r,title:a,text:o,tokens:n.inlineTokens(o)};return n.state.inLink=!1,s}return{type:"image",raw:t,href:r,title:a,text:Ae(o)}}function oc(i,e){const t=i.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(r=>{const a=r.match(/^\s+/);if(a===null)return r;const[o]=a;return o.length>=n.length?r.slice(n.length):r}).join(`
`)}class ti{constructor(e){re(this,"options");re(this,"rules");re(this,"lexer");this.options=e||vt}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:Rn(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=oc(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const r=Rn(n,"#");(this.options.pedantic||!r||/ $/.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=t[0].replace(/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,`
    $1`);n=Rn(n.replace(/^ *>[ \t]?/gm,""),`
`);const r=this.lexer.state.top;this.lexer.state.top=!0;const a=this.lexer.blockTokens(n);return this.lexer.state.top=r,{type:"blockquote",raw:t[0],tokens:a,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,a={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const o=new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`);let s="",l="",u=!1;for(;e;){let c=!1;if(!(t=o.exec(e))||this.rules.block.hr.test(e))break;s=t[0],e=e.substring(s.length);let d=t[2].split(`
`,1)[0].replace(/^\t+/,k=>" ".repeat(3*k.length)),h=e.split(`
`,1)[0],f=0;this.options.pedantic?(f=2,l=d.trimStart()):(f=t[2].search(/[^ ]/),f=f>4?1:f,l=d.slice(f),f+=t[1].length);let p=!1;if(!d&&/^ *$/.test(h)&&(s+=h+`
`,e=e.substring(h.length+1),c=!0),!c){const k=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),v=new RegExp(`^ {0,${Math.min(3,f-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),b=new RegExp(`^ {0,${Math.min(3,f-1)}}(?:\`\`\`|~~~)`),g=new RegExp(`^ {0,${Math.min(3,f-1)}}#`);for(;e;){const w=e.split(`
`,1)[0];if(h=w,this.options.pedantic&&(h=h.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),b.test(h)||g.test(h)||k.test(h)||v.test(e))break;if(h.search(/[^ ]/)>=f||!h.trim())l+=`
`+h.slice(f);else{if(p||d.search(/[^ ]/)>=4||b.test(d)||g.test(d)||v.test(d))break;l+=`
`+h}!p&&!h.trim()&&(p=!0),s+=w+`
`,e=e.substring(w.length+1),d=h.slice(f)}}a.loose||(u?a.loose=!0:/\n *\n *$/.test(s)&&(u=!0));let m=null,y;this.options.gfm&&(m=/^\[[ xX]\] /.exec(l),m&&(y=m[0]!=="[ ] ",l=l.replace(/^\[[ xX]\] +/,""))),a.items.push({type:"list_item",raw:s,task:!!m,checked:y,loose:!1,text:l,tokens:[]}),a.raw+=s}a.items[a.items.length-1].raw=s.trimEnd(),a.items[a.items.length-1].text=l.trimEnd(),a.raw=a.raw.trimEnd();for(let c=0;c<a.items.length;c++)if(this.lexer.state.top=!1,a.items[c].tokens=this.lexer.blockTokens(a.items[c].text,[]),!a.loose){const d=a.items[c].tokens.filter(f=>f.type==="space"),h=d.length>0&&d.some(f=>/\n.*\n/.test(f.raw));a.loose=h}if(a.loose)for(let c=0;c<a.items.length;c++)a.items[c].loose=!0;return a}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",a=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:a}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const n=ha(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),a=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],o={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const s of r)/^ *-+: *$/.test(s)?o.align.push("right"):/^ *:-+: *$/.test(s)?o.align.push("center"):/^ *:-+ *$/.test(s)?o.align.push("left"):o.align.push(null);for(const s of n)o.header.push({text:s,tokens:this.lexer.inline(s)});for(const s of a)o.rows.push(ha(s,o.header.length).map(l=>({text:l,tokens:this.lexer.inline(l)})));return o}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:Ae(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const o=Rn(n.slice(0,-1),"\\");if((n.length-o.length)%2===0)return}else{const o=ac(t[2],"()");if(o>-1){const l=(t[0].indexOf("!")===0?5:4)+t[1].length+o;t[2]=t[2].substring(0,o),t[0]=t[0].substring(0,l).trim(),t[3]=""}}let r=t[2],a="";if(this.options.pedantic){const o=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);o&&(r=o[1],a=o[3])}else a=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(n)?r=r.slice(1):r=r.slice(1,-1)),fa(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:a&&a.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(/\s+/g," "),a=t[r.toLowerCase()];if(!a){const o=n[0].charAt(0);return{type:"text",raw:o,text:o}}return fa(n,a,n[0],this.lexer)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const o=[...r[0]].length-1;let s,l,u=o,c=0;const d=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(d.lastIndex=0,t=t.slice(-1*e.length+o);(r=d.exec(t))!=null;){if(s=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!s)continue;if(l=[...s].length,r[3]||r[4]){u+=l;continue}else if((r[5]||r[6])&&o%3&&!((o+l)%3)){c+=l;continue}if(u-=l,u>0)continue;l=Math.min(l,l+u+c);const h=[...r[0]][0].length,f=e.slice(0,o+r.index+h+l);if(Math.min(o,l)%2){const m=f.slice(1,-1);return{type:"em",raw:f,text:m,tokens:this.lexer.inlineTokens(m)}}const p=f.slice(2,-2);return{type:"strong",raw:f,text:p,tokens:this.lexer.inlineTokens(p)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const r=/[^ ]/.test(n),a=/^ /.test(n)&&/ $/.test(n);return r&&a&&(n=n.substring(1,n.length-1)),n=Ae(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=Ae(t[1]),r="mailto:"+n):(n=Ae(t[1]),r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,a;if(t[2]==="@")r=Ae(t[0]),a="mailto:"+r;else{let o;do o=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(o!==t[0]);r=Ae(t[0]),t[1]==="www."?a="http://"+t[0]:a=t[0]}return{type:"link",raw:t[0],text:r,href:a,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let n;return this.lexer.state.inRawBlock?n=t[0]:n=Ae(t[0]),{type:"text",raw:t[0],text:n}}}}const sc=/^(?: *(?:\n|$))+/,lc=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,uc=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,bn=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,cc=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Io=/(?:[*+-]|\d{1,9}[.)])/,Go=X(/^(?!bull |blockCode|fences|blockquote|heading|html)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Io).replace(/blockCode/g,/ {4}/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).getRegex(),gr=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,dc=/^[^\n]+/,pr=/(?!\s*\])(?:\\.|[^\[\]\\])+/,hc=X(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",pr).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),fc=X(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Io).getRegex(),si="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",mr=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,gc=X("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",mr).replace("tag",si).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),$o=X(gr).replace("hr",bn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",si).getRegex(),pc=X(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",$o).getRegex(),br={blockquote:pc,code:lc,def:hc,fences:uc,heading:cc,hr:bn,html:gc,lheading:Go,list:fc,newline:sc,paragraph:$o,table:ln,text:dc},ga=X("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",bn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",si).getRegex(),mc={...br,table:ga,paragraph:X(gr).replace("hr",bn).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",ga).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",si).getRegex()},bc={...br,html:X(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",mr).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:ln,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:X(gr).replace("hr",bn).replace("heading",` *#{1,6} *[^
]`).replace("lheading",Go).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},Oo=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,yc=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,zo=/^( {2,}|\\)\n(?!\s*$)/,vc=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,yn="\\p{P}\\p{S}",_c=X(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,yn).getRegex(),wc=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,kc=X(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,yn).getRegex(),xc=X("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,yn).getRegex(),Sc=X("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,yn).getRegex(),Ec=X(/\\([punct])/,"gu").replace(/punct/g,yn).getRegex(),Tc=X(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Cc=X(mr).replace("(?:-->|$)","-->").getRegex(),Nc=X("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Cc).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),ni=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,Ac=X(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",ni).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),Bo=X(/^!?\[(label)\]\[(ref)\]/).replace("label",ni).replace("ref",pr).getRegex(),Uo=X(/^!?\[(ref)\](?:\[\])?/).replace("ref",pr).getRegex(),Lc=X("reflink|nolink(?!\\()","g").replace("reflink",Bo).replace("nolink",Uo).getRegex(),yr={_backpedal:ln,anyPunctuation:Ec,autolink:Tc,blockSkip:wc,br:zo,code:yc,del:ln,emStrongLDelim:kc,emStrongRDelimAst:xc,emStrongRDelimUnd:Sc,escape:Oo,link:Ac,nolink:Uo,punctuation:_c,reflink:Bo,reflinkSearch:Lc,tag:Nc,text:vc,url:ln},Dc={...yr,link:X(/^!?\[(label)\]\((.*?)\)/).replace("label",ni).getRegex(),reflink:X(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",ni).getRegex()},Yi={...yr,escape:X(Oo).replace("])","~|])").getRegex(),url:X(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},Fc={...Yi,br:X(zo).replace("{2,}","*").getRegex(),text:X(Yi.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},Mn={normal:br,gfm:mc,pedantic:bc},Vt={normal:yr,gfm:Yi,breaks:Fc,pedantic:Dc};class qe{constructor(e){re(this,"tokens");re(this,"options");re(this,"state");re(this,"tokenizer");re(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||vt,this.options.tokenizer=this.options.tokenizer||new ti,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:Mn.normal,inline:Vt.normal};this.options.pedantic?(t.block=Mn.pedantic,t.inline=Vt.pedantic):this.options.gfm&&(t.block=Mn.gfm,this.options.breaks?t.inline=Vt.breaks:t.inline=Vt.gfm),this.tokenizer.rules=t}static get rules(){return{block:Mn,inline:Vt}}static lex(e,t){return new qe(t).lex(e)}static lexInline(e,t){return new qe(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(s,l,u)=>l+"    ".repeat(u.length));let n,r,a,o;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(s=>(n=s.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(a=e,this.options.extensions&&this.options.extensions.startBlock){let s=1/0;const l=e.slice(1);let u;this.options.extensions.startBlock.forEach(c=>{u=c.call({lexer:this},l),typeof u=="number"&&u>=0&&(s=Math.min(s,u))}),s<1/0&&s>=0&&(a=e.substring(0,s+1))}if(this.state.top&&(n=this.tokenizer.paragraph(a))){r=t[t.length-1],o&&r.type==="paragraph"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),o=a.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(e){const s="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,r,a,o=e,s,l,u;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(o))!=null;)c.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.blockSkip.exec(o))!=null;)o=o.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+o.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(o))!=null;)o=o.slice(0,s.index)+"++"+o.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(l||(u=""),l=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>(n=c.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,o,u)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}if(a=e,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const d=e.slice(1);let h;this.options.extensions.startInline.forEach(f=>{h=f.call({lexer:this},d),typeof h=="number"&&h>=0&&(c=Math.min(c,h))}),c<1/0&&c>=0&&(a=e.substring(0,c+1))}if(n=this.tokenizer.inlineText(a)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(u=n.raw.slice(-1)),l=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return t}}class ii{constructor(e){re(this,"options");this.options=e||vt}code(e,t,n){var a;const r=(a=(t||"").match(/^\S*/))==null?void 0:a[0];return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="language-'+Ae(r)+'">'+(n?e:Ae(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:Ae(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,n){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,n){const r=t?"ol":"ul",a=t&&n!==1?' start="'+n+'"':"";return"<"+r+a+`>
`+e+"</"+r+`>
`}listitem(e,t,n){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){const r=da(e);if(r===null)return n;e=r;let a='<a href="'+e+'"';return t&&(a+=' title="'+t+'"'),a+=">"+n+"</a>",a}image(e,t,n){const r=da(e);if(r===null)return n;e=r;let a=`<img src="${e}" alt="${n}"`;return t&&(a+=` title="${t}"`),a+=">",a}text(e){return e}}class vr{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class Ye{constructor(e){re(this,"options");re(this,"renderer");re(this,"textRenderer");this.options=e||vt,this.options.renderer=this.options.renderer||new ii,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new vr}static parse(e,t){return new Ye(t).parse(e)}static parseInline(e,t){return new Ye(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const o=a,s=this.options.extensions.renderers[o.type].call({parser:this},o);if(s!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(o.type)){n+=s||"";continue}}switch(a.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{const o=a;n+=this.renderer.heading(this.parseInline(o.tokens),o.depth,ic(this.parseInline(o.tokens,this.textRenderer)));continue}case"code":{const o=a;n+=this.renderer.code(o.text,o.lang,!!o.escaped);continue}case"table":{const o=a;let s="",l="";for(let c=0;c<o.header.length;c++)l+=this.renderer.tablecell(this.parseInline(o.header[c].tokens),{header:!0,align:o.align[c]});s+=this.renderer.tablerow(l);let u="";for(let c=0;c<o.rows.length;c++){const d=o.rows[c];l="";for(let h=0;h<d.length;h++)l+=this.renderer.tablecell(this.parseInline(d[h].tokens),{header:!1,align:o.align[h]});u+=this.renderer.tablerow(l)}n+=this.renderer.table(s,u);continue}case"blockquote":{const o=a,s=this.parse(o.tokens);n+=this.renderer.blockquote(s);continue}case"list":{const o=a,s=o.ordered,l=o.start,u=o.loose;let c="";for(let d=0;d<o.items.length;d++){const h=o.items[d],f=h.checked,p=h.task;let m="";if(h.task){const y=this.renderer.checkbox(!!f);u?h.tokens.length>0&&h.tokens[0].type==="paragraph"?(h.tokens[0].text=y+" "+h.tokens[0].text,h.tokens[0].tokens&&h.tokens[0].tokens.length>0&&h.tokens[0].tokens[0].type==="text"&&(h.tokens[0].tokens[0].text=y+" "+h.tokens[0].tokens[0].text)):h.tokens.unshift({type:"text",text:y+" "}):m+=y+" "}m+=this.parse(h.tokens,u),c+=this.renderer.listitem(m,p,!!f)}n+=this.renderer.list(c,s,l);continue}case"html":{const o=a;n+=this.renderer.html(o.text,o.block);continue}case"paragraph":{const o=a;n+=this.renderer.paragraph(this.parseInline(o.tokens));continue}case"text":{let o=a,s=o.tokens?this.parseInline(o.tokens):o.text;for(;r+1<e.length&&e[r+1].type==="text";)o=e[++r],s+=`
`+(o.tokens?this.parseInline(o.tokens):o.text);n+=t?this.renderer.paragraph(s):s;continue}default:{const o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return n}parseInline(e,t){t=t||this.renderer;let n="";for(let r=0;r<e.length;r++){const a=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[a.type]){const o=this.options.extensions.renderers[a.type].call({parser:this},a);if(o!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(a.type)){n+=o||"";continue}}switch(a.type){case"escape":{const o=a;n+=t.text(o.text);break}case"html":{const o=a;n+=t.html(o.text);break}case"link":{const o=a;n+=t.link(o.href,o.title,this.parseInline(o.tokens,t));break}case"image":{const o=a;n+=t.image(o.href,o.title,o.text);break}case"strong":{const o=a;n+=t.strong(this.parseInline(o.tokens,t));break}case"em":{const o=a;n+=t.em(this.parseInline(o.tokens,t));break}case"codespan":{const o=a;n+=t.codespan(o.text);break}case"br":{n+=t.br();break}case"del":{const o=a;n+=t.del(this.parseInline(o.tokens,t));break}case"text":{const o=a;n+=t.text(o.text);break}default:{const o='Token with "'+a.type+'" type was not found.';if(this.options.silent)return console.error(o),"";throw new Error(o)}}}return n}}class un{constructor(e){re(this,"options");this.options=e||vt}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}re(un,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var yt,Zi,Ho;class Rc{constructor(...e){jr(this,yt);re(this,"defaults",fr());re(this,"options",this.setOptions);re(this,"parse",Nn(this,yt,Zi).call(this,qe.lex,Ye.parse));re(this,"parseInline",Nn(this,yt,Zi).call(this,qe.lexInline,Ye.parseInline));re(this,"Parser",Ye);re(this,"Renderer",ii);re(this,"TextRenderer",vr);re(this,"Lexer",qe);re(this,"Tokenizer",ti);re(this,"Hooks",un);this.use(...e)}walkTokens(e,t){var r,a;let n=[];for(const o of e)switch(n=n.concat(t.call(this,o)),o.type){case"table":{const s=o;for(const l of s.header)n=n.concat(this.walkTokens(l.tokens,t));for(const l of s.rows)for(const u of l)n=n.concat(this.walkTokens(u.tokens,t));break}case"list":{const s=o;n=n.concat(this.walkTokens(s.items,t));break}default:{const s=o;(a=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&a[s.type]?this.defaults.extensions.childTokens[s.type].forEach(l=>{const u=s[l].flat(1/0);n=n.concat(this.walkTokens(u,t))}):s.tokens&&(n=n.concat(this.walkTokens(s.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(a=>{if(!a.name)throw new Error("extension name required");if("renderer"in a){const o=t.renderers[a.name];o?t.renderers[a.name]=function(...s){let l=a.renderer.apply(this,s);return l===!1&&(l=o.apply(this,s)),l}:t.renderers[a.name]=a.renderer}if("tokenizer"in a){if(!a.level||a.level!=="block"&&a.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const o=t[a.level];o?o.unshift(a.tokenizer):t[a.level]=[a.tokenizer],a.start&&(a.level==="block"?t.startBlock?t.startBlock.push(a.start):t.startBlock=[a.start]:a.level==="inline"&&(t.startInline?t.startInline.push(a.start):t.startInline=[a.start]))}"childTokens"in a&&a.childTokens&&(t.childTokens[a.name]=a.childTokens)}),r.extensions=t),n.renderer){const a=this.defaults.renderer||new ii(this.defaults);for(const o in n.renderer){if(!(o in a))throw new Error(`renderer '${o}' does not exist`);if(o==="options")continue;const s=o,l=n.renderer[s],u=a[s];a[s]=(...c)=>{let d=l.apply(a,c);return d===!1&&(d=u.apply(a,c)),d||""}}r.renderer=a}if(n.tokenizer){const a=this.defaults.tokenizer||new ti(this.defaults);for(const o in n.tokenizer){if(!(o in a))throw new Error(`tokenizer '${o}' does not exist`);if(["options","rules","lexer"].includes(o))continue;const s=o,l=n.tokenizer[s],u=a[s];a[s]=(...c)=>{let d=l.apply(a,c);return d===!1&&(d=u.apply(a,c)),d}}r.tokenizer=a}if(n.hooks){const a=this.defaults.hooks||new un;for(const o in n.hooks){if(!(o in a))throw new Error(`hook '${o}' does not exist`);if(o==="options")continue;const s=o,l=n.hooks[s],u=a[s];un.passThroughHooks.has(o)?a[s]=c=>{if(this.defaults.async)return Promise.resolve(l.call(a,c)).then(h=>u.call(a,h));const d=l.call(a,c);return u.call(a,d)}:a[s]=(...c)=>{let d=l.apply(a,c);return d===!1&&(d=u.apply(a,c)),d}}r.hooks=a}if(n.walkTokens){const a=this.defaults.walkTokens,o=n.walkTokens;r.walkTokens=function(s){let l=[];return l.push(o.call(this,s)),a&&(l=l.concat(a.call(this,s))),l}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return qe.lex(e,t??this.defaults)}parser(e,t){return Ye.parse(e,t??this.defaults)}}yt=new WeakSet,Zi=function(e,t){return(n,r)=>{const a={...r},o={...this.defaults,...a};this.defaults.async===!0&&a.async===!1&&(o.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),o.async=!0);const s=Nn(this,yt,Ho).call(this,!!o.silent,!!o.async);if(typeof n>"u"||n===null)return s(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return s(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(o.hooks&&(o.hooks.options=o),o.async)return Promise.resolve(o.hooks?o.hooks.preprocess(n):n).then(l=>e(l,o)).then(l=>o.hooks?o.hooks.processAllTokens(l):l).then(l=>o.walkTokens?Promise.all(this.walkTokens(l,o.walkTokens)).then(()=>l):l).then(l=>t(l,o)).then(l=>o.hooks?o.hooks.postprocess(l):l).catch(s);try{o.hooks&&(n=o.hooks.preprocess(n));let l=e(n,o);o.hooks&&(l=o.hooks.processAllTokens(l)),o.walkTokens&&this.walkTokens(l,o.walkTokens);let u=t(l,o);return o.hooks&&(u=o.hooks.postprocess(u)),u}catch(l){return s(l)}}},Ho=function(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+Ae(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}};const mt=new Rc;function Y(i,e){return mt.parse(i,e)}Y.options=Y.setOptions=function(i){return mt.setOptions(i),Y.defaults=mt.defaults,Ro(Y.defaults),Y};Y.getDefaults=fr;Y.defaults=vt;Y.use=function(...i){return mt.use(...i),Y.defaults=mt.defaults,Ro(Y.defaults),Y};Y.walkTokens=function(i,e){return mt.walkTokens(i,e)};Y.parseInline=mt.parseInline;Y.Parser=Ye;Y.parser=Ye.parse;Y.Renderer=ii;Y.TextRenderer=vr;Y.Lexer=qe;Y.lexer=qe.lex;Y.Tokenizer=ti;Y.Hooks=un;Y.parse=Y;Y.options;Y.setOptions;Y.use;Y.walkTokens;Y.parseInline;Ye.parse;qe.lex;const Mc=`# DE

## Mit dieser App kannst du eine Pro-Football-Tour in den USA planen {#help-app-purpose}

Die Grundidee dabei ist: Du gibst ein **Zeitfenster** an, in dem du dich in den USA aufhalten kannst.
Beispielsweise Ich knnte den ganzen Oktober.
Anschlieend whlst du deine tatschliche **Reisedauer** aus, beispielsweise 14 Tage.
Falls du mchtest, kannst du auch auswhlen, ob dein **Starttag** z. B. ein Sonntag sein soll, um stressfrei am Freitag oder Samstag anzureisen.

Ziel ist es, Touren zu ermitteln, mit der man mit dem Auto mglichst viele Spiele mit mglichst wenig Fahrtzeit besuchen kann.
Du kannst aber auch **Flge erlauben**, um grere Entfernungen schneller zu berbrcken.

Die App analysiert alle Spiele innerhalb des von dir angegebenen Zeitfensters.
Sie berechnet sie besten Touren mit der von dir angegebenen Reisedauer, wobei sie die Fahrtzeiten zwischen den Stadien bercksichtigt.

Optional kannst du, abhngig von deinen persnlichen Vorlieben, die Gewichtung der [{$dialog.teamPreferences.title}](dialog:open-team-preferences), [{$dialog.cityPreferences.title}](dialog:open-city-preferences) oder [{$dialog.routingParameters.title}](dialog:open-routing-parameters) anpassen.

Als Ergebnis erhltst du eine Liste mglicher Touren, die genau zu deinen Vorlieben passen.

## Woher kommen die Daten? {#help-data-sources}

Diese App verwendet ausschlielich ffentlich verfgbare Daten der NFL, insbesondere den offiziellen Spielplan, Spielorte und Kickoff-Zeiten.
Zustzlich werden Entfernungen und Fahrzeiten ber frei zugngliche Geodatenquellen berechnet.
Alle Daten werden lokal im Browser verarbeitet, es findet keine Weitergabe an Dritte statt.
Aktualisierte Saison-Infos werden automatisch eingespielt, sobald die NFL neue Spielplandaten verffentlicht.
Die App speichert keine personenbezogenen Daten.

## Wie funktioniert die Bewertung eines Spiels? {#help-topic-game-rating}

Ein Spiel auf der Tour wird wie folgt bewertet:

**[Bewertung Reisezeit vom vorherigen Ort]  [Bewertung Stadion]  [Gewichtung Heimteam]  [Gewichtung Auswrtsteam]  100**

Wurden keine speziellen Einstellungen vorgenommen, ergibt sich dadurch ein Wert zwischen 1 und 100 fr ein Spiel.

- Per Vorgabe sind **[Gewichtung Heimteam]** und **[Gewichtung Auswrtsteam]** jeweils **1**.
  - Werden die *[{$dialog.teamPreferences.title}](dialog:open-team-preferences)* nicht verndert, wirken sich die Teams also nicht auf die Bewertung des Spiels aus.
- Die **[Bewertung Stadion]** setzt sich zusammen aus der *[Gewichtung des Stadions](dialog:open-city-preferences)* (per Vorgabe **1**), eventuell multipliziert mit dem Parameter *{$label.routing.revisitMultiplierFloor}* (per Vorgabe **0,1**).
  - Dadurch wird erreicht, dass bereits besuchte Stadien auf derselben Tour sehr schlecht bewertet werden. In der Regel tauchen Stadien daher nicht mehrfach in einer Tour auf.
- Die **[Bewertung der Reisezeit vom vorherigen Ort]** wird abhngig von echten Fahrtzeiten zwischen den einzelnen Stadien vorgenommen.
  - Dabei erhlt die krzeste mgliche Fahrtzeit den Wert **1** und die lngste mgliche Fahrtzeit den Wert **0,1**. Alle anderen Fahrtzeiten werden in dieser Spanne proportional eingeordnet.
  - Sind **Flge** zugelassen, wird die Bewertung zustzlich mit dem *{$label.routing.travelMultiplierCeilingFlight}* multipliziert, was per Vorgabe zu einer Abwertung von Flgen fhrt.
  - Fun Fact: Die krzeste Fahrtzeit zwischen zwei Stadien ist Baltimore nach Washington (ca. 1 Stunde), die lngste ist Miami nach Seattle (ca. 53 Stunden).

Wurden die Gewichtungen der *[{$dialog.teamPreferences.title}](dialog:open-team-preferences)*, der *[{$dialog.cityPreferences.title}](dialog:open-city-preferences)* oder der *[{$dialog.routingParameters.title}](dialog:open-routing-parameters)* verndert, knnen auch Werte ber 100 pro Spiel auftreten.

## Der Dialog ***{$dialog.favorites.title}*** {#help-dialog-favorites}

Hier die Beschreibung des Dialogs.

## Der Dialog ***{$dialog.teamPreferences.title}*** {#help-dialog-team-preferences}

Der Dialog {$dialog.teamPreferences.title} hilft dir dabei festzulegen, wie wichtig dir die einzelnen FootballTeams bei der Routenplanung sind.

Du siehst alle Teams mit Logo, Namen, Stadion und Ort in einer bersichtlichen Liste.

Fr jedes Team kannst du eine Gewichtung einstellen:
Hhere Werte bedeuten, dass dieses Team bei der Planung strker bevorzugt wird, niedrigere Werte machen es weniger wichtig.

Beachte, das fr die *[Bewertung eines Spiels](help:help-topic-game-rating)* beide Teams einbezogen werden, also Heim- und Auswrtsteam.

## Der Dialog ***{$dialog.cityPreferences.title}*** {#help-dialog-city-preferences}

Hier die Beschreibung des Dialogs.

## Der Dialog ***{$dialog.routingParameters.title}*** {#help-dialog-routing-parameters}

Hier die Beschreibung des Dialogs.

## Der Dialog ***{$dialog.routingGraph.title}*** {#help-dialog-routing-graph}

Hier die Beschreibung des Dialogs.

## Impressum und Datenschutz {#help-legal}

### Impressum

**Angaben gem  5 TMG /  18 MStV**

<div class="help-legal">
<div class="hl hl1"><span>Lorem</span><span>ipsum</span><span>dolor</span></div>
<div class="hl hl2"><span>sit</span><span>amet</span><span>ligula.</span></div>
<div class="hl hl3"><span>Aenean</span><span>commodo</span><span>eget</span></div>
<div class="hl hl4"><span>sociis</span><span>natoque</span><span>penatibus.</span></div>
<div class="hl hl5"><span></span><span></span><span></span></div>
</div>

### Datenschutzerklrung

Diese Anwendung verarbeitet personenbezogene Daten nur im technisch notwendigen Umfang.
Beim Aufruf der Anwendung werden serverseitig automatisch Daten wie die IP-Adresse sowie Datum und Uhrzeit des Zugriffs erfasst. Diese Daten dienen ausschlielich der Bereitstellung und Sicherheit des Dienstes und werden nicht zu Analyse- oder Marketingzwecken genutzt.
Die Anwendung speichert lokal Daten auf Ihrem Gert (z. B. Einstellungen). Diese lokal gespeicherten Daten werden nicht an den Betreiber bermittelt.

Es werden keine Cookies, Tracking-Tools oder externen Dienste eingesetzt.

**Bei Fragen zum Datenschutz:**

<div class="help-legal">
<div class="hl hl5"><span></span><span></span><span></span></div>
</div>

## {#footer-marker}

<div class="footer-text-details">
<span>Pro Football Tour Planner</span>
<span> 2025 A. Kandzior</span>
</div>

[Impressum](help:help-legal)

# EN

## With this app, you can plan your pro football tour in the USA {#help-app-purpose}

The basic idea is this: you specify a **time window** during which you can stay in the USA.
For example, I could do the whole of October.
Then you select your actual **tour duration**, for example, 14 days.
If you want, you can also choose whether your **start day** should be a Sunday, so that you can arrive on Friday or Saturday without any stress.

The aim is to find tours that allow you to visit as many games as possible by car with as little travel time as possible.
However, you can also **allow flights** to cover longer distances more quickly.

The app analyzes all games within your specified time window.
Based on the travel duration you specify, it calculates the best tours, taking into account travel times between stadiums.

Optionally, depending on your personal preferences, you can adjust the weighting of the [{$dialog.teamPreferences.title}](dialog:open-team-preferences), [{$dialog.cityPreferences.title}](dialog:open-city-preferences), or [{$dialog.routingParameters.title}](dialog:open-routing-parameters).

As a result, you will receive a list of possible tours that exactly match your preferences.

## Where does the data come from? {#help-data-sources}

This app uses only publicly available NFL data, including the official schedule, game locations, and kickoff times.
Distances and travel times are calculated using freely accessible geodata sources.
All data is processed locally in your browser, and nothing is shared with third parties.
Updated season information is applied automatically as soon as the NFL releases new schedule data.
The app does not store any personal data.

## The dialog ***{$dialog.favorites.title}*** {#help-dialog-favorites}

Description of the dialog.

## The dialog ***{$dialog.teamPreferences.title}*** {#help-dialog-team-preferences}

Description of the dialog.

## The dialog ***{$dialog.cityPreferences.title}*** {#help-dialog-city-preferences}

Description of the dialog.

## The dialog ***{$dialog.routingParameters.title}*** {#help-dialog-routing-parameters}

Description of the dialog.

## The dialog ***{$dialog.routingGraph.title}*** {#help-dialog-routing-graph}

Description of the dialog.

## Imprint and Privacy Policy {#help-legal}

### Imprint

**Information pursuant to  5 TMG /  18 MStV**

<div class="help-legal">
<div class="hl hl1"><span>Lorem</span><span>ipsum</span><span>dolor</span></div>
<div class="hl hl2"><span>sit</span><span>amet</span><span>ligula.</span></div>
<div class="hl hl3"><span>Aenean</span><span>commodo</span><span>eget</span></div>
<div class="hl hl4"><span>sociis</span><span>natoque</span><span>penatibus.</span></div>
<div class="hl hl5"><span></span><span></span><span></span></div>
</div>

### Privacy Policy

This application processes personal data only to the extent that is technically necessary.
When the application is accessed, server-side data such as the IP address and the date and time of access is automatically collected. This data is used solely for the provision and security of the service and is not used for analysis or marketing purposes.
The application stores data locally on your device (e.g., settings). This locally stored data is not transmitted to the operator.

No cookies, tracking tools, or external services are used.

**If you have any questions regarding data protection:**

<div class="help-legal">
<div class="hl hl5"><span></span><span></span><span></span></div>
</div>

## {#footer-marker}


<div class="footer-text-details">
<span>Pro Football Tour Planner</span>
<span> 2025 A. Kandzior</span>
</div>

[Imprint](help:help-legal)`,pa="help-dialog",ri=$c(Mc),Ji=new Map;let ma=!1,Pe=null,Hn=null,cn=null;function Pc({dialogKit:i,onDialogClose:e}){cn=()=>{var r;return((r=i.focusDialog)==null?void 0:r.call(i,pa))??!1};function t({topicId:r}={}){if(Pe){if(!r){cn();return}if(ba(r))return;const s=Pe.close;Pe=null,s==null||s()}const a=Wo(st());let o=null;i.open({title:T("dialog.help.title"),size:"large",id:pa,build({body:s,actions:l,close:u}){o=u;const c=Wc(a,{initiallyOpenId:r});s.appendChild(c),Pe={content:c,close:u},li();const d=document.createElement("button");d.type="button",d.classList.add("btn","btn-text","btn-primary"),d.textContent=T("button.close"),d.addEventListener("click",u),l.appendChild(d);const h=c.querySelector("summary")??d;return r&&requestAnimationFrame(()=>{Wn(r)}),{focusTarget:h}},onClose(){(Pe==null?void 0:Pe.close)===o&&(Pe=null),e==null||e()}})}function n(r){if(!r){t();return}ba(r)||t({topicId:r})}return Hn=n,{openHelp:t,openHelpTopic:n}}function Ic(i,{language:e}={}){if(!i)return null;const t=Uc(i,e??st());if(!t)return null;const n=jo(t);return li(),n}function Gc(i,{language:e}={}){if(!i)return null;const t=Hc(i,e??st());if(!t)return null;const n=document.createElement("div");return n.className="help-content-block",n.dataset.helpContentBlockId=t.id,n.innerHTML=t.html??"",li(),n}function Kt(i,e){i&&(typeof e=="function"?(Ji.set(i,e),li()):Ji.delete(i))}function $c(i=""){const e={},t=/^#\s+(?!#)(.+)$/gm;let n,r=null,a=0;const o=s=>{if(!r)return;const l=i.slice(a,s).trim(),u=bt(r);e[u]=Oc(l,u)};for(;(n=t.exec(i))!==null;)r&&o(n.index),r=bt(n[1]),a=t.lastIndex;return o(i.length),e}function Oc(i="",e){const t=/^##\s+(?!#)(.*)$/gm;let n,r=null,a=0;const o=[],s={},l=u=>{if(!r)return;const c=i.slice(a,u).trim(),d=c.length>0?Vc(c,e):"";if(r.type==="content-block"){r.id&&(s[r.id]={id:r.id,html:d});return}o.push({title:r.title,titleHtml:r.titleHtml??r.title,id:r.id??null,html:d})};for(;(n=t.exec(i))!==null;)l(n.index),r=zc(n[1]??"",e),a=t.lastIndex;return l(i.length),{sections:o,blocks:s}}function zc(i,e){const t=(i??"").trim(),n=t.match(/\{#([A-Za-z0-9_-]+)\}\s*$/);let r=null,a=t;if(n&&(r=n[1],a=t.slice(0,t.length-n[0].length).trim()),!a&&r)return{type:"content-block",id:r};const o=jc(a,e);return{type:"section",id:r,title:o.text,titleHtml:o.html}}function bt(i=""){const e=i.trim().toLowerCase();return e.startsWith("de")?"de":e.startsWith("en")?"en":e.length>=2?e.slice(0,2):"en"}function Wo(i){return Bc(i).sections}function Bc(i){const e=bt(i??"en"),t=ri[e];return t||(ri.en??{sections:[],blocks:{}})}function Uc(i,e){return Wo(e).find(n=>n.id===i)??null}function Hc(i,e){var r,a;if(!i)return null;const t=bt(e??"en"),n=(r=ri[t])==null?void 0:r.blocks;if(n!=null&&n[i])return n[i];if(t!=="en"){const o=(a=ri.en)==null?void 0:a.blocks;if(o!=null&&o[i])return o[i]}return null}function jo(i,{open:e=!1}={}){const t=document.createElement("details");t.className="help-entry",i.id&&(t.id=i.id,t.dataset.helpTopicId=i.id),t.open=e;const n=document.createElement("summary");i.titleHtml?n.innerHTML=i.titleHtml:n.textContent=i.title??"";const r=document.createElement("div");return r.className="help-entry-body",r.innerHTML=i.html,t.append(n,r),t}function Wc(i=[],{initiallyOpenId:e}={}){const t=document.createElement("div");if(t.className="help-dialog-content",i.length===0){const r=document.createElement("p");return r.textContent=T("message.help.empty"),t.appendChild(r),t}const n=e?i.some(r=>r.id===e):!1;return i.forEach((r,a)=>{const o=n?r.id===e:a===0;t.appendChild(jo(r,{open:o}))}),t}function jc(i,e){if(!i)return{text:"",html:""};const t=bt(e),n=Vo(i,t);if(!n)return{text:"",html:""};const r=Ko(),o=(Y.parseInline(n,{renderer:r})??"")||tn(n);return{text:qc(o),html:o}}function Vc(i,e){const t=bt(e),n=Vo(i,t),r=Ko();return Y.parse(n,{renderer:r})}function Vo(i,e){if(!i)return i;const t=/\{\$([a-zA-Z0-9_.-]+)\}/g;return i.replace(t,(n,r)=>{const a=Kc(e,r);return typeof a=="string"?a:n})}function Kc(i,e){var r;if(!e)return null;const n=[bt(i??"en"),"en"];for(const a of n){const o=(r=sr[a])==null?void 0:r.translation;if(!o)continue;const s=o[e];if(typeof s=="string")return s;const l=e.split(".").reduce((u,c)=>u?u[c]:void 0,o);if(typeof l=="string")return l}return null}function Ko(){const i=new Y.Renderer,e=i.link?i.link.bind(i):null;return i.link=function(n,r,a){if(typeof n=="string"&&n.startsWith("dialog:")){const o=n.slice(7).trim();if(o.length>0){const s=r?` title="${tn(r)}"`:"";return`<a href="#" data-help-dialog-action="${tn(o)}"${s}>${a}</a>`}}if(typeof n=="string"&&n.startsWith("help:")){const o=n.slice(5).trim();if(o.length>0){const s=r?` title="${tn(r)}"`:"";return`<a href="#" data-help-topic-link="${tn(o)}"${s}>${a}</a>`}}return e?e(n,r,a):Y.Renderer.prototype.link.call(this,n,r,a)},i}function tn(i){return String(i).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function qc(i){if(typeof i!="string"||i.length===0)return"";if(typeof document<"u"){const e=document.createElement("div");return e.innerHTML=i,e.textContent??""}return i.replace(/<[^>]*>/g,"")}function Wn(i){if(!i||!(Pe!=null&&Pe.content))return!1;const e=`[data-help-topic-id="${Yc(i)}"]`,t=Pe.content.querySelector(e);return t?(t.open=!0,typeof t.scrollIntoView=="function"&&t.scrollIntoView({block:"start",behavior:"smooth"}),!0):!1}function ba(i){return Wn(i)?(cn==null||cn(),typeof requestAnimationFrame=="function"?requestAnimationFrame(()=>{Wn(i)}):Wn(i),!0):!1}function Yc(i){return typeof CSS<"u"&&typeof CSS.escape=="function"?CSS.escape(i):String(i).replace(/["\\]/g,"\\$&")}function li(){ma||typeof document>"u"||(document.addEventListener("click",i=>{const e=i.target instanceof Element?i.target.closest("[data-help-dialog-action], [data-help-topic-link]"):null;if(!e)return;const t=e.getAttribute("data-help-dialog-action"),n=e.getAttribute("data-help-topic-link");if(!(!t&&!n)){if(i.preventDefault(),t){const r=Ji.get(t);r==null||r()}n&&(Hn==null||Hn(n))}},!0),ma=!0)}function Zc(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function dn(i){var e=Zc(i,"string");return typeof e=="symbol"?e:e+""}function xe(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function ya(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,dn(n.key),n)}}function Se(i,e,t){return e&&ya(i.prototype,e),t&&ya(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}function Gt(i){return Gt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Gt(i)}function qo(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(qo=function(){return!!i})()}function Jc(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Xc(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Jc(i)}function Ge(i,e,t){return e=Gt(e),Xc(i,qo()?Reflect.construct(e,t||[],Gt(i).constructor):e.apply(i,t))}function Xi(i,e){return Xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Xi(i,e)}function $e(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Xi(i,e)}function Qc(i){if(Array.isArray(i))return i}function ed(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,a,o,s=[],l=!0,u=!1;try{if(a=(t=t.call(i)).next,e===0){if(Object(t)!==t)return;l=!1}else for(;!(l=(n=a.call(t)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}function Qi(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function Yo(i,e){if(i){if(typeof i=="string")return Qi(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Qi(i,e):void 0}}function td(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $t(i,e){return Qc(i)||ed(i,e)||Yo(i,e)||td()}var Ai={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"},Zo=new Int8Array(4),jn=new Int32Array(Zo.buffer,0,1),Jo=new Float32Array(Zo.buffer,0,1),nd=/^\s*rgba?\s*\(/,id=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function rd(i){var e=0,t=0,n=0,r=1;if(i[0]==="#")i.length===4?(e=parseInt(i.charAt(1)+i.charAt(1),16),t=parseInt(i.charAt(2)+i.charAt(2),16),n=parseInt(i.charAt(3)+i.charAt(3),16)):(e=parseInt(i.charAt(1)+i.charAt(2),16),t=parseInt(i.charAt(3)+i.charAt(4),16),n=parseInt(i.charAt(5)+i.charAt(6),16)),i.length===9&&(r=parseInt(i.charAt(7)+i.charAt(8),16)/255);else if(nd.test(i)){var a=i.match(id);a&&(e=+a[1],t=+a[2],n=+a[3],a[4]&&(r=+a[4]))}return{r:e,g:t,b:n,a:r}}var Pt={};for(var Pn in Ai)Pt[Pn]=_t(Ai[Pn]),Pt[Ai[Pn]]=Pt[Pn];function Xo(i,e,t,n,r){return jn[0]=n<<24|t<<16|e<<8|i,jn[0]=jn[0]&4278190079,Jo[0]}function _t(i){if(i=i.toLowerCase(),typeof Pt[i]<"u")return Pt[i];var e=rd(i),t=e.r,n=e.g,r=e.b,a=e.a;a=a*255|0;var o=Xo(t,n,r,a);return Pt[i]=o,o}function ad(i,e){Jo[0]=_t(i);var t=jn[0],n=t&255,r=t>>8&255,a=t>>16&255,o=t>>24&255;return[n,r,a,o]}var Li={};function Qo(i){if(typeof Li[i]<"u")return Li[i];var e=(i&16711680)>>>16,t=(i&65280)>>>8,n=i&255,r=255,a=Xo(e,t,n,r);return Li[i]=a,a}function va(i,e,t,n){return t+(e<<8)+(i<<16)}function _a(i,e,t,n,r,a){var o=Math.floor(t/a*r),s=Math.floor(i.drawingBufferHeight/a-n/a*r),l=new Uint8Array(4);i.bindFramebuffer(i.FRAMEBUFFER,e),i.readPixels(o,s,1,1,i.RGBA,i.UNSIGNED_BYTE,l);var u=$t(l,4),c=u[0],d=u[1],h=u[2],f=u[3];return[c,d,h,f]}function C(i,e,t){return(e=dn(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function wa(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function I(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?wa(Object(t),!0).forEach(function(n){C(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):wa(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}function od(i,e){for(;!{}.hasOwnProperty.call(i,e)&&(i=Gt(i))!==null;);return i}function er(){return er=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(i,e,t){var n=od(i,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(arguments.length<3?i:t):r.value}},er.apply(null,arguments)}function es(i,e,t,n){var r=er(Gt(i.prototype),e,t);return typeof r=="function"?function(a){return r.apply(t,a)}:r}function sd(i){return i.normalized?1:i.size}function Di(i){var e=0;return i.forEach(function(t){return e+=sd(t)}),e}function ts(i,e,t){var n=i==="VERTEX"?e.VERTEX_SHADER:e.FRAGMENT_SHADER,r=e.createShader(n);if(r===null)throw new Error("loadShader: error while creating the shader");e.shaderSource(r,t),e.compileShader(r);var a=e.getShaderParameter(r,e.COMPILE_STATUS);if(!a){var o=e.getShaderInfoLog(r);throw e.deleteShader(r),new Error(`loadShader: error while compiling the shader:
`.concat(o,`
`).concat(t))}return r}function ld(i,e){return ts("VERTEX",i,e)}function ud(i,e){return ts("FRAGMENT",i,e)}function cd(i,e){var t=i.createProgram();if(t===null)throw new Error("loadProgram: error while creating the program.");var n,r;for(n=0,r=e.length;n<r;n++)i.attachShader(t,e[n]);i.linkProgram(t);var a=i.getProgramParameter(t,i.LINK_STATUS);if(!a)throw i.deleteProgram(t),new Error("loadProgram: error while linking the program.");return t}function ka(i){var e=i.gl,t=i.buffer,n=i.program,r=i.vertexShader,a=i.fragmentShader;e.deleteShader(r),e.deleteShader(a),e.deleteProgram(n),e.deleteBuffer(t)}function xa(i){return i%1===0?i.toFixed(1):i.toString()}var Sa=`#define PICKING_MODE
`,dd=C(C(C(C(C(C(C(C({},WebGL2RenderingContext.BOOL,1),WebGL2RenderingContext.BYTE,1),WebGL2RenderingContext.UNSIGNED_BYTE,1),WebGL2RenderingContext.SHORT,2),WebGL2RenderingContext.UNSIGNED_SHORT,2),WebGL2RenderingContext.INT,4),WebGL2RenderingContext.UNSIGNED_INT,4),WebGL2RenderingContext.FLOAT,4),ns=function(){function i(e,t,n){xe(this,i),C(this,"array",new Float32Array),C(this,"constantArray",new Float32Array),C(this,"capacity",0),C(this,"verticesCount",0);var r=this.getDefinition();if(this.VERTICES=r.VERTICES,this.VERTEX_SHADER_SOURCE=r.VERTEX_SHADER_SOURCE,this.FRAGMENT_SHADER_SOURCE=r.FRAGMENT_SHADER_SOURCE,this.UNIFORMS=r.UNIFORMS,this.ATTRIBUTES=r.ATTRIBUTES,this.METHOD=r.METHOD,this.CONSTANT_ATTRIBUTES="CONSTANT_ATTRIBUTES"in r?r.CONSTANT_ATTRIBUTES:[],this.CONSTANT_DATA="CONSTANT_DATA"in r?r.CONSTANT_DATA:[],this.isInstanced="CONSTANT_ATTRIBUTES"in r,this.ATTRIBUTES_ITEMS_COUNT=Di(this.ATTRIBUTES),this.STRIDE=this.VERTICES*this.ATTRIBUTES_ITEMS_COUNT,this.renderer=n,this.normalProgram=this.getProgramInfo("normal",e,r.VERTEX_SHADER_SOURCE,r.FRAGMENT_SHADER_SOURCE,null),this.pickProgram=t?this.getProgramInfo("pick",e,Sa+r.VERTEX_SHADER_SOURCE,Sa+r.FRAGMENT_SHADER_SOURCE,t):null,this.isInstanced){var a=Di(this.CONSTANT_ATTRIBUTES);if(this.CONSTANT_DATA.length!==this.VERTICES)throw new Error("Program: error while getting constant data (expected ".concat(this.VERTICES," items, received ").concat(this.CONSTANT_DATA.length," instead)"));this.constantArray=new Float32Array(this.CONSTANT_DATA.length*a);for(var o=0;o<this.CONSTANT_DATA.length;o++){var s=this.CONSTANT_DATA[o];if(s.length!==a)throw new Error("Program: error while getting constant data (one vector has ".concat(s.length," items instead of ").concat(a,")"));for(var l=0;l<s.length;l++)this.constantArray[o*a+l]=s[l]}this.STRIDE=this.ATTRIBUTES_ITEMS_COUNT}}return Se(i,[{key:"kill",value:function(){ka(this.normalProgram),this.pickProgram&&(ka(this.pickProgram),this.pickProgram=null)}},{key:"getProgramInfo",value:function(t,n,r,a,o){var s=this.getDefinition(),l=n.createBuffer();if(l===null)throw new Error("Program: error while creating the WebGL buffer.");var u=ld(n,r),c=ud(n,a),d=cd(n,[u,c]),h={};s.UNIFORMS.forEach(function(m){var y=n.getUniformLocation(d,m);y&&(h[m]=y)});var f={};s.ATTRIBUTES.forEach(function(m){f[m.name]=n.getAttribLocation(d,m.name)});var p;if("CONSTANT_ATTRIBUTES"in s&&(s.CONSTANT_ATTRIBUTES.forEach(function(m){f[m.name]=n.getAttribLocation(d,m.name)}),p=n.createBuffer(),p===null))throw new Error("Program: error while creating the WebGL constant buffer.");return{name:t,program:d,gl:n,frameBuffer:o,buffer:l,constantBuffer:p||{},uniformLocations:h,attributeLocations:f,isPicking:t==="pick",vertexShader:u,fragmentShader:c}}},{key:"bindProgram",value:function(t){var n=this,r=0,a=t.gl,o=t.buffer;this.isInstanced?(a.bindBuffer(a.ARRAY_BUFFER,t.constantBuffer),r=0,this.CONSTANT_ATTRIBUTES.forEach(function(s){return r+=n.bindAttribute(s,t,r,!1)}),a.bufferData(a.ARRAY_BUFFER,this.constantArray,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,t.buffer),r=0,this.ATTRIBUTES.forEach(function(s){return r+=n.bindAttribute(s,t,r,!0)}),a.bufferData(a.ARRAY_BUFFER,this.array,a.DYNAMIC_DRAW)):(a.bindBuffer(a.ARRAY_BUFFER,o),r=0,this.ATTRIBUTES.forEach(function(s){return r+=n.bindAttribute(s,t,r)}),a.bufferData(a.ARRAY_BUFFER,this.array,a.DYNAMIC_DRAW)),a.bindBuffer(a.ARRAY_BUFFER,null)}},{key:"unbindProgram",value:function(t){var n=this;this.isInstanced?(this.CONSTANT_ATTRIBUTES.forEach(function(r){return n.unbindAttribute(r,t,!1)}),this.ATTRIBUTES.forEach(function(r){return n.unbindAttribute(r,t,!0)})):this.ATTRIBUTES.forEach(function(r){return n.unbindAttribute(r,t)})}},{key:"bindAttribute",value:function(t,n,r,a){var o=dd[t.type];if(typeof o!="number")throw new Error('Program.bind: yet unsupported attribute type "'.concat(t.type,'"'));var s=n.attributeLocations[t.name],l=n.gl;if(s!==-1){l.enableVertexAttribArray(s);var u=this.isInstanced?(a?this.ATTRIBUTES_ITEMS_COUNT:Di(this.CONSTANT_ATTRIBUTES))*Float32Array.BYTES_PER_ELEMENT:this.ATTRIBUTES_ITEMS_COUNT*Float32Array.BYTES_PER_ELEMENT;if(l.vertexAttribPointer(s,t.size,t.type,t.normalized||!1,u,r),this.isInstanced&&a)if(l instanceof WebGL2RenderingContext)l.vertexAttribDivisor(s,1);else{var c=l.getExtension("ANGLE_instanced_arrays");c&&c.vertexAttribDivisorANGLE(s,1)}}return t.size*o}},{key:"unbindAttribute",value:function(t,n,r){var a=n.attributeLocations[t.name],o=n.gl;if(a!==-1&&(o.disableVertexAttribArray(a),this.isInstanced&&r))if(o instanceof WebGL2RenderingContext)o.vertexAttribDivisor(a,0);else{var s=o.getExtension("ANGLE_instanced_arrays");s&&s.vertexAttribDivisorANGLE(a,0)}}},{key:"reallocate",value:function(t){t!==this.capacity&&(this.capacity=t,this.verticesCount=this.VERTICES*t,this.array=new Float32Array(this.isInstanced?this.capacity*this.ATTRIBUTES_ITEMS_COUNT:this.verticesCount*this.ATTRIBUTES_ITEMS_COUNT))}},{key:"hasNothingToRender",value:function(){return this.verticesCount===0}},{key:"renderProgram",value:function(t,n){var r=n.gl,a=n.program;r.enable(r.BLEND),r.useProgram(a),this.setUniforms(t,n),this.drawWebGL(this.METHOD,n)}},{key:"render",value:function(t){this.hasNothingToRender()||(this.pickProgram&&(this.pickProgram.gl.viewport(0,0,t.width*t.pixelRatio/t.downSizingRatio,t.height*t.pixelRatio/t.downSizingRatio),this.bindProgram(this.pickProgram),this.renderProgram(I(I({},t),{},{pixelRatio:t.pixelRatio/t.downSizingRatio}),this.pickProgram),this.unbindProgram(this.pickProgram)),this.normalProgram.gl.viewport(0,0,t.width*t.pixelRatio,t.height*t.pixelRatio),this.bindProgram(this.normalProgram),this.renderProgram(t,this.normalProgram),this.unbindProgram(this.normalProgram))}},{key:"drawWebGL",value:function(t,n){var r=n.gl,a=n.frameBuffer;if(r.bindFramebuffer(r.FRAMEBUFFER,a),!this.isInstanced)r.drawArrays(t,0,this.verticesCount);else if(r instanceof WebGL2RenderingContext)r.drawArraysInstanced(t,0,this.VERTICES,this.capacity);else{var o=r.getExtension("ANGLE_instanced_arrays");o&&o.drawArraysInstancedANGLE(t,0,this.VERTICES,this.capacity)}}}])}(),is=function(i){function e(){return xe(this,e),Ge(this,e,arguments)}return $e(e,i),Se(e,[{key:"kill",value:function(){es(e,"kill",this)([])}},{key:"process",value:function(n,r,a){var o=r*this.STRIDE;if(a.hidden){for(var s=o+this.STRIDE;o<s;o++)this.array[o]=0;return}return this.processVisibleItem(Qo(n),o,a)}}])}(ns),_r=function(i){function e(){var t;xe(this,e);for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];return t=Ge(this,e,[].concat(r)),C(t,"drawLabel",void 0),t}return $e(e,i),Se(e,[{key:"kill",value:function(){es(e,"kill",this)([])}},{key:"process",value:function(n,r,a,o,s){var l=r*this.STRIDE;if(s.hidden||a.hidden||o.hidden){for(var u=l+this.STRIDE;l<u;l++)this.array[l]=0;return}return this.processVisibleItem(Qo(n),l,a,o,s)}}])}(ns);function hd(i,e){return function(){function t(n,r,a){xe(this,t),C(this,"drawLabel",e),this.programs=i.map(function(o){return new o(n,r,a)})}return Se(t,[{key:"reallocate",value:function(r){this.programs.forEach(function(a){return a.reallocate(r)})}},{key:"process",value:function(r,a,o,s,l){this.programs.forEach(function(u){return u.process(r,a,o,s,l)})}},{key:"render",value:function(r){this.programs.forEach(function(a){return a.render(r)})}},{key:"kill",value:function(){this.programs.forEach(function(r){return r.kill()})}}])}()}function fd(i,e,t,n,r){var a=r.edgeLabelSize,o=r.edgeLabelFont,s=r.edgeLabelWeight,l=r.edgeLabelColor.attribute?e[r.edgeLabelColor.attribute]||r.edgeLabelColor.color||"#000":r.edgeLabelColor.color,u=e.label;if(u){i.fillStyle=l,i.font="".concat(s," ").concat(a,"px ").concat(o);var c=t.size,d=n.size,h=t.x,f=t.y,p=n.x,m=n.y,y=(h+p)/2,k=(f+m)/2,v=p-h,b=m-f,g=Math.sqrt(v*v+b*b);if(!(g<c+d)){h+=v*c/g,f+=b*c/g,p-=v*d/g,m-=b*d/g,y=(h+p)/2,k=(f+m)/2,v=p-h,b=m-f,g=Math.sqrt(v*v+b*b);var w=i.measureText(u).width;if(w>g){var _="";for(u=u+_,w=i.measureText(u).width;w>g&&u.length>1;)u=u.slice(0,-2)+_,w=i.measureText(u).width;if(u.length<4)return}var x;v>0?b>0?x=Math.acos(v/g):x=Math.asin(b/g):b>0?x=Math.acos(v/g)+Math.PI:x=Math.asin(v/g)+Math.PI/2,i.save(),i.translate(y,k),i.rotate(x),i.fillText(u,-w/2,e.size/2+a),i.restore()}}}function rs(i,e,t){if(e.label){var n=t.labelSize,r=t.labelFont,a=t.labelWeight,o=t.labelColor.attribute?e[t.labelColor.attribute]||t.labelColor.color||"#000":t.labelColor.color;i.fillStyle=o,i.font="".concat(a," ").concat(n,"px ").concat(r),i.fillText(e.label,e.x+e.size+3,e.y+n/3)}}function gd(i,e,t){var n=t.labelSize,r=t.labelFont,a=t.labelWeight;i.font="".concat(a," ").concat(n,"px ").concat(r),i.fillStyle="#FFF",i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=8,i.shadowColor="#000";var o=2;if(typeof e.label=="string"){var s=i.measureText(e.label).width,l=Math.round(s+5),u=Math.round(n+2*o),c=Math.max(e.size,n/2)+o,d=Math.asin(u/2/c),h=Math.sqrt(Math.abs(Math.pow(c,2)-Math.pow(u/2,2)));i.beginPath(),i.moveTo(e.x+h,e.y+u/2),i.lineTo(e.x+c+l,e.y+u/2),i.lineTo(e.x+c+l,e.y-u/2),i.lineTo(e.x+h,e.y-u/2),i.arc(e.x,e.y,c,d,-d),i.closePath(),i.fill()}else i.beginPath(),i.arc(e.x,e.y,e.size+o,0,Math.PI*2),i.closePath(),i.fill();i.shadowOffsetX=0,i.shadowOffsetY=0,i.shadowBlur=0,rs(i,e,t)}var pd=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > border)
    gl_FragColor = transparent;
  else
    gl_FragColor = v_color;

  #else
  float t = 0.0;
  if (dist > border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / border;

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,md=pd,bd=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,yd=bd,as=WebGLRenderingContext,Ea=as.UNSIGNED_BYTE,Fi=as.FLOAT,vd=["u_sizeRatio","u_correctionRatio","u_matrix"],ui=function(i){function e(){return xe(this,e),Ge(this,e,arguments)}return $e(e,i),Se(e,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:yd,FRAGMENT_SHADER_SOURCE:md,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:vd,ATTRIBUTES:[{name:"a_position",size:2,type:Fi},{name:"a_size",size:1,type:Fi},{name:"a_color",size:4,type:Ea,normalized:!0},{name:"a_id",size:4,type:Ea,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Fi}],CONSTANT_DATA:[[e.ANGLE_1],[e.ANGLE_2],[e.ANGLE_3]]}}},{key:"processVisibleItem",value:function(n,r,a){var o=this.array,s=_t(a.color);o[r++]=a.x,o[r++]=a.y,o[r++]=a.size,o[r++]=s,o[r++]=n}},{key:"setUniforms",value:function(n,r){var a=r.gl,o=r.uniformLocations,s=o.u_sizeRatio,l=o.u_correctionRatio,u=o.u_matrix;a.uniform1f(l,n.correctionRatio),a.uniform1f(s,n.sizeRatio),a.uniformMatrix3fv(u,!1,n.matrix)}}])}(is);C(ui,"ANGLE_1",0);C(ui,"ANGLE_2",2*Math.PI/3);C(ui,"ANGLE_3",4*Math.PI/3);var _d=`
precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`,wd=_d,kd=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,xd=kd,os=WebGLRenderingContext,Ta=os.UNSIGNED_BYTE,In=os.FLOAT,Sd=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],ss={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function ls(i){var e=I(I({},ss),{});return function(t){function n(){return xe(this,n),Ge(this,n,arguments)}return $e(n,t),Se(n,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:xd,FRAGMENT_SHADER_SOURCE:wd,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Sd,ATTRIBUTES:[{name:"a_position",size:2,type:In},{name:"a_normal",size:2,type:In},{name:"a_radius",size:1,type:In},{name:"a_color",size:4,type:Ta,normalized:!0},{name:"a_id",size:4,type:Ta,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:In}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}},{key:"processVisibleItem",value:function(a,o,s,l,u){if(e.extremity==="source"){var c=[l,s];s=c[0],l=c[1]}var d=u.size||1,h=l.size||1,f=s.x,p=s.y,m=l.x,y=l.y,k=_t(u.color),v=m-f,b=y-p,g=v*v+b*b,w=0,_=0;g&&(g=1/Math.sqrt(g),w=-b*g*d,_=v*g*d);var x=this.array;x[o++]=m,x[o++]=y,x[o++]=-w,x[o++]=-_,x[o++]=h,x[o++]=k,x[o++]=a}},{key:"setUniforms",value:function(a,o){var s=o.gl,l=o.uniformLocations,u=l.u_matrix,c=l.u_sizeRatio,d=l.u_correctionRatio,h=l.u_minEdgeThickness,f=l.u_lengthToThicknessRatio,p=l.u_widenessToThicknessRatio;s.uniformMatrix3fv(u,!1,a.matrix),s.uniform1f(c,a.sizeRatio),s.uniform1f(d,a.correctionRatio),s.uniform1f(h,a.minEdgeThickness),s.uniform1f(f,e.lengthToThicknessRatio),s.uniform1f(p,e.widenessToThicknessRatio)}}])}(_r)}ls();var Ed=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,us=Ed,Td=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_radius;
attribute float a_radiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float radius = a_radius * a_radiusCoef;
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(radius);
  float webGLNodeRadius = direction * radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (webGLNodeRadius + webGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Cd=Td,cs=WebGLRenderingContext,Ca=cs.UNSIGNED_BYTE,ht=cs.FLOAT,Nd=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],Ad={lengthToThicknessRatio:ss.lengthToThicknessRatio};function ds(i){var e=I(I({},Ad),{});return function(t){function n(){return xe(this,n),Ge(this,n,arguments)}return $e(n,t),Se(n,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Cd,FRAGMENT_SHADER_SOURCE:us,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Nd,ATTRIBUTES:[{name:"a_positionStart",size:2,type:ht},{name:"a_positionEnd",size:2,type:ht},{name:"a_normal",size:2,type:ht},{name:"a_color",size:4,type:Ca,normalized:!0},{name:"a_id",size:4,type:Ca,normalized:!0},{name:"a_radius",size:1,type:ht}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:ht},{name:"a_normalCoef",size:1,type:ht},{name:"a_radiusCoef",size:1,type:ht}],CONSTANT_DATA:[[0,1,0],[0,-1,0],[1,1,1],[1,1,1],[0,-1,0],[1,-1,-1]]}}},{key:"processVisibleItem",value:function(a,o,s,l,u){var c=u.size||1,d=s.x,h=s.y,f=l.x,p=l.y,m=_t(u.color),y=f-d,k=p-h,v=l.size||1,b=y*y+k*k,g=0,w=0;b&&(b=1/Math.sqrt(b),g=-k*b*c,w=y*b*c);var _=this.array;_[o++]=d,_[o++]=h,_[o++]=f,_[o++]=p,_[o++]=g,_[o++]=w,_[o++]=m,_[o++]=a,_[o++]=v}},{key:"setUniforms",value:function(a,o){var s=o.gl,l=o.uniformLocations,u=l.u_matrix,c=l.u_zoomRatio,d=l.u_feather,h=l.u_pixelRatio,f=l.u_correctionRatio,p=l.u_sizeRatio,m=l.u_minEdgeThickness,y=l.u_lengthToThicknessRatio;s.uniformMatrix3fv(u,!1,a.matrix),s.uniform1f(c,a.zoomRatio),s.uniform1f(p,a.sizeRatio),s.uniform1f(f,a.correctionRatio),s.uniform1f(h,a.pixelRatio),s.uniform1f(d,a.antiAliasingFeather),s.uniform1f(m,a.minEdgeThickness),s.uniform1f(y,e.lengthToThicknessRatio)}}])}(_r)}ds();function Ld(i){return hd([ds(),ls()])}var Dd=Ld(),Fd=Dd,Rd=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Md=Rd,hs=WebGLRenderingContext,Na=hs.UNSIGNED_BYTE,qt=hs.FLOAT,Pd=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness"],Id=function(i){function e(){return xe(this,e),Ge(this,e,arguments)}return $e(e,i),Se(e,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Md,FRAGMENT_SHADER_SOURCE:us,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Pd,ATTRIBUTES:[{name:"a_positionStart",size:2,type:qt},{name:"a_positionEnd",size:2,type:qt},{name:"a_normal",size:2,type:qt},{name:"a_color",size:4,type:Na,normalized:!0},{name:"a_id",size:4,type:Na,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:qt},{name:"a_normalCoef",size:1,type:qt}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}},{key:"processVisibleItem",value:function(n,r,a,o,s){var l=s.size||1,u=a.x,c=a.y,d=o.x,h=o.y,f=_t(s.color),p=d-u,m=h-c,y=p*p+m*m,k=0,v=0;y&&(y=1/Math.sqrt(y),k=-m*y*l,v=p*y*l);var b=this.array;b[r++]=u,b[r++]=c,b[r++]=d,b[r++]=h,b[r++]=k,b[r++]=v,b[r++]=f,b[r++]=n}},{key:"setUniforms",value:function(n,r){var a=r.gl,o=r.uniformLocations,s=o.u_matrix,l=o.u_zoomRatio,u=o.u_feather,c=o.u_pixelRatio,d=o.u_correctionRatio,h=o.u_sizeRatio,f=o.u_minEdgeThickness;a.uniformMatrix3fv(s,!1,n.matrix),a.uniform1f(l,n.zoomRatio),a.uniform1f(h,n.sizeRatio),a.uniform1f(d,n.correctionRatio),a.uniform1f(c,n.pixelRatio),a.uniform1f(u,n.antiAliasingFeather),a.uniform1f(f,n.minEdgeThickness)}}])}(_r);function Gd(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var wr={exports:{}},It=typeof Reflect=="object"?Reflect:null,Aa=It&&typeof It.apply=="function"?It.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Vn;It&&typeof It.ownKeys=="function"?Vn=It.ownKeys:Object.getOwnPropertySymbols?Vn=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Vn=function(e){return Object.getOwnPropertyNames(e)};function $d(i){console&&console.warn&&console.warn(i)}var fs=Number.isNaN||function(e){return e!==e};function Q(){Q.init.call(this)}wr.exports=Q;wr.exports.once=Ud;Q.EventEmitter=Q;Q.prototype._events=void 0;Q.prototype._eventsCount=0;Q.prototype._maxListeners=void 0;var La=10;function ci(i){if(typeof i!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof i)}Object.defineProperty(Q,"defaultMaxListeners",{enumerable:!0,get:function(){return La},set:function(i){if(typeof i!="number"||i<0||fs(i))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+i+".");La=i}});Q.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Q.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||fs(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function gs(i){return i._maxListeners===void 0?Q.defaultMaxListeners:i._maxListeners}Q.prototype.getMaxListeners=function(){return gs(this)};Q.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r=e==="error",a=this._events;if(a!==void 0)r=r&&a.error===void 0;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=a[e];if(l===void 0)return!1;if(typeof l=="function")Aa(l,this,t);else for(var u=l.length,c=vs(l,u),n=0;n<u;++n)Aa(c[n],this,t);return!0};function ps(i,e,t,n){var r,a,o;if(ci(t),a=i._events,a===void 0?(a=i._events=Object.create(null),i._eventsCount=0):(a.newListener!==void 0&&(i.emit("newListener",e,t.listener?t.listener:t),a=i._events),o=a[e]),o===void 0)o=a[e]=t,++i._eventsCount;else if(typeof o=="function"?o=a[e]=n?[t,o]:[o,t]:n?o.unshift(t):o.push(t),r=gs(i),r>0&&o.length>r&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=i,s.type=e,s.count=o.length,$d(s)}return i}Q.prototype.addListener=function(e,t){return ps(this,e,t,!1)};Q.prototype.on=Q.prototype.addListener;Q.prototype.prependListener=function(e,t){return ps(this,e,t,!0)};function Od(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ms(i,e,t){var n={fired:!1,wrapFn:void 0,target:i,type:e,listener:t},r=Od.bind(n);return r.listener=t,n.wrapFn=r,r}Q.prototype.once=function(e,t){return ci(t),this.on(e,ms(this,e,t)),this};Q.prototype.prependOnceListener=function(e,t){return ci(t),this.prependListener(e,ms(this,e,t)),this};Q.prototype.removeListener=function(e,t){var n,r,a,o,s;if(ci(t),r=this._events,r===void 0)return this;if(n=r[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(a=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,a=o;break}if(a<0)return this;a===0?n.shift():zd(n,a),n.length===1&&(r[e]=n[0]),r.removeListener!==void 0&&this.emit("removeListener",e,s||t)}return this};Q.prototype.off=Q.prototype.removeListener;Q.prototype.removeAllListeners=function(e){var t,n,r;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var a=Object.keys(n),o;for(r=0;r<a.length;++r)o=a[r],o!=="removeListener"&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this};function bs(i,e,t){var n=i._events;if(n===void 0)return[];var r=n[e];return r===void 0?[]:typeof r=="function"?t?[r.listener||r]:[r]:t?Bd(r):vs(r,r.length)}Q.prototype.listeners=function(e){return bs(this,e,!0)};Q.prototype.rawListeners=function(e){return bs(this,e,!1)};Q.listenerCount=function(i,e){return typeof i.listenerCount=="function"?i.listenerCount(e):ys.call(i,e)};Q.prototype.listenerCount=ys;function ys(i){var e=this._events;if(e!==void 0){var t=e[i];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}Q.prototype.eventNames=function(){return this._eventsCount>0?Vn(this._events):[]};function vs(i,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=i[n];return t}function zd(i,e){for(;e+1<i.length;e++)i[e]=i[e+1];i.pop()}function Bd(i){for(var e=new Array(i.length),t=0;t<e.length;++t)e[t]=i[t].listener||i[t];return e}function Ud(i,e){return new Promise(function(t,n){function r(o){i.removeListener(e,a),n(o)}function a(){typeof i.removeListener=="function"&&i.removeListener("error",r),t([].slice.call(arguments))}_s(i,e,a,{once:!0}),e!=="error"&&Hd(i,r,{once:!0})})}function Hd(i,e,t){typeof i.on=="function"&&_s(i,"error",e,t)}function _s(i,e,t,n){if(typeof i.on=="function")n.once?i.once(e,t):i.on(e,t);else if(typeof i.addEventListener=="function")i.addEventListener(e,function r(a){n.once&&i.removeEventListener(e,r),t(a)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof i)}var ws=wr.exports,kr=function(i){function e(){var t;return xe(this,e),t=Ge(this,e),t.rawEmitter=t,t}return $e(e,i),Se(e)}(ws.EventEmitter),Wd=function(e){return e!==null&&typeof e=="object"&&typeof e.addUndirectedEdgeWithKey=="function"&&typeof e.dropNode=="function"&&typeof e.multi=="boolean"};const jd=Gd(Wd);var Vd=function(e){return e},Kd=function(e){return e*e},qd=function(e){return e*(2-e)},Yd=function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},Zd=function(e){return e*e*e},Jd=function(e){return--e*e*e+1},Xd=function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},Qd={linear:Vd,quadraticIn:Kd,quadraticOut:qd,quadraticInOut:Yd,cubicIn:Zd,cubicOut:Jd,cubicInOut:Xd},eh={easing:"quadraticInOut",duration:150};function He(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function Gn(i,e,t){return i[0]=e,i[4]=typeof t=="number"?t:e,i}function Da(i,e){var t=Math.sin(e),n=Math.cos(e);return i[0]=n,i[1]=t,i[3]=-t,i[4]=n,i}function Fa(i,e,t){return i[6]=e,i[7]=t,i}function rt(i,e){var t=i[0],n=i[1],r=i[2],a=i[3],o=i[4],s=i[5],l=i[6],u=i[7],c=i[8],d=e[0],h=e[1],f=e[2],p=e[3],m=e[4],y=e[5],k=e[6],v=e[7],b=e[8];return i[0]=d*t+h*a+f*l,i[1]=d*n+h*o+f*u,i[2]=d*r+h*s+f*c,i[3]=p*t+m*a+y*l,i[4]=p*n+m*o+y*u,i[5]=p*r+m*s+y*c,i[6]=k*t+v*a+b*l,i[7]=k*n+v*o+b*u,i[8]=k*r+v*s+b*c,i}function tr(i,e){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,n=i[0],r=i[1],a=i[3],o=i[4],s=i[6],l=i[7],u=e.x,c=e.y;return{x:u*n+c*a+s*t,y:u*r+c*o+l*t}}function th(i,e){var t=i.height/i.width,n=e.height/e.width;return t<1&&n>1||t>1&&n<1?1:Math.min(Math.max(n,1/n),Math.max(1/t,t))}function Yt(i,e,t,n,r){var a=i.angle,o=i.ratio,s=i.x,l=i.y,u=e.width,c=e.height,d=He(),h=Math.min(u,c)-2*n,f=th(e,t);return r?(rt(d,Fa(He(),s,l)),rt(d,Gn(He(),o)),rt(d,Da(He(),a)),rt(d,Gn(He(),u/h/2/f,c/h/2/f))):(rt(d,Gn(He(),2*(h/u)*f,2*(h/c)*f)),rt(d,Da(He(),-a)),rt(d,Gn(He(),1/o)),rt(d,Fa(He(),-s,-l))),d}function nh(i,e,t){var n=tr(i,{x:Math.cos(e.angle),y:Math.sin(e.angle)},0),r=n.x,a=n.y;return 1/Math.sqrt(Math.pow(r,2)+Math.pow(a,2))/t.width}function ih(i){if(!i.order)return{x:[0,1],y:[0,1]};var e=1/0,t=-1/0,n=1/0,r=-1/0;return i.forEachNode(function(a,o){var s=o.x,l=o.y;s<e&&(e=s),s>t&&(t=s),l<n&&(n=l),l>r&&(r=l)}),{x:[e,t],y:[n,r]}}function rh(i){if(!jd(i))throw new Error("Sigma: invalid graph instance.");i.forEachNode(function(e,t){if(!Number.isFinite(t.x)||!Number.isFinite(t.y))throw new Error("Sigma: Coordinates of node ".concat(e," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}function ah(i,e,t){var n=document.createElement(i);if(e)for(var r in e)n.style[r]=e[r];if(t)for(var a in t)n.setAttribute(a,t[a]);return n}function Ra(){return typeof window.devicePixelRatio<"u"?window.devicePixelRatio:1}function Ma(i,e,t){return t.sort(function(n,r){var a=e(n)||0,o=e(r)||0;return a<o?-1:a>o?1:0})}function Pa(i){var e=$t(i.x,2),t=e[0],n=e[1],r=$t(i.y,2),a=r[0],o=r[1],s=Math.max(n-t,o-a),l=(n+t)/2,u=(o+a)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(l)&&(l=0),isNaN(u)&&(u=0);var c=function(h){return{x:.5+(h.x-l)/s,y:.5+(h.y-u)/s}};return c.applyTo=function(d){d.x=.5+(d.x-l)/s,d.y=.5+(d.y-u)/s},c.inverse=function(d){return{x:l+s*(d.x-.5),y:u+s*(d.y-.5)}},c.ratio=s,c}function nr(i){"@babel/helpers - typeof";return nr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(i)}function Ia(i,e){var t=e.size;if(t!==0){var n=i.length;i.length+=t;var r=0;e.forEach(function(a){i[n+r]=a,r++})}}function Ri(i){i=i||{};for(var e=0,t=arguments.length<=1?0:arguments.length-1;e<t;e++){var n=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];n&&Object.assign(i,n)}return i}var xr={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:fd,defaultDrawNodeLabel:rs,defaultDrawNodeHover:gd,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},oh={circle:ui},sh={arrow:Fd,line:Id};function Mi(i){if(typeof i.labelDensity!="number"||i.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var e=i.minCameraRatio,t=i.maxCameraRatio;if(typeof e=="number"&&typeof t=="number"&&t<e)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}function lh(i){var e=Ri({},xr,i);return e.nodeProgramClasses=Ri({},oh,e.nodeProgramClasses),e.edgeProgramClasses=Ri({},sh,e.edgeProgramClasses),e}var $n=1.5,Ga=function(i){function e(){var t;return xe(this,e),t=Ge(this,e),C(t,"x",.5),C(t,"y",.5),C(t,"angle",0),C(t,"ratio",1),C(t,"minRatio",null),C(t,"maxRatio",null),C(t,"enabledZooming",!0),C(t,"enabledPanning",!0),C(t,"enabledRotation",!0),C(t,"clean",null),C(t,"nextFrame",null),C(t,"previousState",null),C(t,"enabled",!0),t.previousState=t.getState(),t}return $e(e,i),Se(e,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(n){return this.x===n.x&&this.y===n.y&&this.ratio===n.ratio&&this.angle===n.angle}},{key:"getPreviousState",value:function(){var n=this.previousState;return n?{x:n.x,y:n.y,angle:n.angle,ratio:n.ratio}:null}},{key:"getBoundedRatio",value:function(n){var r=n;return typeof this.minRatio=="number"&&(r=Math.max(r,this.minRatio)),typeof this.maxRatio=="number"&&(r=Math.min(r,this.maxRatio)),r}},{key:"validateState",value:function(n){var r={};return this.enabledPanning&&typeof n.x=="number"&&(r.x=n.x),this.enabledPanning&&typeof n.y=="number"&&(r.y=n.y),this.enabledZooming&&typeof n.ratio=="number"&&(r.ratio=this.getBoundedRatio(n.ratio)),this.enabledRotation&&typeof n.angle=="number"&&(r.angle=n.angle),this.clean?this.clean(I(I({},this.getState()),r)):r}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(n){if(!this.enabled)return this;this.previousState=this.getState();var r=this.validateState(n);return typeof r.x=="number"&&(this.x=r.x),typeof r.y=="number"&&(this.y=r.y),typeof r.ratio=="number"&&(this.ratio=r.ratio),typeof r.angle=="number"&&(this.angle=r.angle),this.hasState(this.previousState)||this.emit("updated",this.getState()),this}},{key:"updateState",value:function(n){return this.setState(n(this.getState())),this}},{key:"animate",value:function(n){var r=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;if(!o)return new Promise(function(f){return r.animate(n,a,f)});if(this.enabled){var s=I(I({},eh),a),l=this.validateState(n),u=typeof s.easing=="function"?s.easing:Qd[s.easing],c=Date.now(),d=this.getState(),h=function(){var p=(Date.now()-c)/s.duration;if(p>=1){r.nextFrame=null,r.setState(l),r.animationCallback&&(r.animationCallback.call(null),r.animationCallback=void 0);return}var m=u(p),y={};typeof l.x=="number"&&(y.x=d.x+(l.x-d.x)*m),typeof l.y=="number"&&(y.y=d.y+(l.y-d.y)*m),r.enabledRotation&&typeof l.angle=="number"&&(y.angle=d.angle+(l.angle-d.angle)*m),typeof l.ratio=="number"&&(y.ratio=d.ratio+(l.ratio-d.ratio)*m),r.setState(y),r.nextFrame=requestAnimationFrame(h)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=requestAnimationFrame(h)):h(),this.animationCallback=o}}},{key:"animatedZoom",value:function(n){return n?typeof n=="number"?this.animate({ratio:this.ratio/n}):this.animate({ratio:this.ratio/(n.factor||$n)},n):this.animate({ratio:this.ratio/$n})}},{key:"animatedUnzoom",value:function(n){return n?typeof n=="number"?this.animate({ratio:this.ratio*n}):this.animate({ratio:this.ratio*(n.factor||$n)},n):this.animate({ratio:this.ratio*$n})}},{key:"animatedReset",value:function(n){return this.animate({x:.5,y:.5,ratio:1,angle:0},n)}},{key:"copy",value:function(){return e.from(this.getState())}}],[{key:"from",value:function(n){var r=new e;return r.setState(n)}}])}(kr);function We(i,e){var t=e.getBoundingClientRect();return{x:i.clientX-t.left,y:i.clientY-t.top}}function Qe(i,e){var t=I(I({},We(i,e)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){t.sigmaDefaultPrevented=!0},original:i});return t}function Zt(i){var e="x"in i?i:I(I({},i.touches[0]||i.previousTouches[0]),{},{original:i.original,sigmaDefaultPrevented:i.sigmaDefaultPrevented,preventSigmaDefault:function(){i.sigmaDefaultPrevented=!0,e.sigmaDefaultPrevented=!0}});return e}function uh(i,e){return I(I({},Qe(i,e)),{},{delta:ks(i)})}var ch=2;function Kn(i){for(var e=[],t=0,n=Math.min(i.length,ch);t<n;t++)e.push(i[t]);return e}function Jt(i,e,t){var n={touches:Kn(i.touches).map(function(r){return We(r,t)}),previousTouches:e.map(function(r){return We(r,t)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){n.sigmaDefaultPrevented=!0},original:i};return n}function ks(i){if(typeof i.deltaY<"u")return i.deltaY*-3/360;if(typeof i.detail<"u")return i.detail/-9;throw new Error("Captor: could not extract delta from event.")}var xs=function(i){function e(t,n){var r;return xe(this,e),r=Ge(this,e),r.container=t,r.renderer=n,r}return $e(e,i),Se(e)}(kr),dh=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"],hh=dh.reduce(function(i,e){return I(I({},i),{},C({},e,xr[e]))},{}),fh=function(i){function e(t,n){var r;return xe(this,e),r=Ge(this,e,[t,n]),C(r,"enabled",!0),C(r,"draggedEvents",0),C(r,"downStartTime",null),C(r,"lastMouseX",null),C(r,"lastMouseY",null),C(r,"isMouseDown",!1),C(r,"isMoving",!1),C(r,"movingTimeout",null),C(r,"startCameraState",null),C(r,"clicks",0),C(r,"doubleClickTimeout",null),C(r,"currentWheelDirection",0),C(r,"settings",hh),r.handleClick=r.handleClick.bind(r),r.handleRightClick=r.handleRightClick.bind(r),r.handleDown=r.handleDown.bind(r),r.handleUp=r.handleUp.bind(r),r.handleMove=r.handleMove.bind(r),r.handleWheel=r.handleWheel.bind(r),r.handleLeave=r.handleLeave.bind(r),r.handleEnter=r.handleEnter.bind(r),t.addEventListener("click",r.handleClick,{capture:!1}),t.addEventListener("contextmenu",r.handleRightClick,{capture:!1}),t.addEventListener("mousedown",r.handleDown,{capture:!1}),t.addEventListener("wheel",r.handleWheel,{capture:!1}),t.addEventListener("mouseleave",r.handleLeave,{capture:!1}),t.addEventListener("mouseenter",r.handleEnter,{capture:!1}),document.addEventListener("mousemove",r.handleMove,{capture:!1}),document.addEventListener("mouseup",r.handleUp,{capture:!1}),r}return $e(e,i),Se(e,[{key:"kill",value:function(){var n=this.container;n.removeEventListener("click",this.handleClick),n.removeEventListener("contextmenu",this.handleRightClick),n.removeEventListener("mousedown",this.handleDown),n.removeEventListener("wheel",this.handleWheel),n.removeEventListener("mouseleave",this.handleLeave),n.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(n){var r=this;if(this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(n);setTimeout(function(){r.clicks=0,r.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance&&this.emit("click",Qe(n,this.container))}}},{key:"handleRightClick",value:function(n){this.enabled&&this.emit("rightClick",Qe(n,this.container))}},{key:"handleDoubleClick",value:function(n){if(this.enabled){n.preventDefault(),n.stopPropagation();var r=Qe(n,this.container);if(this.emit("doubleClick",r),!r.sigmaDefaultPrevented){var a=this.renderer.getCamera(),o=a.getBoundedRatio(a.getState().ratio/this.settings.doubleClickZoomingRatio);a.animate(this.renderer.getViewportZoomedState(We(n,this.container),o),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}}},{key:"handleDown",value:function(n){if(this.enabled){if(n.button===0){this.startCameraState=this.renderer.getCamera().getState();var r=We(n,this.container),a=r.x,o=r.y;this.lastMouseX=a,this.lastMouseY=o,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",Qe(n,this.container))}}},{key:"handleUp",value:function(n){var r=this;if(!(!this.enabled||!this.isMouseDown)){var a=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var o=We(n,this.container),s=o.x,l=o.y,u=a.getState(),c=a.getPreviousState()||{x:0,y:0};this.isMoving?a.animate({x:u.x+this.settings.inertiaRatio*(u.x-c.x),y:u.y+this.settings.inertiaRatio*(u.y-c.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"}):(this.lastMouseX!==s||this.lastMouseY!==l)&&a.setState({x:u.x,y:u.y}),this.isMoving=!1,setTimeout(function(){var d=r.draggedEvents>0;r.draggedEvents=0,d&&r.renderer.getSetting("hideEdgesOnMove")&&r.renderer.refresh()},0),this.emit("mouseup",Qe(n,this.container))}}},{key:"handleMove",value:function(n){var r=this;if(this.enabled){var a=Qe(n,this.container);if(this.emit("mousemovebody",a),(n.target===this.container||n.composedPath()[0]===this.container)&&this.emit("mousemove",a),!a.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){r.movingTimeout=null,r.isMoving=!1},this.settings.dragTimeout);var o=this.renderer.getCamera(),s=We(n,this.container),l=s.x,u=s.y,c=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),d=this.renderer.viewportToFramedGraph({x:l,y:u}),h=c.x-d.x,f=c.y-d.y,p=o.getState(),m=p.x+h,y=p.y+f;o.setState({x:m,y}),this.lastMouseX=l,this.lastMouseY=u,n.preventDefault(),n.stopPropagation()}}}},{key:"handleLeave",value:function(n){this.emit("mouseleave",Qe(n,this.container))}},{key:"handleEnter",value:function(n){this.emit("mouseenter",Qe(n,this.container))}},{key:"handleWheel",value:function(n){var r=this,a=this.renderer.getCamera();if(!(!this.enabled||!a.enabledZooming)){var o=ks(n);if(o){var s=uh(n,this.container);if(this.emit("wheel",s),s.sigmaDefaultPrevented){n.preventDefault(),n.stopPropagation();return}var l=a.getState().ratio,u=o>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,c=a.getBoundedRatio(l*u),d=o>0?1:-1,h=Date.now();l!==c&&(n.preventDefault(),n.stopPropagation(),!(this.currentWheelDirection===d&&this.lastWheelTriggerTime&&h-this.lastWheelTriggerTime<this.settings.zoomDuration/5)&&(a.animate(this.renderer.getViewportZoomedState(We(n,this.container),c),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){r.currentWheelDirection=0}),this.currentWheelDirection=d,this.lastWheelTriggerTime=h))}}}},{key:"setSettings",value:function(n){this.settings=n}}])}(xs),gh=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"],ph=gh.reduce(function(i,e){return I(I({},i),{},C({},e,xr[e]))},{}),mh=function(i){function e(t,n){var r;return xe(this,e),r=Ge(this,e,[t,n]),C(r,"enabled",!0),C(r,"isMoving",!1),C(r,"hasMoved",!1),C(r,"touchMode",0),C(r,"startTouchesPositions",[]),C(r,"lastTouches",[]),C(r,"lastTap",null),C(r,"settings",ph),r.handleStart=r.handleStart.bind(r),r.handleLeave=r.handleLeave.bind(r),r.handleMove=r.handleMove.bind(r),t.addEventListener("touchstart",r.handleStart,{capture:!1}),t.addEventListener("touchcancel",r.handleLeave,{capture:!1}),document.addEventListener("touchend",r.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",r.handleMove,{capture:!1,passive:!1}),r}return $e(e,i),Se(e,[{key:"kill",value:function(){var n=this.container;n.removeEventListener("touchstart",this.handleStart),n.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(n){var r=this;if(this.enabled){n.preventDefault();var a=Kn(n.touches);if(this.touchMode=a.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=a.map(function(f){return We(f,r.container)}),this.touchMode===2){var o=$t(this.startTouchesPositions,2),s=o[0],l=s.x,u=s.y,c=o[1],d=c.x,h=c.y;this.startTouchesAngle=Math.atan2(h-u,d-l),this.startTouchesDistance=Math.sqrt(Math.pow(d-l,2)+Math.pow(h-u,2))}this.emit("touchdown",Jt(n,this.lastTouches,this.container)),this.lastTouches=a,this.lastTouchesPositions=this.startTouchesPositions}}},{key:"handleLeave",value:function(n){if(!(!this.enabled||!this.startTouchesPositions.length)){switch(n.cancelable&&n.preventDefault(),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(n.touches.length===1){this.handleStart(n),n.preventDefault();break}case 1:if(this.isMoving){var r=this.renderer.getCamera(),a=r.getState(),o=r.getPreviousState()||{x:0,y:0};r.animate({x:a.x+this.settings.inertiaRatio*(a.x-o.x),y:a.y+this.settings.inertiaRatio*(a.y-o.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}if(this.emit("touchup",Jt(n,this.lastTouches,this.container)),!n.touches.length){var s=We(this.lastTouches[0],this.container),l=this.startTouchesPositions[0],u=Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2);if(!n.touches.length&&u<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var c=Jt(n,this.lastTouches,this.container);if(this.emit("doubletap",c),this.lastTap=null,!c.sigmaDefaultPrevented){var d=this.renderer.getCamera(),h=d.getBoundedRatio(d.getState().ratio/this.settings.doubleClickZoomingRatio);d.animate(this.renderer.getViewportZoomedState(s,h),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var f=Jt(n,this.lastTouches,this.container);this.emit("tap",f),this.lastTap={time:Date.now(),position:f.touches[0]||f.previousTouches[0]}}}this.lastTouches=Kn(n.touches),this.startTouchesPositions=[]}}},{key:"handleMove",value:function(n){var r=this;if(!(!this.enabled||!this.startTouchesPositions.length)){n.preventDefault();var a=Kn(n.touches),o=a.map(function(ne){return We(ne,r.container)}),s=this.lastTouches;this.lastTouches=a,this.lastTouchesPositions=o;var l=Jt(n,s,this.container);if(this.emit("touchmove",l),!l.sigmaDefaultPrevented&&(this.hasMoved||(this.hasMoved=o.some(function(ne,fe){var ae=r.startTouchesPositions[fe];return ae&&(ne.x!==ae.x||ne.y!==ae.y)})),!!this.hasMoved)){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){r.isMoving=!1},this.settings.dragTimeout);var u=this.renderer.getCamera(),c=this.startCameraState,d=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:{var h=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),f=h.x,p=h.y,m=this.renderer.viewportToFramedGraph(o[0]),y=m.x,k=m.y;u.setState({x:c.x+f-y,y:c.y+p-k});break}case 2:{var v={x:.5,y:.5,angle:0,ratio:1},b=o[0],g=b.x,w=b.y,_=o[1],x=_.x,S=_.y,N=Math.atan2(S-w,x-g)-this.startTouchesAngle,L=Math.hypot(S-w,x-g)/this.startTouchesDistance,M=u.getBoundedRatio(c.ratio/L);v.ratio=M,v.angle=c.angle+N;var E=this.getDimensions(),A=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:c}),F=Math.min(E.width,E.height)-2*d,G=F/E.width,W=F/E.height,Z=M/F,P=g-F/2/G,V=w-F/2/W,K=[P*Math.cos(-v.angle)-V*Math.sin(-v.angle),V*Math.cos(-v.angle)+P*Math.sin(-v.angle)];P=K[0],V=K[1],v.x=A.x-P*Z,v.y=A.y+V*Z,u.setState(v);break}}}}}},{key:"setSettings",value:function(n){this.settings=n}}])}(xs);function bh(i){if(Array.isArray(i))return Qi(i)}function yh(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function vh(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $a(i){return bh(i)||yh(i)||Yo(i)||vh()}function _h(i,e){if(i==null)return{};var t={};for(var n in i)if({}.hasOwnProperty.call(i,n)){if(e.indexOf(n)!==-1)continue;t[n]=i[n]}return t}function Pi(i,e){if(i==null)return{};var t,n,r=_h(i,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(i);for(n=0;n<a.length;n++)t=a[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(i,t)&&(r[t]=i[t])}return r}var Oa=function(){function i(e,t){xe(this,i),this.key=e,this.size=t}return Se(i,null,[{key:"compare",value:function(t,n){return t.size>n.size?-1:t.size<n.size||t.key>n.key?1:-1}}])}(),za=function(){function i(){xe(this,i),C(this,"width",0),C(this,"height",0),C(this,"cellSize",0),C(this,"columns",0),C(this,"rows",0),C(this,"cells",{})}return Se(i,[{key:"resizeAndClear",value:function(t,n){this.width=t.width,this.height=t.height,this.cellSize=n,this.columns=Math.ceil(t.width/n),this.rows=Math.ceil(t.height/n),this.cells={}}},{key:"getIndex",value:function(t){var n=Math.floor(t.x/this.cellSize),r=Math.floor(t.y/this.cellSize);return r*this.columns+n}},{key:"add",value:function(t,n,r){var a=new Oa(t,n),o=this.getIndex(r),s=this.cells[o];s||(s=[],this.cells[o]=s),s.push(a)}},{key:"organize",value:function(){for(var t in this.cells){var n=this.cells[t];n.sort(Oa.compare)}}},{key:"getLabelsToDisplay",value:function(t,n){var r=this.cellSize*this.cellSize,a=r/t/t,o=a*n/r,s=Math.ceil(o),l=[];for(var u in this.cells)for(var c=this.cells[u],d=0;d<Math.min(s,c.length);d++)l.push(c[d].key);return l}}])}();function wh(i){var e=i.graph,t=i.hoveredNode,n=i.highlightedNodes,r=i.displayedNodeLabels,a=[];return e.forEachEdge(function(o,s,l,u){(l===t||u===t||n.has(l)||n.has(u)||r.has(l)&&r.has(u))&&a.push(o)}),a}var Ba=150,Ua=50,et=Object.prototype.hasOwnProperty;function kh(i,e,t){if(!et.call(t,"x")||!et.call(t,"y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(e,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return t.color||(t.color=i.defaultNodeColor),!t.label&&t.label!==""&&(t.label=null),t.label!==void 0&&t.label!==null?t.label=""+t.label:t.label=null,t.size||(t.size=2),et.call(t,"hidden")||(t.hidden=!1),et.call(t,"highlighted")||(t.highlighted=!1),et.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=i.defaultNodeType),t.zIndex||(t.zIndex=0),t}function xh(i,e,t){return t.color||(t.color=i.defaultEdgeColor),t.label||(t.label=""),t.size||(t.size=.5),et.call(t,"hidden")||(t.hidden=!1),et.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=i.defaultEdgeType),t.zIndex||(t.zIndex=0),t}var Sh=function(i){function e(t,n){var r,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(xe(this,e),r=Ge(this,e),C(r,"elements",{}),C(r,"canvasContexts",{}),C(r,"webGLContexts",{}),C(r,"pickingLayers",new Set),C(r,"textures",{}),C(r,"frameBuffers",{}),C(r,"activeListeners",{}),C(r,"labelGrid",new za),C(r,"nodeDataCache",{}),C(r,"edgeDataCache",{}),C(r,"nodeProgramIndex",{}),C(r,"edgeProgramIndex",{}),C(r,"nodesWithForcedLabels",new Set),C(r,"edgesWithForcedLabels",new Set),C(r,"nodeExtent",{x:[0,1],y:[0,1]}),C(r,"nodeZExtent",[1/0,-1/0]),C(r,"edgeZExtent",[1/0,-1/0]),C(r,"matrix",He()),C(r,"invMatrix",He()),C(r,"correctionRatio",1),C(r,"customBBox",null),C(r,"normalizationFunction",Pa({x:[0,1],y:[0,1]})),C(r,"graphToViewportRatio",1),C(r,"itemIDsIndex",{}),C(r,"nodeIndices",{}),C(r,"edgeIndices",{}),C(r,"width",0),C(r,"height",0),C(r,"pixelRatio",Ra()),C(r,"pickingDownSizingRatio",2*r.pixelRatio),C(r,"displayedNodeLabels",new Set),C(r,"displayedEdgeLabels",new Set),C(r,"highlightedNodes",new Set),C(r,"hoveredNode",null),C(r,"hoveredEdge",null),C(r,"renderFrame",null),C(r,"renderHighlightedNodesFrame",null),C(r,"needToProcess",!1),C(r,"checkEdgesEventsFrame",null),C(r,"nodePrograms",{}),C(r,"nodeHoverPrograms",{}),C(r,"edgePrograms",{}),r.settings=lh(a),Mi(r.settings),rh(t),!(n instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");r.graph=t,r.container=n,r.createWebGLContext("edges",{picking:a.enableEdgeEvents}),r.createCanvasContext("edgeLabels"),r.createWebGLContext("nodes",{picking:!0}),r.createCanvasContext("labels"),r.createCanvasContext("hovers"),r.createWebGLContext("hoverNodes"),r.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),r.resize();for(var o in r.settings.nodeProgramClasses)r.registerNodeProgram(o,r.settings.nodeProgramClasses[o],r.settings.nodeHoverProgramClasses[o]);for(var s in r.settings.edgeProgramClasses)r.registerEdgeProgram(s,r.settings.edgeProgramClasses[s]);return r.camera=new Ga,r.bindCameraHandlers(),r.mouseCaptor=new fh(r.elements.mouse,r),r.mouseCaptor.setSettings(r.settings),r.touchCaptor=new mh(r.elements.mouse,r),r.touchCaptor.setSettings(r.settings),r.bindEventHandlers(),r.bindGraphHandlers(),r.handleSettingsUpdate(),r.refresh(),r}return $e(e,i),Se(e,[{key:"registerNodeProgram",value:function(n,r,a){return this.nodePrograms[n]&&this.nodePrograms[n].kill(),this.nodeHoverPrograms[n]&&this.nodeHoverPrograms[n].kill(),this.nodePrograms[n]=new r(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[n]=new(a||r)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(n,r){return this.edgePrograms[n]&&this.edgePrograms[n].kill(),this.edgePrograms[n]=new r(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(n){if(this.nodePrograms[n]){var r=this.nodePrograms,a=r[n],o=Pi(r,[n].map(dn));a.kill(),this.nodePrograms=o}if(this.nodeHoverPrograms[n]){var s=this.nodeHoverPrograms,l=s[n],u=Pi(s,[n].map(dn));l.kill(),this.nodePrograms=u}return this}},{key:"unregisterEdgeProgram",value:function(n){if(this.edgePrograms[n]){var r=this.edgePrograms,a=r[n],o=Pi(r,[n].map(dn));a.kill(),this.edgePrograms=o}return this}},{key:"resetWebGLTexture",value:function(n){var r=this.webGLContexts[n],a=this.frameBuffers[n],o=this.textures[n];o&&r.deleteTexture(o);var s=r.createTexture();return r.bindFramebuffer(r.FRAMEBUFFER,a),r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0),this.textures[n]=s,this}},{key:"bindCameraHandlers",value:function(){var n=this;return this.activeListeners.camera=function(){n.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(n){var r=n.x,a=n.y,o=_a(this.webGLContexts.nodes,this.frameBuffers.nodes,r,a,this.pixelRatio,this.pickingDownSizingRatio),s=va.apply(void 0,$a(o)),l=this.itemIDsIndex[s];return l&&l.type==="node"?l.id:null}},{key:"bindEventHandlers",value:function(){var n=this;this.activeListeners.handleResize=function(){n.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(a){var o=Zt(a),s={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}},l=n.getNodeAtPosition(o);if(l&&n.hoveredNode!==l&&!n.nodeDataCache[l].hidden){n.hoveredNode&&n.emit("leaveNode",I(I({},s),{},{node:n.hoveredNode})),n.hoveredNode=l,n.emit("enterNode",I(I({},s),{},{node:l})),n.scheduleHighlightedNodesRender();return}if(n.hoveredNode&&n.getNodeAtPosition(o)!==n.hoveredNode){var u=n.hoveredNode;n.hoveredNode=null,n.emit("leaveNode",I(I({},s),{},{node:u})),n.scheduleHighlightedNodesRender();return}if(n.settings.enableEdgeEvents){var c=n.hoveredNode?null:n.getEdgeAtPoint(s.event.x,s.event.y);c!==n.hoveredEdge&&(n.hoveredEdge&&n.emit("leaveEdge",I(I({},s),{},{edge:n.hoveredEdge})),c&&n.emit("enterEdge",I(I({},s),{},{edge:c})),n.hoveredEdge=c)}},this.activeListeners.handleMoveBody=function(a){var o=Zt(a);n.emit("moveBody",{event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(a){var o=Zt(a),s={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}};n.hoveredNode&&(n.emit("leaveNode",I(I({},s),{},{node:n.hoveredNode})),n.scheduleHighlightedNodesRender()),n.settings.enableEdgeEvents&&n.hoveredEdge&&(n.emit("leaveEdge",I(I({},s),{},{edge:n.hoveredEdge})),n.scheduleHighlightedNodesRender()),n.emit("leaveStage",I({},s))},this.activeListeners.handleEnter=function(a){var o=Zt(a),s={event:o,preventSigmaDefault:function(){o.preventSigmaDefault()}};n.emit("enterStage",I({},s))};var r=function(o){return function(s){var l=Zt(s),u={event:l,preventSigmaDefault:function(){l.preventSigmaDefault()}},c=n.getNodeAtPosition(l);if(c)return n.emit("".concat(o,"Node"),I(I({},u),{},{node:c}));if(n.settings.enableEdgeEvents){var d=n.getEdgeAtPoint(l.x,l.y);if(d)return n.emit("".concat(o,"Edge"),I(I({},u),{},{edge:d}))}return n.emit("".concat(o,"Stage"),u)}};return this.activeListeners.handleClick=r("click"),this.activeListeners.handleRightClick=r("rightClick"),this.activeListeners.handleDoubleClick=r("doubleClick"),this.activeListeners.handleWheel=r("wheel"),this.activeListeners.handleDown=r("down"),this.activeListeners.handleUp=r("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var n=this,r=this.graph,a=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(o){var s,l=(s=o.hints)===null||s===void 0?void 0:s.attributes;n.graph.forEachNode(function(c){return n.updateNode(c)});var u=!l||l.some(function(c){return a.has(c)});n.refresh({partialGraph:{nodes:r.nodes()},skipIndexation:!u,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(o){var s,l=(s=o.hints)===null||s===void 0?void 0:s.attributes;n.graph.forEachEdge(function(c){return n.updateEdge(c)});var u=l&&["zIndex","type"].some(function(c){return l==null?void 0:l.includes(c)});n.refresh({partialGraph:{edges:r.edges()},skipIndexation:!u,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(o){var s=o.key;n.addNode(s),n.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(o){var s=o.key;n.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(o){var s=o.key;n.removeNode(s),n.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(o){var s=o.key;n.addEdge(s),n.refresh({partialGraph:{edges:[s]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(o){var s=o.key;n.refresh({partialGraph:{edges:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(o){var s=o.key;n.removeEdge(s),n.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){n.clearEdgeState(),n.clearEdgeIndices(),n.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){n.clearEdgeState(),n.clearNodeState(),n.clearEdgeIndices(),n.clearNodeIndices(),n.refresh({schedule:!0})},r.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),r.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),r.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),r.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),r.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),r.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),r.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),r.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),r.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),r.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var n=this.graph;n.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),n.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),n.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),n.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),n.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),n.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),n.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),n.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),n.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),n.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(n,r){var a=_a(this.webGLContexts.edges,this.frameBuffers.edges,n,r,this.pixelRatio,this.pickingDownSizingRatio),o=va.apply(void 0,$a(a)),s=this.itemIDsIndex[o];return s&&s.type==="edge"?s.id:null}},{key:"process",value:function(){var n=this;this.emit("beforeProcess");var r=this.graph,a=this.settings,o=this.getDimensions();if(this.nodeExtent=ih(this.graph),!this.settings.autoRescale){var s=o.width,l=o.height,u=this.nodeExtent,c=u.x,d=u.y;this.nodeExtent={x:[(c[0]+c[1])/2-s/2,(c[0]+c[1])/2+s/2],y:[(d[0]+d[1])/2-l/2,(d[0]+d[1])/2+l/2]}}this.normalizationFunction=Pa(this.customBBox||this.nodeExtent);var h=new Ga,f=Yt(h.getState(),o,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(o,a.labelGridCellSize);for(var p={},m={},y={},k={},v=1,b=r.nodes(),g=0,w=b.length;g<w;g++){var _=b[g],x=this.nodeDataCache[_],S=r.getNodeAttributes(_);x.x=S.x,x.y=S.y,this.normalizationFunction.applyTo(x),typeof x.label=="string"&&!x.hidden&&this.labelGrid.add(_,x.size,this.framedGraphToViewport(x,{matrix:f})),p[x.type]=(p[x.type]||0)+1}this.labelGrid.organize();for(var N in this.nodePrograms){if(!et.call(this.nodePrograms,N))throw new Error('Sigma: could not find a suitable program for node type "'.concat(N,'"!'));this.nodePrograms[N].reallocate(p[N]||0),p[N]=0}this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1]&&(b=Ma(this.nodeZExtent,function(Ne){return n.nodeDataCache[Ne].zIndex},b));for(var L=0,M=b.length;L<M;L++){var E=b[L];m[E]=v,k[m[E]]={type:"node",id:E},v++;var A=this.nodeDataCache[E];this.addNodeToProgram(E,m[E],p[A.type]++)}for(var F={},G=r.edges(),W=0,Z=G.length;W<Z;W++){var P=G[W],V=this.edgeDataCache[P];F[V.type]=(F[V.type]||0)+1}this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1]&&(G=Ma(this.edgeZExtent,function(Ne){return n.edgeDataCache[Ne].zIndex},G));for(var K in this.edgePrograms){if(!et.call(this.edgePrograms,K))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(K,'"!'));this.edgePrograms[K].reallocate(F[K]||0),F[K]=0}for(var ne=0,fe=G.length;ne<fe;ne++){var ae=G[ne];y[ae]=v,k[y[ae]]={type:"edge",id:ae},v++;var ke=this.edgeDataCache[ae];this.addEdgeToProgram(ae,y[ae],F[ke.type]++)}return this.itemIDsIndex=k,this.nodeIndices=m,this.edgeIndices=y,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(n){var r=this,a=this.settings;if(this.camera.minRatio=a.minCameraRatio,this.camera.maxRatio=a.maxCameraRatio,this.camera.enabledZooming=a.enableCameraZooming,this.camera.enabledPanning=a.enableCameraPanning,this.camera.enabledRotation=a.enableCameraRotation,a.cameraPanBoundaries?this.camera.clean=function(c){return r.cleanCameraState(c,a.cameraPanBoundaries&&nr(a.cameraPanBoundaries)==="object"?a.cameraPanBoundaries:{})}:this.camera.clean=null,this.camera.setState(this.camera.validateState(this.camera.getState())),n){if(n.edgeProgramClasses!==a.edgeProgramClasses){for(var o in a.edgeProgramClasses)a.edgeProgramClasses[o]!==n.edgeProgramClasses[o]&&this.registerEdgeProgram(o,a.edgeProgramClasses[o]);for(var s in n.edgeProgramClasses)a.edgeProgramClasses[s]||this.unregisterEdgeProgram(s)}if(n.nodeProgramClasses!==a.nodeProgramClasses||n.nodeHoverProgramClasses!==a.nodeHoverProgramClasses){for(var l in a.nodeProgramClasses)(a.nodeProgramClasses[l]!==n.nodeProgramClasses[l]||a.nodeHoverProgramClasses[l]!==n.nodeHoverProgramClasses[l])&&this.registerNodeProgram(l,a.nodeProgramClasses[l],a.nodeHoverProgramClasses[l]);for(var u in n.nodeProgramClasses)a.nodeProgramClasses[u]||this.unregisterNodeProgram(u)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=r.tolerance,o=a===void 0?0:a,s=r.boundaries,l=I({},n),u=s||this.nodeExtent,c=$t(u.x,2),d=c[0],h=c[1],f=$t(u.y,2),p=f[0],m=f[1],y=[this.graphToViewport({x:d,y:p},{cameraState:n}),this.graphToViewport({x:h,y:p},{cameraState:n}),this.graphToViewport({x:d,y:m},{cameraState:n}),this.graphToViewport({x:h,y:m},{cameraState:n})],k=1/0,v=-1/0,b=1/0,g=-1/0;y.forEach(function(F){var G=F.x,W=F.y;k=Math.min(k,G),v=Math.max(v,G),b=Math.min(b,W),g=Math.max(g,W)});var w=v-k,_=g-b,x=this.getDimensions(),S=x.width,N=x.height,L=0,M=0;if(w>=S?v<S-o?L=v-(S-o):k>o&&(L=k-o):v>S+o?L=v-(S+o):k<-o&&(L=k+o),_>=N?g<N-o?M=g-(N-o):b>o&&(M=b-o):g>N+o?M=g-(N+o):b<-o&&(M=b+o),L||M){var E=this.viewportToFramedGraph({x:0,y:0},{cameraState:n}),A=this.viewportToFramedGraph({x:L,y:M},{cameraState:n});L=A.x-E.x,M=A.y-E.y,l.x+=L,l.y+=M}return l}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var n=this.camera.getState(),r=this.labelGrid.getLabelsToDisplay(n.ratio,this.settings.labelDensity);Ia(r,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;for(var a=this.canvasContexts.labels,o=0,s=r.length;o<s;o++){var l=r[o],u=this.nodeDataCache[l];if(!this.displayedNodeLabels.has(l)&&!u.hidden){var c=this.framedGraphToViewport(u),d=c.x,h=c.y,f=this.scaleSize(u.size);if(!(!u.forceLabel&&f<this.settings.labelRenderedSizeThreshold)&&!(d<-Ba||d>this.width+Ba||h<-Ua||h>this.height+Ua)){this.displayedNodeLabels.add(l);var p=this.settings.defaultDrawNodeLabel,m=this.nodePrograms[u.type],y=(m==null?void 0:m.drawLabel)||p;y(a,I(I({key:l},u),{},{size:f,x:d,y:h}),this.settings)}}}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var n=this.canvasContexts.edgeLabels;n.clearRect(0,0,this.width,this.height);var r=wh({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes});Ia(r,this.edgesWithForcedLabels);for(var a=new Set,o=0,s=r.length;o<s;o++){var l=r[o],u=this.graph.extremities(l),c=this.nodeDataCache[u[0]],d=this.nodeDataCache[u[1]],h=this.edgeDataCache[l];if(!a.has(l)&&!(h.hidden||c.hidden||d.hidden)){var f=this.settings.defaultDrawEdgeLabel,p=this.edgePrograms[h.type],m=(p==null?void 0:p.drawLabel)||f;m(n,I(I({key:l},h),{},{size:this.scaleSize(h.size)}),I(I(I({key:u[0]},c),this.framedGraphToViewport(c)),{},{size:this.scaleSize(c.size)}),I(I(I({key:u[1]},d),this.framedGraphToViewport(d)),{},{size:this.scaleSize(d.size)}),this.settings),a.add(l)}}return this.displayedEdgeLabels=a,this}},{key:"renderHighlightedNodes",value:function(){var n=this,r=this.canvasContexts.hovers;r.clearRect(0,0,this.width,this.height);var a=function(f){var p=n.nodeDataCache[f],m=n.framedGraphToViewport(p),y=m.x,k=m.y,v=n.scaleSize(p.size),b=n.settings.defaultDrawNodeHover,g=n.nodePrograms[p.type],w=(g==null?void 0:g.drawHover)||b;w(r,I(I({key:f},p),{},{size:v,x:y,y:k}),n.settings)},o=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&o.push(this.hoveredNode),this.highlightedNodes.forEach(function(h){h!==n.hoveredNode&&o.push(h)}),o.forEach(function(h){return a(h)});var s={};o.forEach(function(h){var f=n.nodeDataCache[h].type;s[f]=(s[f]||0)+1});for(var l in this.nodeHoverPrograms)this.nodeHoverPrograms[l].reallocate(s[l]||0),s[l]=0;o.forEach(function(h){var f=n.nodeDataCache[h];n.nodeHoverPrograms[f.type].process(0,s[f.type]++,f)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var u=this.getRenderParams();for(var c in this.nodeHoverPrograms){var d=this.nodeHoverPrograms[c];d.render(u)}}},{key:"scheduleHighlightedNodesRender",value:function(){var n=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame(function(){n.renderHighlightedNodesFrame=null,n.renderHighlightedNodes(),n.renderEdgeLabels()}))}},{key:"render",value:function(){var n=this;this.emit("beforeRender");var r=function(){return n.emit("afterRender"),n};if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.resize(),this.needToProcess&&this.process(),this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(y){return n.resetWebGLTexture(y)}),!this.graph.order)return r();var a=this.mouseCaptor,o=this.camera.isAnimated()||a.isMoving||a.draggedEvents||a.currentWheelDirection,s=this.camera.getState(),l=this.getDimensions(),u=this.getGraphDimensions(),c=this.getStagePadding();this.matrix=Yt(s,l,u,c),this.invMatrix=Yt(s,l,u,c,!0),this.correctionRatio=nh(this.matrix,s,l),this.graphToViewportRatio=this.getGraphToViewportRatio();var d=this.getRenderParams();for(var h in this.nodePrograms){var f=this.nodePrograms[h];f.render(d)}if(!this.settings.hideEdgesOnMove||!o)for(var p in this.edgePrograms){var m=this.edgePrograms[p];m.render(d)}return this.settings.hideLabelsOnMove&&o||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),r()}},{key:"addNode",value:function(n){var r=Object.assign({},this.graph.getNodeAttributes(n));this.settings.nodeReducer&&(r=this.settings.nodeReducer(n,r));var a=kh(this.settings,n,r);this.nodeDataCache[n]=a,this.nodesWithForcedLabels.delete(n),a.forceLabel&&!a.hidden&&this.nodesWithForcedLabels.add(n),this.highlightedNodes.delete(n),a.highlighted&&!a.hidden&&this.highlightedNodes.add(n),this.settings.zIndex&&(a.zIndex<this.nodeZExtent[0]&&(this.nodeZExtent[0]=a.zIndex),a.zIndex>this.nodeZExtent[1]&&(this.nodeZExtent[1]=a.zIndex))}},{key:"updateNode",value:function(n){this.addNode(n);var r=this.nodeDataCache[n];this.normalizationFunction.applyTo(r)}},{key:"removeNode",value:function(n){delete this.nodeDataCache[n],delete this.nodeProgramIndex[n],this.highlightedNodes.delete(n),this.hoveredNode===n&&(this.hoveredNode=null),this.nodesWithForcedLabels.delete(n)}},{key:"addEdge",value:function(n){var r=Object.assign({},this.graph.getEdgeAttributes(n));this.settings.edgeReducer&&(r=this.settings.edgeReducer(n,r));var a=xh(this.settings,n,r);this.edgeDataCache[n]=a,this.edgesWithForcedLabels.delete(n),a.forceLabel&&!a.hidden&&this.edgesWithForcedLabels.add(n),this.settings.zIndex&&(a.zIndex<this.edgeZExtent[0]&&(this.edgeZExtent[0]=a.zIndex),a.zIndex>this.edgeZExtent[1]&&(this.edgeZExtent[1]=a.zIndex))}},{key:"updateEdge",value:function(n){this.addEdge(n)}},{key:"removeEdge",value:function(n){delete this.edgeDataCache[n],delete this.edgeProgramIndex[n],this.hoveredEdge===n&&(this.hoveredEdge=null),this.edgesWithForcedLabels.delete(n)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new za,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0],this.highlightedNodes=new Set}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(n,r,a){var o=this.nodeDataCache[n],s=this.nodePrograms[o.type];if(!s)throw new Error('Sigma: could not find a suitable program for node type "'.concat(o.type,'"!'));s.process(r,a,o),this.nodeProgramIndex[n]=a}},{key:"addEdgeToProgram",value:function(n,r,a){var o=this.edgeDataCache[n],s=this.edgePrograms[o.type];if(!s)throw new Error('Sigma: could not find a suitable program for edge type "'.concat(o.type,'"!'));var l=this.graph.extremities(n),u=this.nodeDataCache[l[0]],c=this.nodeDataCache[l[1]];s.process(r,a,u,c,o),this.edgeProgramIndex[n]=a}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var n=this.settings,r=n.stagePadding,a=n.autoRescale;return a&&r||0}},{key:"createLayer",value:function(n,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.elements[n])throw new Error('Sigma: a layer named "'.concat(n,'" already exists'));var o=ah(r,{position:"absolute"},{class:"sigma-".concat(n)});return a.style&&Object.assign(o.style,a.style),this.elements[n]=o,"beforeLayer"in a&&a.beforeLayer?this.elements[a.beforeLayer].before(o):"afterLayer"in a&&a.afterLayer?this.elements[a.afterLayer].after(o):this.container.appendChild(o),o}},{key:"createCanvas",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.createLayer(n,"canvas",r)}},{key:"createCanvasContext",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.createCanvas(n,r),o={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[n]=a.getContext("2d",o),this}},{key:"createWebGLContext",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=(r==null?void 0:r.canvas)||this.createCanvas(n,r);r.hidden&&a.remove();var o=I({preserveDrawingBuffer:!1,antialias:!1},r),s;s=a.getContext("webgl2",o),s||(s=a.getContext("webgl",o)),s||(s=a.getContext("experimental-webgl",o));var l=s;if(this.webGLContexts[n]=l,l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),r.picking){this.pickingLayers.add(n);var u=l.createFramebuffer();if(!u)throw new Error("Sigma: cannot create a new frame buffer for layer ".concat(n));this.frameBuffers[n]=u}return l}},{key:"killLayer",value:function(n){var r=this.elements[n];if(!r)throw new Error("Sigma: cannot kill layer ".concat(n,", which does not exist"));if(this.webGLContexts[n]){var a,o=this.webGLContexts[n];(a=o.getExtension("WEBGL_lose_context"))===null||a===void 0||a.loseContext(),delete this.webGLContexts[n]}else this.canvasContexts[n]&&delete this.canvasContexts[n];return r.remove(),delete this.elements[n],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(n){this.unbindCameraHandlers(),this.camera=n,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(n){n!==this.graph&&(this.hoveredNode&&!n.hasNode(this.hoveredNode)&&(this.hoveredNode=null),this.hoveredEdge&&!n.hasEdge(this.hoveredEdge)&&(this.hoveredEdge=null),this.unbindGraphHandlers(),this.checkEdgesEventsFrame!==null&&(cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=n,this.bindGraphHandlers(),this.refresh())}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var n=this.customBBox||this.nodeExtent;return{width:n.x[1]-n.x[0]||1,height:n.y[1]-n.y[0]||1}}},{key:"getNodeDisplayData",value:function(n){var r=this.nodeDataCache[n];return r?Object.assign({},r):void 0}},{key:"getEdgeDisplayData",value:function(n){var r=this.edgeDataCache[n];return r?Object.assign({},r):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return I({},this.settings)}},{key:"getSetting",value:function(n){return this.settings[n]}},{key:"setSetting",value:function(n,r){var a=I({},this.settings);return this.settings[n]=r,Mi(this.settings),this.handleSettingsUpdate(a),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(n,r){return this.setSetting(n,r(this.settings[n])),this}},{key:"setSettings",value:function(n){var r=I({},this.settings);return this.settings=I(I({},this.settings),n),Mi(this.settings),this.handleSettingsUpdate(r),this.scheduleRefresh(),this}},{key:"resize",value:function(n){var r=this.width,a=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=Ra(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!n&&r===this.width&&a===this.height)return this;for(var o in this.elements){var s=this.elements[o];s.style.width=this.width+"px",s.style.height=this.height+"px"}for(var l in this.canvasContexts)this.elements[l].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[l].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[l].scale(this.pixelRatio,this.pixelRatio);for(var u in this.webGLContexts){this.elements[u].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[u].setAttribute("height",this.height*this.pixelRatio+"px");var c=this.webGLContexts[u];if(c.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(u)){var d=this.textures[u];d&&c.deleteTexture(d)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(n){var r=this,a=(n==null?void 0:n.skipIndexation)!==void 0?n==null?void 0:n.skipIndexation:!1,o=(n==null?void 0:n.schedule)!==void 0?n.schedule:!1,s=!n||!n.partialGraph;if(s)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(g){return r.addNode(g)}),this.graph.forEachEdge(function(g){return r.addEdge(g)});else{for(var l,u,c=((l=n.partialGraph)===null||l===void 0?void 0:l.nodes)||[],d=0,h=(c==null?void 0:c.length)||0;d<h;d++){var f=c[d];if(this.updateNode(f),a){var p=this.nodeProgramIndex[f];if(p===void 0)throw new Error('Sigma: node "'.concat(f,`" can't be repaint`));this.addNodeToProgram(f,this.nodeIndices[f],p)}}for(var m=(n==null||(u=n.partialGraph)===null||u===void 0?void 0:u.edges)||[],y=0,k=m.length;y<k;y++){var v=m[y];if(this.updateEdge(v),a){var b=this.edgeProgramIndex[v];if(b===void 0)throw new Error('Sigma: edge "'.concat(v,`" can't be repaint`));this.addEdgeToProgram(v,this.edgeIndices[v],b)}}}return(s||!a)&&(this.needToProcess=!0),o?this.scheduleRender():this.render(),this}},{key:"scheduleRender",value:function(){var n=this;return this.renderFrame||(this.renderFrame=requestAnimationFrame(function(){n.render()})),this}},{key:"scheduleRefresh",value:function(n){return this.refresh(I(I({},n),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(n,r){var a=this.camera.getState(),o=a.ratio,s=a.angle,l=a.x,u=a.y,c=this.settings,d=c.minCameraRatio,h=c.maxCameraRatio;typeof h=="number"&&(r=Math.min(r,h)),typeof d=="number"&&(r=Math.max(r,d));var f=r/o,p={x:this.width/2,y:this.height/2},m=this.viewportToFramedGraph(n),y=this.viewportToFramedGraph(p);return{angle:s,x:(m.x-y.x)*(1-f)+l,y:(m.y-y.y)*(1-f)+u,ratio:r}}},{key:"viewRectangle",value:function(){var n=this.viewportToFramedGraph({x:0,y:0}),r=this.viewportToFramedGraph({x:this.width,y:0}),a=this.viewportToFramedGraph({x:0,y:this.height});return{x1:n.x,y1:n.y,x2:r.x,y2:r.y,height:r.y-a.y}}},{key:"framedGraphToViewport",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=!!r.cameraState||!!r.viewportDimensions||!!r.graphDimensions,o=r.matrix?r.matrix:a?Yt(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getStagePadding()):this.matrix,s=tr(o,n);return{x:(1+s.x)*this.width/2,y:(1-s.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=!!r.cameraState||!!r.viewportDimensions||!r.graphDimensions,o=r.matrix?r.matrix:a?Yt(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getStagePadding(),!0):this.invMatrix,s=tr(o,{x:n.x/this.width*2-1,y:1-n.y/this.height*2});return isNaN(s.x)&&(s.x=0),isNaN(s.y)&&(s.y=0),s}},{key:"viewportToGraph",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(n,r))}},{key:"graphToViewport",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(n),r)}},{key:"getGraphToViewportRatio",value:function(){var n={x:0,y:0},r={x:1,y:1},a=Math.sqrt(Math.pow(n.x-r.x,2)+Math.pow(n.y-r.y,2)),o=this.graphToViewport(n),s=this.graphToViewport(r),l=Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2));return l/a}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(n){return this.customBBox=n,this.scheduleRender(),this}},{key:"kill",value:function(){this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var n=this.container;n.firstChild;)n.removeChild(n.firstChild);for(var r in this.nodePrograms)this.nodePrograms[r].kill();for(var a in this.nodeHoverPrograms)this.nodeHoverPrograms[a].kill();for(var o in this.edgePrograms)this.edgePrograms[o].kill();this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={};for(var s in this.elements)this.killLayer(s);this.canvasContexts={},this.webGLContexts={},this.elements={}}},{key:"scaleSize",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.camera.ratio;return n/this.settings.zoomToSizeRatioFunction(r)*(this.getSetting("itemSizesReference")==="positions"?r*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var n={};for(var r in this.elements)this.elements[r]instanceof HTMLCanvasElement&&(n[r]=this.elements[r]);return n}}])}(kr),Eh=Sh;function Th(i){if(Array.isArray(i))return i}function Ch(i,e){var t=i==null?null:typeof Symbol<"u"&&i[Symbol.iterator]||i["@@iterator"];if(t!=null){var n,r,a,o,s=[],l=!0,u=!1;try{if(a=(t=t.call(i)).next,e!==0)for(;!(l=(n=a.call(t)).done)&&(s.push(n.value),s.length!==e);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&t.return!=null&&(o=t.return(),Object(o)!==o))return}finally{if(u)throw r}}return s}}function ir(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,n=Array(e);t<e;t++)n[t]=i[t];return n}function Ss(i,e){if(i){if(typeof i=="string")return ir(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ir(i,e):void 0}}function Nh(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ah(i,e){return Th(i)||Ch(i,e)||Ss(i,e)||Nh()}function Lh(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}function Dh(i,e){if(typeof i!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var n=t.call(i,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}function Es(i){var e=Dh(i,"string");return typeof e=="symbol"?e:e+""}function Fh(i,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(i,Es(n.key),n)}}function Rh(i,e,t){return e&&Fh(i.prototype,e),Object.defineProperty(i,"prototype",{writable:!1}),i}function ai(i){return ai=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ai(i)}function Ts(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ts=function(){return!!i})()}function rr(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function Mh(i,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return rr(i)}function Ph(i,e,t){return e=ai(e),Mh(i,Ts()?Reflect.construct(e,t||[],ai(i).constructor):e.apply(i,t))}function ar(i,e){return ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},ar(i,e)}function Ih(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&ar(i,e)}function Ft(i,e,t){return(e=Es(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}function Gh(i){if(Array.isArray(i))return ir(i)}function $h(i){if(typeof Symbol<"u"&&i[Symbol.iterator]!=null||i["@@iterator"]!=null)return Array.from(i)}function Oh(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ii(i){return Gh(i)||$h(i)||Ss(i)||Oh()}function Ha(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(i);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(i,r).enumerable})),t.push.apply(t,n)}return t}function Wa(i){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Ha(Object(t),!0).forEach(function(n){Ft(i,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):Ha(Object(t)).forEach(function(n){Object.defineProperty(i,n,Object.getOwnPropertyDescriptor(t,n))})}return i}var zh="relative",Bh={drawLabel:void 0,drawHover:void 0,borders:[{size:{value:.1},color:{attribute:"borderColor"}},{size:{fill:!0},color:{attribute:"color"}}]},Uh="#000000";function Hh(i){var e=i.borders,t=xa(e.filter(function(r){var a=r.size;return"fill"in a}).length),n=`
precision highp float;

varying vec2 v_diffVector;
varying float v_radius;

#ifdef PICKING_MODE
varying vec4 v_color;
#else
// For normal mode, we use the border colors defined in the program:
`.concat(e.flatMap(function(r,a){var o=r.size;return"attribute"in o?["varying float v_borderSize_".concat(a+1,";")]:[]}).join(`
`),`
`).concat(e.flatMap(function(r,a){var o=r.color;return"attribute"in o?["varying vec4 v_borderColor_".concat(a+1,";")]:"value"in o?["uniform vec4 u_borderColor_".concat(a+1,";")]:[]}).join(`
`),`
#endif

uniform float u_correctionRatio;

const float bias = 255.0 / 254.0;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float dist = length(v_diffVector);
  float aaBorder = 2.0 * u_correctionRatio;
  float v_borderSize_0 = v_radius;
  vec4 v_borderColor_0 = transparent;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > v_radius)
    gl_FragColor = transparent;
  else {
    gl_FragColor = v_color;
    gl_FragColor.a *= bias;
  }
  #else
  // Sizes:
`).concat(e.flatMap(function(r,a){var o=r.size;if("fill"in o)return[];o=o;var s="attribute"in o?"v_borderSize_".concat(a+1):xa(o.value),l=(o.mode||zh)==="pixels"?"u_correctionRatio":"v_radius";return["  float borderSize_".concat(a+1," = ").concat(l," * ").concat(s,";")]}).join(`
`),`
  // Now, let's split the remaining space between "fill" borders:
  float fillBorderSize = (v_radius - (`).concat(e.flatMap(function(r,a){var o=r.size;return"fill"in o?[]:["borderSize_".concat(a+1)]}).join(" + "),") ) / ").concat(t,`;
`).concat(e.flatMap(function(r,a){var o=r.size;return"fill"in o?["  float borderSize_".concat(a+1," = fillBorderSize;")]:[]}).join(`
`),`

  // Finally, normalize all border sizes, to start from the full size and to end with the smallest:
  float adjustedBorderSize_0 = v_radius;
`).concat(e.map(function(r,a){return"  float adjustedBorderSize_".concat(a+1," = adjustedBorderSize_").concat(a," - borderSize_").concat(a+1,";")}).join(`
`),`

  // Colors:
  vec4 borderColor_0 = transparent;
`).concat(e.map(function(r,a){var o=r.color,s=[];return"attribute"in o?s.push("  vec4 borderColor_".concat(a+1," = v_borderColor_").concat(a+1,";")):"transparent"in o?s.push("  vec4 borderColor_".concat(a+1," = vec4(0.0, 0.0, 0.0, 0.0);")):s.push("  vec4 borderColor_".concat(a+1," = u_borderColor_").concat(a+1,";")),s.push("  borderColor_".concat(a+1,".a *= bias;")),s.push("  if (borderSize_".concat(a+1," <= 1.0 * u_correctionRatio) { borderColor_").concat(a+1," = borderColor_").concat(a,"; }")),s.join(`
`)}).join(`
`),`
  if (dist > adjustedBorderSize_0) {
    gl_FragColor = borderColor_0;
  } else `).concat(e.map(function(r,a){return"if (dist > adjustedBorderSize_".concat(a,` - aaBorder) {
    gl_FragColor = mix(borderColor_`).concat(a+1,", borderColor_").concat(a,", (dist - adjustedBorderSize_").concat(a,` + aaBorder) / aaBorder);
  } else if (dist > adjustedBorderSize_`).concat(a+1,`) {
    gl_FragColor = borderColor_`).concat(a+1,`;
  } else `)}).join(""),` { /* Nothing to add here */ }
  #endif
}
`);return n}function Wh(i){var e=i.borders,t=`
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec2 v_diffVector;
varying float v_radius;

#ifdef PICKING_MODE
attribute vec4 a_id;
varying vec4 v_color;
#else
`.concat(e.flatMap(function(n,r){var a=n.size;return"attribute"in a?["attribute float a_borderSize_".concat(r+1,";"),"varying float v_borderSize_".concat(r+1,";")]:[]}).join(`
`),`
`).concat(e.flatMap(function(n,r){var a=n.color;return"attribute"in a?["attribute vec4 a_borderColor_".concat(r+1,";"),"varying vec4 v_borderColor_".concat(r+1,";")]:[]}).join(`
`),`
#endif

const float bias = 255.0 / 254.0;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_radius = size / 2.0;
  v_diffVector = diffVector;

  #ifdef PICKING_MODE
  v_color = a_id;
  #else
`).concat(e.flatMap(function(n,r){var a=n.size;return"attribute"in a?["  v_borderSize_".concat(r+1," = a_borderSize_").concat(r+1,";")]:[]}).join(`
`),`
`).concat(e.flatMap(function(n,r){var a=n.color;return"attribute"in a?["  v_borderColor_".concat(r+1," = a_borderColor_").concat(r+1,";")]:[]}).join(`
`),`
  #endif
}
`);return t}var Cs=WebGLRenderingContext,ja=Cs.UNSIGNED_BYTE,On=Cs.FLOAT;function Ns(i){var e,t=Wa(Wa({},Bh),i||{}),n=t.borders,r=t.drawLabel,a=t.drawHover,o=["u_sizeRatio","u_correctionRatio","u_matrix"].concat(Ii(n.flatMap(function(s,l){var u=s.color;return"value"in u?["u_borderColor_".concat(l+1)]:[]})));return e=function(s){Ih(l,s);function l(){var u;Lh(this,l);for(var c=arguments.length,d=new Array(c),h=0;h<c;h++)d[h]=arguments[h];return u=Ph(this,l,[].concat(d)),Ft(rr(u),"drawLabel",r),Ft(rr(u),"drawHover",a),u}return Rh(l,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Wh(t),FRAGMENT_SHADER_SOURCE:Hh(t),METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:o,ATTRIBUTES:[{name:"a_position",size:2,type:On},{name:"a_id",size:4,type:ja,normalized:!0},{name:"a_size",size:1,type:On}].concat(Ii(n.flatMap(function(c,d){var h=c.color;return"attribute"in h?[{name:"a_borderColor_".concat(d+1),size:4,type:ja,normalized:!0}]:[]})),Ii(n.flatMap(function(c,d){var h=c.size;return"attribute"in h?[{name:"a_borderSize_".concat(d+1),size:1,type:On}]:[]}))),CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:On}],CONSTANT_DATA:[[l.ANGLE_1],[l.ANGLE_2],[l.ANGLE_3]]}}},{key:"processVisibleItem",value:function(c,d,h){var f=this.array;f[d++]=h.x,f[d++]=h.y,f[d++]=c,f[d++]=h.size,n.forEach(function(p){var m=p.color;"attribute"in m&&(f[d++]=_t(h[m.attribute]||m.defaultValue||Uh))}),n.forEach(function(p){var m=p.size;"attribute"in m&&(f[d++]=h[m.attribute]||m.defaultValue)})}},{key:"setUniforms",value:function(c,d){var h=d.gl,f=d.uniformLocations,p=f.u_sizeRatio,m=f.u_correctionRatio,y=f.u_matrix;h.uniform1f(m,c.correctionRatio),h.uniform1f(p,c.sizeRatio),h.uniformMatrix3fv(y,!1,c.matrix),n.forEach(function(k,v){var b=k.color;if("value"in b){var g=f["u_borderColor_".concat(v+1)],w=ad(b.value),_=Ah(w,4),x=_[0],S=_[1],N=_[2],L=_[3];h.uniform4f(g,x/255,S/255,N/255,L/255)}})}}]),l}(is),Ft(e,"ANGLE_1",0),Ft(e,"ANGLE_2",2*Math.PI/3),Ft(e,"ANGLE_3",4*Math.PI/3),e}Ns();function jh(){const i=arguments[0];for(let e=1,t=arguments.length;e<t;e++)if(arguments[e])for(const n in arguments[e])i[n]=arguments[e][n];return i}let ge=jh;typeof Object.assign=="function"&&(ge=Object.assign);function Ie(i,e,t,n){const r=i._nodes.get(e);let a=null;return r&&(n==="mixed"?a=r.out&&r.out[t]||r.undirected&&r.undirected[t]:n==="directed"?a=r.out&&r.out[t]:a=r.undirected&&r.undirected[t]),a}function we(i){return typeof i=="object"&&i!==null}function As(i){let e;for(e in i)return!1;return!0}function Me(i,e,t){Object.defineProperty(i,e,{enumerable:!1,configurable:!1,writable:!0,value:t})}function Ue(i,e,t){const n={enumerable:!0,configurable:!0};typeof t=="function"?n.get=t:(n.value=t,n.writable=!1),Object.defineProperty(i,e,n)}function Va(i){return!(!we(i)||i.attributes&&!Array.isArray(i.attributes))}function Vh(){let i=Math.floor(Math.random()*256)&255;return()=>i++}function tt(){const i=arguments;let e=null,t=-1;return{[Symbol.iterator](){return this},next(){let n=null;do{if(e===null){if(t++,t>=i.length)return{done:!0};e=i[t][Symbol.iterator]()}if(n=e.next(),n.done){e=null;continue}break}while(!0);return n}}}function zt(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}class Sr extends Error{constructor(e){super(),this.name="GraphError",this.message=e}}class R extends Sr{constructor(e){super(e),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,R.prototype.constructor)}}class D extends Sr{constructor(e){super(e),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,D.prototype.constructor)}}class O extends Sr{constructor(e){super(e),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,O.prototype.constructor)}}function Ls(i,e){this.key=i,this.attributes=e,this.clear()}Ls.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function Ds(i,e){this.key=i,this.attributes=e,this.clear()}Ds.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Fs(i,e){this.key=i,this.attributes=e,this.clear()}Fs.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Bt(i,e,t,n,r){this.key=e,this.attributes=r,this.undirected=i,this.source=t,this.target=n}Bt.prototype.attach=function(){let i="out",e="in";this.undirected&&(i=e="undirected");const t=this.source.key,n=this.target.key;this.source[i][n]=this,!(this.undirected&&t===n)&&(this.target[e][t]=this)};Bt.prototype.attachMulti=function(){let i="out",e="in";const t=this.source.key,n=this.target.key;this.undirected&&(i=e="undirected");const r=this.source[i],a=r[n];if(typeof a>"u"){r[n]=this,this.undirected&&t===n||(this.target[e][t]=this);return}a.previous=this,this.next=a,r[n]=this,this.target[e][t]=this};Bt.prototype.detach=function(){const i=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),delete this.source[t][e],delete this.target[n][i]};Bt.prototype.detachMulti=function(){const i=this.source.key,e=this.target.key;let t="out",n="in";this.undirected&&(t=n="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][e],delete this.target[n][i]):(this.next.previous=void 0,this.source[t][e]=this.next,this.target[n][i]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const Rs=0,Ms=1,Kh=2,Ps=3;function nt(i,e,t,n,r,a,o){let s,l,u,c;if(n=""+n,t===Rs){if(s=i._nodes.get(n),!s)throw new D(`Graph.${e}: could not find the "${n}" node in the graph.`);u=r,c=a}else if(t===Ps){if(r=""+r,l=i._edges.get(r),!l)throw new D(`Graph.${e}: could not find the "${r}" edge in the graph.`);const d=l.source.key,h=l.target.key;if(n===d)s=l.target;else if(n===h)s=l.source;else throw new D(`Graph.${e}: the "${n}" node is not attached to the "${r}" edge (${d}, ${h}).`);u=a,c=o}else{if(l=i._edges.get(n),!l)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`);t===Ms?s=l.source:s=l.target,u=r,c=a}return[s,u,c]}function qh(i,e,t){i.prototype[e]=function(n,r,a){const[o,s]=nt(this,e,t,n,r,a);return o.attributes[s]}}function Yh(i,e,t){i.prototype[e]=function(n,r){const[a]=nt(this,e,t,n,r);return a.attributes}}function Zh(i,e,t){i.prototype[e]=function(n,r,a){const[o,s]=nt(this,e,t,n,r,a);return o.attributes.hasOwnProperty(s)}}function Jh(i,e,t){i.prototype[e]=function(n,r,a,o){const[s,l,u]=nt(this,e,t,n,r,a,o);return s.attributes[l]=u,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:l}),this}}function Xh(i,e,t){i.prototype[e]=function(n,r,a,o){const[s,l,u]=nt(this,e,t,n,r,a,o);if(typeof u!="function")throw new R(`Graph.${e}: updater should be a function.`);const c=s.attributes,d=u(c[l]);return c[l]=d,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:l}),this}}function Qh(i,e,t){i.prototype[e]=function(n,r,a){const[o,s]=nt(this,e,t,n,r,a);return delete o.attributes[s],this.emit("nodeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:s}),this}}function ef(i,e,t){i.prototype[e]=function(n,r,a){const[o,s]=nt(this,e,t,n,r,a);if(!we(s))throw new R(`Graph.${e}: provided attributes are not a plain object.`);return o.attributes=s,this.emit("nodeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function tf(i,e,t){i.prototype[e]=function(n,r,a){const[o,s]=nt(this,e,t,n,r,a);if(!we(s))throw new R(`Graph.${e}: provided attributes are not a plain object.`);return ge(o.attributes,s),this.emit("nodeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:s}),this}}function nf(i,e,t){i.prototype[e]=function(n,r,a){const[o,s]=nt(this,e,t,n,r,a);if(typeof s!="function")throw new R(`Graph.${e}: provided updater is not a function.`);return o.attributes=s(o.attributes),this.emit("nodeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const rf=[{name:i=>`get${i}Attribute`,attacher:qh},{name:i=>`get${i}Attributes`,attacher:Yh},{name:i=>`has${i}Attribute`,attacher:Zh},{name:i=>`set${i}Attribute`,attacher:Jh},{name:i=>`update${i}Attribute`,attacher:Xh},{name:i=>`remove${i}Attribute`,attacher:Qh},{name:i=>`replace${i}Attributes`,attacher:ef},{name:i=>`merge${i}Attributes`,attacher:tf},{name:i=>`update${i}Attributes`,attacher:nf}];function af(i){rf.forEach(function({name:e,attacher:t}){t(i,e("Node"),Rs),t(i,e("Source"),Ms),t(i,e("Target"),Kh),t(i,e("Opposite"),Ps)})}function of(i,e,t){i.prototype[e]=function(n,r){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+r;if(r=arguments[2],a=Ie(this,o,s,t),!a)throw new D(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return a.attributes[r]}}function sf(i,e,t){i.prototype[e]=function(n){let r;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+n,o=""+arguments[1];if(r=Ie(this,a,o,t),!r)throw new D(`Graph.${e}: could not find an edge for the given path ("${a}" - "${o}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,r=this._edges.get(n),!r)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return r.attributes}}function lf(i,e,t){i.prototype[e]=function(n,r){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+r;if(r=arguments[2],a=Ie(this,o,s,t),!a)throw new D(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return a.attributes.hasOwnProperty(r)}}function uf(i,e,t){i.prototype[e]=function(n,r,a){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,l=""+r;if(r=arguments[2],a=arguments[3],o=Ie(this,s,l,t),!o)throw new D(`Graph.${e}: could not find an edge for the given path ("${s}" - "${l}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return o.attributes[r]=a,this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function cf(i,e,t){i.prototype[e]=function(n,r,a){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+n,l=""+r;if(r=arguments[2],a=arguments[3],o=Ie(this,s,l,t),!o)throw new D(`Graph.${e}: could not find an edge for the given path ("${s}" - "${l}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,o=this._edges.get(n),!o)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof a!="function")throw new R(`Graph.${e}: updater should be a function.`);return o.attributes[r]=a(o.attributes[r]),this.emit("edgeAttributesUpdated",{key:o.key,type:"set",attributes:o.attributes,name:r}),this}}function df(i,e,t){i.prototype[e]=function(n,r){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+r;if(r=arguments[2],a=Ie(this,o,s,t),!a)throw new D(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}return delete a.attributes[r],this.emit("edgeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:r}),this}}function hf(i,e,t){i.prototype[e]=function(n,r){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+r;if(r=arguments[2],a=Ie(this,o,s,t),!a)throw new D(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!we(r))throw new R(`Graph.${e}: provided attributes are not a plain object.`);return a.attributes=r,this.emit("edgeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function ff(i,e,t){i.prototype[e]=function(n,r){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+r;if(r=arguments[2],a=Ie(this,o,s,t),!a)throw new D(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(!we(r))throw new R(`Graph.${e}: provided attributes are not a plain object.`);return ge(a.attributes,r),this.emit("edgeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:r}),this}}function gf(i,e,t){i.prototype[e]=function(n,r){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new O(`Graph.${e}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new O(`Graph.${e}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+n,s=""+r;if(r=arguments[2],a=Ie(this,o,s,t),!a)throw new D(`Graph.${e}: could not find an edge for the given path ("${o}" - "${s}").`)}else{if(t!=="mixed")throw new O(`Graph.${e}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(n=""+n,a=this._edges.get(n),!a)throw new D(`Graph.${e}: could not find the "${n}" edge in the graph.`)}if(typeof r!="function")throw new R(`Graph.${e}: provided updater is not a function.`);return a.attributes=r(a.attributes),this.emit("edgeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const pf=[{name:i=>`get${i}Attribute`,attacher:of},{name:i=>`get${i}Attributes`,attacher:sf},{name:i=>`has${i}Attribute`,attacher:lf},{name:i=>`set${i}Attribute`,attacher:uf},{name:i=>`update${i}Attribute`,attacher:cf},{name:i=>`remove${i}Attribute`,attacher:df},{name:i=>`replace${i}Attributes`,attacher:hf},{name:i=>`merge${i}Attributes`,attacher:ff},{name:i=>`update${i}Attributes`,attacher:gf}];function mf(i){pf.forEach(function({name:e,attacher:t}){t(i,e("Edge"),"mixed"),t(i,e("DirectedEdge"),"directed"),t(i,e("UndirectedEdge"),"undirected")})}const bf=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function yf(i,e,t,n){let r=!1;for(const a in e){if(a===n)continue;const o=e[a];if(r=t(o.key,o.attributes,o.source.key,o.target.key,o.source.attributes,o.target.attributes,o.undirected),i&&r)return o.key}}function vf(i,e,t,n){let r,a,o,s=!1;for(const l in e)if(l!==n){r=e[l];do{if(a=r.source,o=r.target,s=t(r.key,r.attributes,a.key,o.key,a.attributes,o.attributes,r.undirected),i&&s)return r.key;r=r.next}while(r!==void 0)}}function Gi(i,e){const t=Object.keys(i),n=t.length;let r,a=0;return{[Symbol.iterator](){return this},next(){do if(r)r=r.next;else{if(a>=n)return{done:!0};const o=t[a++];if(o===e){r=void 0;continue}r=i[o]}while(!r);return{done:!1,value:{edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected}}}}}function _f(i,e,t,n){const r=e[t];if(!r)return;const a=r.source,o=r.target;if(n(r.key,r.attributes,a.key,o.key,a.attributes,o.attributes,r.undirected)&&i)return r.key}function wf(i,e,t,n){let r=e[t];if(!r)return;let a=!1;do{if(a=n(r.key,r.attributes,r.source.key,r.target.key,r.source.attributes,r.target.attributes,r.undirected),i&&a)return r.key;r=r.next}while(r!==void 0)}function $i(i,e){let t=i[e];if(t.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!t)return{done:!0};const r={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:r}}};let n=!1;return{[Symbol.iterator](){return this},next(){return n===!0?{done:!0}:(n=!0,{done:!1,value:{edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected}})}}}function kf(i,e){if(i.size===0)return[];if(e==="mixed"||e===i.type)return Array.from(i._edges.keys());const t=e==="undirected"?i.undirectedSize:i.directedSize,n=new Array(t),r=e==="undirected",a=i._edges.values();let o=0,s,l;for(;s=a.next(),s.done!==!0;)l=s.value,l.undirected===r&&(n[o++]=l.key);return n}function Is(i,e,t,n){if(e.size===0)return;const r=t!=="mixed"&&t!==e.type,a=t==="undirected";let o,s,l=!1;const u=e._edges.values();for(;o=u.next(),o.done!==!0;){if(s=o.value,r&&s.undirected!==a)continue;const{key:c,attributes:d,source:h,target:f}=s;if(l=n(c,d,h.key,f.key,h.attributes,f.attributes,s.undirected),i&&l)return c}}function xf(i,e){if(i.size===0)return zt();const t=e!=="mixed"&&e!==i.type,n=e==="undirected",r=i._edges.values();return{[Symbol.iterator](){return this},next(){let a,o;for(;;){if(a=r.next(),a.done)return a;if(o=a.value,!(t&&o.undirected!==n))break}return{value:{edge:o.key,attributes:o.attributes,source:o.source.key,target:o.target.key,sourceAttributes:o.source.attributes,targetAttributes:o.target.attributes,undirected:o.undirected},done:!1}}}}function Er(i,e,t,n,r,a){const o=e?vf:yf;let s;if(t!=="undirected"&&(n!=="out"&&(s=o(i,r.in,a),i&&s)||n!=="in"&&(s=o(i,r.out,a,n?void 0:r.key),i&&s))||t!=="directed"&&(s=o(i,r.undirected,a),i&&s))return s}function Sf(i,e,t,n){const r=[];return Er(!1,i,e,t,n,function(a){r.push(a)}),r}function Ef(i,e,t){let n=zt();return i!=="undirected"&&(e!=="out"&&typeof t.in<"u"&&(n=tt(n,Gi(t.in))),e!=="in"&&typeof t.out<"u"&&(n=tt(n,Gi(t.out,e?void 0:t.key)))),i!=="directed"&&typeof t.undirected<"u"&&(n=tt(n,Gi(t.undirected))),n}function Tr(i,e,t,n,r,a,o){const s=t?wf:_f;let l;if(e!=="undirected"&&(typeof r.in<"u"&&n!=="out"&&(l=s(i,r.in,a,o),i&&l)||typeof r.out<"u"&&n!=="in"&&(n||r.key!==a)&&(l=s(i,r.out,a,o),i&&l))||e!=="directed"&&typeof r.undirected<"u"&&(l=s(i,r.undirected,a,o),i&&l))return l}function Tf(i,e,t,n,r){const a=[];return Tr(!1,i,e,t,n,r,function(o){a.push(o)}),a}function Cf(i,e,t,n){let r=zt();return i!=="undirected"&&(typeof t.in<"u"&&e!=="out"&&n in t.in&&(r=tt(r,$i(t.in,n))),typeof t.out<"u"&&e!=="in"&&n in t.out&&(e||t.key!==n)&&(r=tt(r,$i(t.out,n)))),i!=="directed"&&typeof t.undirected<"u"&&n in t.undirected&&(r=tt(r,$i(t.undirected,n))),r}function Nf(i,e){const{name:t,type:n,direction:r}=e;i.prototype[t]=function(a,o){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];if(!arguments.length)return kf(this,n);if(arguments.length===1){a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new D(`Graph.${t}: could not find the "${a}" node in the graph.`);return Sf(this.multi,n==="mixed"?this.type:n,r,s)}if(arguments.length===2){a=""+a,o=""+o;const s=this._nodes.get(a);if(!s)throw new D(`Graph.${t}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(o))throw new D(`Graph.${t}:  could not find the "${o}" target node in the graph.`);return Tf(n,this.multi,r,s,o)}throw new R(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Af(i,e){const{name:t,type:n,direction:r}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[a]=function(u,c,d){if(!(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)){if(arguments.length===1)return d=u,Is(!1,this,n,d);if(arguments.length===2){u=""+u,d=c;const h=this._nodes.get(u);if(typeof h>"u")throw new D(`Graph.${a}: could not find the "${u}" node in the graph.`);return Er(!1,this.multi,n==="mixed"?this.type:n,r,h,d)}if(arguments.length===3){u=""+u,c=""+c;const h=this._nodes.get(u);if(!h)throw new D(`Graph.${a}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new D(`Graph.${a}:  could not find the "${c}" target node in the graph.`);return Tr(!1,n,this.multi,r,h,c,d)}throw new R(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const o="map"+t[0].toUpperCase()+t.slice(1);i.prototype[o]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();let d;if(u.length===0){let h=0;n!=="directed"&&(h+=this.undirectedSize),n!=="undirected"&&(h+=this.directedSize),d=new Array(h);let f=0;u.push((p,m,y,k,v,b,g)=>{d[f++]=c(p,m,y,k,v,b,g)})}else d=[],u.push((h,f,p,m,y,k,v)=>{d.push(c(h,f,p,m,y,k,v))});return this[a].apply(this,u),d};const s="filter"+t[0].toUpperCase()+t.slice(1);i.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop(),d=[];return u.push((h,f,p,m,y,k,v)=>{c(h,f,p,m,y,k,v)&&d.push(h)}),this[a].apply(this,u),d};const l="reduce"+t[0].toUpperCase()+t.slice(1);i.prototype[l]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new R(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new R(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,d;u.length===2?(c=u[0],d=u[1],u=[]):u.length===3?(c=u[1],d=u[2],u=[u[0]]):u.length===4&&(c=u[2],d=u[3],u=[u[0],u[1]]);let h=d;return u.push((f,p,m,y,k,v,b)=>{h=c(h,f,p,m,y,k,v,b)}),this[a].apply(this,u),h}}function Lf(i,e){const{name:t,type:n,direction:r}=e,a="find"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[a]=function(l,u,c){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return!1;if(arguments.length===1)return c=l,Is(!0,this,n,c);if(arguments.length===2){l=""+l,c=u;const d=this._nodes.get(l);if(typeof d>"u")throw new D(`Graph.${a}: could not find the "${l}" node in the graph.`);return Er(!0,this.multi,n==="mixed"?this.type:n,r,d,c)}if(arguments.length===3){l=""+l,u=""+u;const d=this._nodes.get(l);if(!d)throw new D(`Graph.${a}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(u))throw new D(`Graph.${a}:  could not find the "${u}" target node in the graph.`);return Tr(!0,n,this.multi,r,d,u,c)}throw new R(`Graph.${a}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const o="some"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[o]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,m,y,k)=>u(d,h,f,p,m,y,k)),!!this[a].apply(this,l)};const s="every"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[s]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,h,f,p,m,y,k)=>!u(d,h,f,p,m,y,k)),!this[a].apply(this,l)}}function Df(i,e){const{name:t,type:n,direction:r}=e,a=t.slice(0,-1)+"Entries";i.prototype[a]=function(o,s){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return zt();if(!arguments.length)return xf(this,n);if(arguments.length===1){o=""+o;const l=this._nodes.get(o);if(!l)throw new D(`Graph.${a}: could not find the "${o}" node in the graph.`);return Ef(n,r,l)}if(arguments.length===2){o=""+o,s=""+s;const l=this._nodes.get(o);if(!l)throw new D(`Graph.${a}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(s))throw new D(`Graph.${a}:  could not find the "${s}" target node in the graph.`);return Cf(n,r,l,s)}throw new R(`Graph.${a}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Ff(i){bf.forEach(e=>{Nf(i,e),Af(i,e),Lf(i,e),Df(i,e)})}const Rf=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function di(){this.A=null,this.B=null}di.prototype.wrap=function(i){this.A===null?this.A=i:this.B===null&&(this.B=i)};di.prototype.has=function(i){return this.A!==null&&i in this.A||this.B!==null&&i in this.B};function Xt(i,e,t,n,r){for(const a in n){const o=n[a],s=o.source,l=o.target,u=s===t?l:s;if(e&&e.has(u.key))continue;const c=r(u.key,u.attributes);if(i&&c)return u.key}}function Cr(i,e,t,n,r){if(e!=="mixed"){if(e==="undirected")return Xt(i,null,n,n.undirected,r);if(typeof t=="string")return Xt(i,null,n,n[t],r)}const a=new di;let o;if(e!=="undirected"){if(t!=="out"){if(o=Xt(i,null,n,n.in,r),i&&o)return o;a.wrap(n.in)}if(t!=="in"){if(o=Xt(i,a,n,n.out,r),i&&o)return o;a.wrap(n.out)}}if(e!=="directed"&&(o=Xt(i,a,n,n.undirected,r),i&&o))return o}function Mf(i,e,t){if(i!=="mixed"){if(i==="undirected")return Object.keys(t.undirected);if(typeof e=="string")return Object.keys(t[e])}const n=[];return Cr(!1,i,e,t,function(r){n.push(r)}),n}function Qt(i,e,t){const n=Object.keys(t),r=n.length;let a=0;return{[Symbol.iterator](){return this},next(){let o=null;do{if(a>=r)return i&&i.wrap(t),{done:!0};const s=t[n[a++]],l=s.source,u=s.target;if(o=l===e?u:l,i&&i.has(o.key)){o=null;continue}}while(o===null);return{done:!1,value:{neighbor:o.key,attributes:o.attributes}}}}}function Pf(i,e,t){if(i!=="mixed"){if(i==="undirected")return Qt(null,t,t.undirected);if(typeof e=="string")return Qt(null,t,t[e])}let n=zt();const r=new di;return i!=="undirected"&&(e!=="out"&&(n=tt(n,Qt(r,t,t.in))),e!=="in"&&(n=tt(n,Qt(r,t,t.out)))),i!=="directed"&&(n=tt(n,Qt(r,t,t.undirected))),n}function If(i,e){const{name:t,type:n,direction:r}=e;i.prototype[t]=function(a){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return[];a=""+a;const o=this._nodes.get(a);if(typeof o>"u")throw new D(`Graph.${t}: could not find the "${a}" node in the graph.`);return Mf(n==="mixed"?this.type:n,r,o)}}function Gf(i,e){const{name:t,type:n,direction:r}=e,a="forEach"+t[0].toUpperCase()+t.slice(1,-1);i.prototype[a]=function(u,c){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new D(`Graph.${a}: could not find the "${u}" node in the graph.`);Cr(!1,n==="mixed"?this.type:n,r,d,c)};const o="map"+t[0].toUpperCase()+t.slice(1);i.prototype[o]=function(u,c){const d=[];return this[a](u,(h,f)=>{d.push(c(h,f))}),d};const s="filter"+t[0].toUpperCase()+t.slice(1);i.prototype[s]=function(u,c){const d=[];return this[a](u,(h,f)=>{c(h,f)&&d.push(h)}),d};const l="reduce"+t[0].toUpperCase()+t.slice(1);i.prototype[l]=function(u,c,d){if(arguments.length<3)throw new R(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let h=d;return this[a](u,(f,p)=>{h=c(h,f,p)}),h}}function $f(i,e){const{name:t,type:n,direction:r}=e,a=t[0].toUpperCase()+t.slice(1,-1),o="find"+a;i.prototype[o]=function(u,c){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new D(`Graph.${o}: could not find the "${u}" node in the graph.`);return Cr(!0,n==="mixed"?this.type:n,r,d,c)};const s="some"+a;i.prototype[s]=function(u,c){return!!this[o](u,c)};const l="every"+a;i.prototype[l]=function(u,c){return!this[o](u,(h,f)=>!c(h,f))}}function Of(i,e){const{name:t,type:n,direction:r}=e,a=t.slice(0,-1)+"Entries";i.prototype[a]=function(o){if(n!=="mixed"&&this.type!=="mixed"&&n!==this.type)return zt();o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new D(`Graph.${a}: could not find the "${o}" node in the graph.`);return Pf(n==="mixed"?this.type:n,r,s)}}function zf(i){Rf.forEach(e=>{If(i,e),Gf(i,e),$f(i,e),Of(i,e)})}function zn(i,e,t,n,r){const a=n._nodes.values(),o=n.type;let s,l,u,c,d,h;for(;s=a.next(),s.done!==!0;){let f=!1;if(l=s.value,o!=="undirected"){c=l.out;for(u in c){d=c[u];do h=d.target,f=!0,r(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}if(o!=="directed"){c=l.undirected;for(u in c)if(!(e&&l.key>u)){d=c[u];do h=d.target,h.key!==u&&(h=d.source),f=!0,r(l.key,h.key,l.attributes,h.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}t&&!f&&r(l.key,null,l.attributes,null,null,null,null)}}function Bf(i,e){const t={key:i};return As(e.attributes)||(t.attributes=ge({},e.attributes)),t}function Uf(i,e,t){const n={key:e,source:t.source.key,target:t.target.key};return As(t.attributes)||(n.attributes=ge({},t.attributes)),i==="mixed"&&t.undirected&&(n.undirected=!0),n}function Hf(i){if(!we(i))throw new R('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in i))throw new R("Graph.import: serialized node is missing its key.");if("attributes"in i&&(!we(i.attributes)||i.attributes===null))throw new R("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function Wf(i){if(!we(i))throw new R('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in i))throw new R("Graph.import: serialized edge is missing its source.");if(!("target"in i))throw new R("Graph.import: serialized edge is missing its target.");if("attributes"in i&&(!we(i.attributes)||i.attributes===null))throw new R("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in i&&typeof i.undirected!="boolean")throw new R("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const jf=Vh(),Vf=new Set(["directed","undirected","mixed"]),Ka=new Set(["domain","_events","_eventsCount","_maxListeners"]),Kf=[{name:i=>`${i}Edge`,generateKey:!0},{name:i=>`${i}DirectedEdge`,generateKey:!0,type:"directed"},{name:i=>`${i}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:i=>`${i}EdgeWithKey`},{name:i=>`${i}DirectedEdgeWithKey`,type:"directed"},{name:i=>`${i}UndirectedEdgeWithKey`,type:"undirected"}],qf={allowSelfLoops:!0,multi:!1,type:"mixed"};function Yf(i,e,t){if(t&&!we(t))throw new R(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(e=""+e,t=t||{},i._nodes.has(e))throw new O(`Graph.addNode: the "${e}" node already exist in the graph.`);const n=new i.NodeDataClass(e,t);return i._nodes.set(e,n),i.emit("nodeAdded",{key:e,attributes:t}),n}function qa(i,e,t){const n=new i.NodeDataClass(e,t);return i._nodes.set(e,n),i.emit("nodeAdded",{key:e,attributes:t}),n}function Gs(i,e,t,n,r,a,o,s){if(!n&&i.type==="undirected")throw new O(`Graph.${e}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(n&&i.type==="directed")throw new O(`Graph.${e}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!we(s))throw new R(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`);if(a=""+a,o=""+o,s=s||{},!i.allowSelfLoops&&a===o)throw new O(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=i._nodes.get(a),u=i._nodes.get(o);if(!l)throw new D(`Graph.${e}: source node "${a}" not found.`);if(!u)throw new D(`Graph.${e}: target node "${o}" not found.`);const c={key:null,undirected:n,source:a,target:o,attributes:s};if(t)r=i._edgeKeyGenerator();else if(r=""+r,i._edges.has(r))throw new O(`Graph.${e}: the "${r}" edge already exists in the graph.`);if(!i.multi&&(n?typeof l.undirected[o]<"u":typeof l.out[o]<"u"))throw new O(`Graph.${e}: an edge linking "${a}" to "${o}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new Bt(n,r,l,u,s);i._edges.set(r,d);const h=a===o;return n?(l.undirectedDegree++,u.undirectedDegree++,h&&(l.undirectedLoops++,i._undirectedSelfLoopCount++)):(l.outDegree++,u.inDegree++,h&&(l.directedLoops++,i._directedSelfLoopCount++)),i.multi?d.attachMulti():d.attach(),n?i._undirectedSize++:i._directedSize++,c.key=r,i.emit("edgeAdded",c),r}function Zf(i,e,t,n,r,a,o,s,l){if(!n&&i.type==="undirected")throw new O(`Graph.${e}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(n&&i.type==="directed")throw new O(`Graph.${e}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(l){if(typeof s!="function")throw new R(`Graph.${e}: invalid updater function. Expecting a function but got "${s}"`)}else if(!we(s))throw new R(`Graph.${e}: invalid attributes. Expecting an object but got "${s}"`)}a=""+a,o=""+o;let u;if(l&&(u=s,s=void 0),!i.allowSelfLoops&&a===o)throw new O(`Graph.${e}: source & target are the same ("${a}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=i._nodes.get(a),d=i._nodes.get(o),h,f;if(!t&&(h=i._edges.get(r),h)){if((h.source.key!==a||h.target.key!==o)&&(!n||h.source.key!==o||h.target.key!==a))throw new O(`Graph.${e}: inconsistency detected when attempting to merge the "${r}" edge with "${a}" source & "${o}" target vs. ("${h.source.key}", "${h.target.key}").`);f=h}if(!f&&!i.multi&&c&&(f=n?c.undirected[o]:c.out[o]),f){const v=[f.key,!1,!1,!1];if(l?!u:!s)return v;if(l){const b=f.attributes;f.attributes=u(b),i.emit("edgeAttributesUpdated",{type:"replace",key:f.key,attributes:f.attributes})}else ge(f.attributes,s),i.emit("edgeAttributesUpdated",{type:"merge",key:f.key,attributes:f.attributes,data:s});return v}s=s||{},l&&u&&(s=u(s));const p={key:null,undirected:n,source:a,target:o,attributes:s};if(t)r=i._edgeKeyGenerator();else if(r=""+r,i._edges.has(r))throw new O(`Graph.${e}: the "${r}" edge already exists in the graph.`);let m=!1,y=!1;c||(c=qa(i,a,{}),m=!0,a===o&&(d=c,y=!0)),d||(d=qa(i,o,{}),y=!0),h=new Bt(n,r,c,d,s),i._edges.set(r,h);const k=a===o;return n?(c.undirectedDegree++,d.undirectedDegree++,k&&(c.undirectedLoops++,i._undirectedSelfLoopCount++)):(c.outDegree++,d.inDegree++,k&&(c.directedLoops++,i._directedSelfLoopCount++)),i.multi?h.attachMulti():h.attach(),n?i._undirectedSize++:i._directedSize++,p.key=r,i.emit("edgeAdded",p),[r,!0,m,y]}function Dt(i,e){i._edges.delete(e.key);const{source:t,target:n,attributes:r}=e,a=e.undirected,o=t===n;a?(t.undirectedDegree--,n.undirectedDegree--,o&&(t.undirectedLoops--,i._undirectedSelfLoopCount--)):(t.outDegree--,n.inDegree--,o&&(t.directedLoops--,i._directedSelfLoopCount--)),i.multi?e.detachMulti():e.detach(),a?i._undirectedSize--:i._directedSize--,i.emit("edgeDropped",{key:e.key,attributes:r,source:t.key,target:n.key,undirected:a})}class ee extends ws.EventEmitter{constructor(e){if(super(),e=ge({},qf,e),typeof e.multi!="boolean")throw new R(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${e.multi}".`);if(!Vf.has(e.type))throw new R(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${e.type}".`);if(typeof e.allowSelfLoops!="boolean")throw new R(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${e.allowSelfLoops}".`);const t=e.type==="mixed"?Ls:e.type==="directed"?Ds:Fs;Me(this,"NodeDataClass",t);const n="geid_"+jf()+"_";let r=0;const a=()=>{let o;do o=n+r++;while(this._edges.has(o));return o};Me(this,"_attributes",{}),Me(this,"_nodes",new Map),Me(this,"_edges",new Map),Me(this,"_directedSize",0),Me(this,"_undirectedSize",0),Me(this,"_directedSelfLoopCount",0),Me(this,"_undirectedSelfLoopCount",0),Me(this,"_edgeKeyGenerator",a),Me(this,"_options",e),Ka.forEach(o=>Me(this,o,this[o])),Ue(this,"order",()=>this._nodes.size),Ue(this,"size",()=>this._edges.size),Ue(this,"directedSize",()=>this._directedSize),Ue(this,"undirectedSize",()=>this._undirectedSize),Ue(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Ue(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Ue(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Ue(this,"multi",this._options.multi),Ue(this,"type",this._options.type),Ue(this,"allowSelfLoops",this._options.allowSelfLoops),Ue(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(e){return this._nodes.has(""+e)}hasDirectedEdge(e,t){if(this.type==="undirected")return!1;if(arguments.length===1){const n=""+e,r=this._edges.get(n);return!!r&&!r.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.out.hasOwnProperty(t):!1}throw new R(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(e,t){if(this.type==="directed")return!1;if(arguments.length===1){const n=""+e,r=this._edges.get(n);return!!r&&r.undirected}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?n.undirected.hasOwnProperty(t):!1}throw new R(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(e,t){if(arguments.length===1){const n=""+e;return this._edges.has(n)}else if(arguments.length===2){e=""+e,t=""+t;const n=this._nodes.get(e);return n?typeof n.out<"u"&&n.out.hasOwnProperty(t)||typeof n.undirected<"u"&&n.undirected.hasOwnProperty(t):!1}throw new R(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(e,t){if(this.type==="undirected")return;if(e=""+e,t=""+t,this.multi)throw new O("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const n=this._nodes.get(e);if(!n)throw new D(`Graph.directedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new D(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);const r=n.out&&n.out[t]||void 0;if(r)return r.key}undirectedEdge(e,t){if(this.type==="directed")return;if(e=""+e,t=""+t,this.multi)throw new O("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const n=this._nodes.get(e);if(!n)throw new D(`Graph.undirectedEdge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new D(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);const r=n.undirected&&n.undirected[t]||void 0;if(r)return r.key}edge(e,t){if(this.multi)throw new O("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.edge: could not find the "${e}" source node in the graph.`);if(!this._nodes.has(t))throw new D(`Graph.edge: could not find the "${t}" target node in the graph.`);const r=n.out&&n.out[t]||n.undirected&&n.undirected[t]||void 0;if(r)return r.key}areDirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.areDirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in||t in n.out}areOutNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.areOutNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.out}areInNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.areInNeighbors: could not find the "${e}" node in the graph.`);return this.type==="undirected"?!1:t in n.in}areUndirectedNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.areUndirectedNeighbors: could not find the "${e}" node in the graph.`);return this.type==="directed"?!1:t in n.undirected}areNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.areNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&(t in n.in||t in n.out)||this.type!=="directed"&&t in n.undirected}areInboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.areInboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.in||this.type!=="directed"&&t in n.undirected}areOutboundNeighbors(e,t){e=""+e,t=""+t;const n=this._nodes.get(e);if(!n)throw new D(`Graph.areOutboundNeighbors: could not find the "${e}" node in the graph.`);return this.type!=="undirected"&&t in n.out||this.type!=="directed"&&t in n.undirected}inDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.inDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.outDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.directedDegree: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.undirectedDegree: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.inboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree),n}outboundDegree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.outboundDegree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.outDegree),n}degree(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.degree: could not find the "${e}" node in the graph.`);let n=0;return this.type!=="directed"&&(n+=t.undirectedDegree),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree),n}inDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.inDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.outDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.directedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,r=0;return this.type!=="directed"&&(n+=t.undirectedDegree,r+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree,r+=t.directedLoops),n-r}outboundDegreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,r=0;return this.type!=="directed"&&(n+=t.undirectedDegree,r+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.outDegree,r+=t.directedLoops),n-r}degreeWithoutSelfLoops(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.degreeWithoutSelfLoops: could not find the "${e}" node in the graph.`);let n=0,r=0;return this.type!=="directed"&&(n+=t.undirectedDegree,r+=t.undirectedLoops*2),this.type!=="undirected"&&(n+=t.inDegree+t.outDegree,r+=t.directedLoops*2),n-r}source(e){e=""+e;const t=this._edges.get(e);if(!t)throw new D(`Graph.source: could not find the "${e}" edge in the graph.`);return t.source.key}target(e){e=""+e;const t=this._edges.get(e);if(!t)throw new D(`Graph.target: could not find the "${e}" edge in the graph.`);return t.target.key}extremities(e){e=""+e;const t=this._edges.get(e);if(!t)throw new D(`Graph.extremities: could not find the "${e}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(e,t){e=""+e,t=""+t;const n=this._edges.get(t);if(!n)throw new D(`Graph.opposite: could not find the "${t}" edge in the graph.`);const r=n.source.key,a=n.target.key;if(e===r)return a;if(e===a)return r;throw new D(`Graph.opposite: the "${e}" node is not attached to the "${t}" edge (${r}, ${a}).`)}hasExtremity(e,t){e=""+e,t=""+t;const n=this._edges.get(e);if(!n)throw new D(`Graph.hasExtremity: could not find the "${e}" edge in the graph.`);return n.source.key===t||n.target.key===t}isUndirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new D(`Graph.isUndirected: could not find the "${e}" edge in the graph.`);return t.undirected}isDirected(e){e=""+e;const t=this._edges.get(e);if(!t)throw new D(`Graph.isDirected: could not find the "${e}" edge in the graph.`);return!t.undirected}isSelfLoop(e){e=""+e;const t=this._edges.get(e);if(!t)throw new D(`Graph.isSelfLoop: could not find the "${e}" edge in the graph.`);return t.source===t.target}addNode(e,t){return Yf(this,e,t).key}mergeNode(e,t){if(t&&!we(t))throw new R(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);e=""+e,t=t||{};let n=this._nodes.get(e);return n?(t&&(ge(n.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:e,attributes:n.attributes,data:t})),[e,!1]):(n=new this.NodeDataClass(e,t),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:t}),[e,!0])}updateNode(e,t){if(t&&typeof t!="function")throw new R(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);e=""+e;let n=this._nodes.get(e);if(n){if(t){const a=n.attributes;n.attributes=t(a),this.emit("nodeAttributesUpdated",{type:"replace",key:e,attributes:n.attributes})}return[e,!1]}const r=t?t({}):{};return n=new this.NodeDataClass(e,r),this._nodes.set(e,n),this.emit("nodeAdded",{key:e,attributes:r}),[e,!0]}dropNode(e){e=""+e;const t=this._nodes.get(e);if(!t)throw new D(`Graph.dropNode: could not find the "${e}" node in the graph.`);let n;if(this.type!=="undirected"){for(const r in t.out){n=t.out[r];do Dt(this,n),n=n.next;while(n)}for(const r in t.in){n=t.in[r];do Dt(this,n),n=n.next;while(n)}}if(this.type!=="directed")for(const r in t.undirected){n=t.undirected[r];do Dt(this,n),n=n.next;while(n)}this._nodes.delete(e),this.emit("nodeDropped",{key:e,attributes:t.attributes})}dropEdge(e){let t;if(arguments.length>1){const n=""+arguments[0],r=""+arguments[1];if(t=Ie(this,n,r,this.type),!t)throw new D(`Graph.dropEdge: could not find the "${n}" -> "${r}" edge in the graph.`)}else if(e=""+e,t=this._edges.get(e),!t)throw new D(`Graph.dropEdge: could not find the "${e}" edge in the graph.`);return Dt(this,t),this}dropDirectedEdge(e,t){if(arguments.length<2)throw new O("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new O("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");e=""+e,t=""+t;const n=Ie(this,e,t,"directed");if(!n)throw new D(`Graph.dropDirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Dt(this,n),this}dropUndirectedEdge(e,t){if(arguments.length<2)throw new O("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new O("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const n=Ie(this,e,t,"undirected");if(!n)throw new D(`Graph.dropUndirectedEdge: could not find a "${e}" -> "${t}" edge in the graph.`);return Dt(this,n),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const e=this._nodes.values();let t;for(;t=e.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(e){return this._attributes[e]}getAttributes(){return this._attributes}hasAttribute(e){return this._attributes.hasOwnProperty(e)}setAttribute(e,t){return this._attributes[e]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}updateAttribute(e,t){if(typeof t!="function")throw new R("Graph.updateAttribute: updater should be a function.");const n=this._attributes[e];return this._attributes[e]=t(n),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:e}),this}removeAttribute(e){return delete this._attributes[e],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:e}),this}replaceAttributes(e){if(!we(e))throw new R("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=e,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(e){if(!we(e))throw new R("Graph.mergeAttributes: provided attributes are not a plain object.");return ge(this._attributes,e),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:e}),this}updateAttributes(e){if(typeof e!="function")throw new R("Graph.updateAttributes: provided updater is not a function.");return this._attributes=e(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(e,t){if(typeof e!="function")throw new R("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!Va(t))throw new R("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._nodes.values();let r,a;for(;r=n.next(),r.done!==!0;)a=r.value,a.attributes=e(a.key,a.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(e,t){if(typeof e!="function")throw new R("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!Va(t))throw new R("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const n=this._edges.values();let r,a,o,s;for(;r=n.next(),r.done!==!0;)a=r.value,o=a.source,s=a.target,a.attributes=e(a.key,a.attributes,o.key,s.key,o.attributes,s.attributes,a.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(e){if(typeof e!="function")throw new R("Graph.forEachAdjacencyEntry: expecting a callback.");zn(!1,!1,!1,this,e)}forEachAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new R("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");zn(!1,!1,!0,this,e)}forEachAssymetricAdjacencyEntry(e){if(typeof e!="function")throw new R("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");zn(!1,!0,!1,this,e)}forEachAssymetricAdjacencyEntryWithOrphans(e){if(typeof e!="function")throw new R("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");zn(!1,!0,!0,this,e)}nodes(){return Array.from(this._nodes.keys())}forEachNode(e){if(typeof e!="function")throw new R("Graph.forEachNode: expecting a callback.");const t=this._nodes.values();let n,r;for(;n=t.next(),n.done!==!0;)r=n.value,e(r.key,r.attributes)}findNode(e){if(typeof e!="function")throw new R("Graph.findNode: expecting a callback.");const t=this._nodes.values();let n,r;for(;n=t.next(),n.done!==!0;)if(r=n.value,e(r.key,r.attributes))return r.key}mapNodes(e){if(typeof e!="function")throw new R("Graph.mapNode: expecting a callback.");const t=this._nodes.values();let n,r;const a=new Array(this.order);let o=0;for(;n=t.next(),n.done!==!0;)r=n.value,a[o++]=e(r.key,r.attributes);return a}someNode(e){if(typeof e!="function")throw new R("Graph.someNode: expecting a callback.");const t=this._nodes.values();let n,r;for(;n=t.next(),n.done!==!0;)if(r=n.value,e(r.key,r.attributes))return!0;return!1}everyNode(e){if(typeof e!="function")throw new R("Graph.everyNode: expecting a callback.");const t=this._nodes.values();let n,r;for(;n=t.next(),n.done!==!0;)if(r=n.value,!e(r.key,r.attributes))return!1;return!0}filterNodes(e){if(typeof e!="function")throw new R("Graph.filterNodes: expecting a callback.");const t=this._nodes.values();let n,r;const a=[];for(;n=t.next(),n.done!==!0;)r=n.value,e(r.key,r.attributes)&&a.push(r.key);return a}reduceNodes(e,t){if(typeof e!="function")throw new R("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new R("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let n=t;const r=this._nodes.values();let a,o;for(;a=r.next(),a.done!==!0;)o=a.value,n=e(n,o.key,o.attributes);return n}nodeEntries(){const e=this._nodes.values();return{[Symbol.iterator](){return this},next(){const t=e.next();if(t.done)return t;const n=t.value;return{value:{node:n.key,attributes:n.attributes},done:!1}}}}export(){const e=new Array(this._nodes.size);let t=0;this._nodes.forEach((r,a)=>{e[t++]=Bf(a,r)});const n=new Array(this._edges.size);return t=0,this._edges.forEach((r,a)=>{n[t++]=Uf(this.type,a,r)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:e,edges:n}}import(e,t=!1){if(e instanceof ee)return e.forEachNode((l,u)=>{t?this.mergeNode(l,u):this.addNode(l,u)}),e.forEachEdge((l,u,c,d,h,f,p)=>{t?p?this.mergeUndirectedEdgeWithKey(l,c,d,u):this.mergeDirectedEdgeWithKey(l,c,d,u):p?this.addUndirectedEdgeWithKey(l,c,d,u):this.addDirectedEdgeWithKey(l,c,d,u)}),this;if(!we(e))throw new R("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(e.attributes){if(!we(e.attributes))throw new R("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(e.attributes):this.replaceAttributes(e.attributes)}let n,r,a,o,s;if(e.nodes){if(a=e.nodes,!Array.isArray(a))throw new R("Graph.import: invalid nodes. Expecting an array.");for(n=0,r=a.length;n<r;n++){o=a[n],Hf(o);const{key:l,attributes:u}=o;t?this.mergeNode(l,u):this.addNode(l,u)}}if(e.edges){let l=!1;if(this.type==="undirected"&&(l=!0),a=e.edges,!Array.isArray(a))throw new R("Graph.import: invalid edges. Expecting an array.");for(n=0,r=a.length;n<r;n++){s=a[n],Wf(s);const{source:u,target:c,attributes:d,undirected:h=l}=s;let f;"key"in s?(f=t?h?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:h?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,f.call(this,s.key,u,c,d)):(f=t?h?this.mergeUndirectedEdge:this.mergeDirectedEdge:h?this.addUndirectedEdge:this.addDirectedEdge,f.call(this,u,c,d))}}return this}nullCopy(e){const t=new ee(ge({},this._options,e));return t.replaceAttributes(ge({},this.getAttributes())),t}emptyCopy(e){const t=this.nullCopy(e);return this._nodes.forEach((n,r)=>{const a=ge({},n.attributes);n=new t.NodeDataClass(r,a),t._nodes.set(r,n)}),t}copy(e){if(e=e||{},typeof e.type=="string"&&e.type!==this.type&&e.type!=="mixed")throw new O(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${e.type}" because this would mean losing information about the current graph.`);if(typeof e.multi=="boolean"&&e.multi!==this.multi&&e.multi!==!0)throw new O("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof e.allowSelfLoops=="boolean"&&e.allowSelfLoops!==this.allowSelfLoops&&e.allowSelfLoops!==!0)throw new O("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const t=this.emptyCopy(e),n=this._edges.values();let r,a;for(;r=n.next(),r.done!==!0;)a=r.value,Gs(t,"copy",!1,a.undirected,a.key,a.source.key,a.target.key,ge({},a.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const e={};this._nodes.forEach((a,o)=>{e[o]=a.attributes});const t={},n={};this._edges.forEach((a,o)=>{const s=a.undirected?"--":"->";let l="",u=a.source.key,c=a.target.key,d;a.undirected&&u>c&&(d=u,u=c,c=d);const h=`(${u})${s}(${c})`;o.startsWith("geid_")?this.multi&&(typeof n[h]>"u"?n[h]=0:n[h]++,l+=`${n[h]}. `):l+=`[${o}]: `,l+=h,t[l]=a.attributes});const r={};for(const a in this)this.hasOwnProperty(a)&&!Ka.has(a)&&typeof this[a]!="function"&&typeof a!="symbol"&&(r[a]=this[a]);return r.attributes=this._attributes,r.nodes=e,r.edges=t,Me(r,"constructor",this.constructor),r}}typeof Symbol<"u"&&(ee.prototype[Symbol.for("nodejs.util.inspect.custom")]=ee.prototype.inspect);Kf.forEach(i=>{["add","merge","update"].forEach(e=>{const t=i.name(e),n=e==="add"?Gs:Zf;i.generateKey?ee.prototype[t]=function(r,a,o){return n(this,t,!0,(i.type||this.type)==="undirected",null,r,a,o,e==="update")}:ee.prototype[t]=function(r,a,o,s){return n(this,t,!1,(i.type||this.type)==="undirected",r,a,o,s,e==="update")}})});af(ee);mf(ee);Ff(ee);zf(ee);class $s extends ee{constructor(e){const t=ge({type:"directed"},e);if("multi"in t&&t.multi!==!1)throw new R("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new R('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Os extends ee{constructor(e){const t=ge({type:"undirected"},e);if("multi"in t&&t.multi!==!1)throw new R("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new R('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class zs extends ee{constructor(e){const t=ge({multi:!0},e);if("multi"in t&&t.multi!==!0)throw new R("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}}class Bs extends ee{constructor(e){const t=ge({type:"directed",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new R("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new R('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Us extends ee{constructor(e){const t=ge({type:"undirected",multi:!0},e);if("multi"in t&&t.multi!==!0)throw new R("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new R('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}function Ut(i){i.from=function(e,t){const n=ge({},e.options,t),r=new i(n);return r.import(e),r}}Ut(ee);Ut($s);Ut(Os);Ut(zs);Ut(Bs);Ut(Us);ee.Graph=ee;ee.DirectedGraph=$s;ee.UndirectedGraph=Os;ee.MultiGraph=zs;ee.MultiDirectedGraph=Bs;ee.MultiUndirectedGraph=Us;ee.InvalidArgumentsGraphError=R;ee.NotFoundGraphError=D;ee.UsageGraphError=O;const nn={stadiums:[{location:[-112.264582,33.527812],snapped_distance:148.12,stadium:"State Farm Stadium",location_name:"Glendale, Arizona",stadium_id:"PHO00"},{location:[-84.399046,33.755357],snapped_distance:90.88,stadium:"Mercedes-Benz Stadium",location_name:"Atlanta, Georgia",stadium_id:"ATL97"},{location:[-76.62411,39.278456],snapped_distance:123,stadium:"M&T Bank Stadium",location_name:"Baltimore, Maryland",stadium_id:"BAL00"},{location:[-78.785693,42.774789],snapped_distance:138.08,stadium:"Highmark Stadium",location_name:"Orchard Park, New York",stadium_id:"BUF00"},{location:[-80.851204,35.226491],snapped_distance:160.58,stadium:"Bank of America Stadium",location_name:"Charlotte, NC",stadium_id:"CAR00"},{location:[-87.61828,41.861992],snapped_distance:135.28,stadium:"Soldier Field",location_name:"Chicago, Illinois",stadium_id:"CHI98"},{location:[-84.51597,39.093953],snapped_distance:116.45,stadium:"Paycor Stadium",location_name:"Cincinnati, Ohio",stadium_id:"CIN00"},{location:[-81.698462,41.50526],snapped_distance:125.03,stadium:"Huntington Bank Field",location_name:"Cleveland, Ohio",stadium_id:"CLE00"},{location:[-97.092141,32.746628],snapped_distance:141.09,stadium:"AT&T Stadium",location_name:"Arlington, Texas",stadium_id:"DAL00"},{location:[-104.985474,39.739146],snapped_distance:49.42,stadium:"Empower Field at Mile High",location_name:"Denver, Colorado",stadium_id:"DEN00"},{location:[-83.04419,42.340475],snapped_distance:124.06,stadium:"Ford Field",location_name:"Detroit, Michigan",stadium_id:"DET00"},{location:[-88.064076,44.501549],snapped_distance:148.06,stadium:"Lambeau Field",location_name:"Green Bay, Wisconsin",stadium_id:"GNB00"},{location:[-95.412328,29.684709],snapped_distance:144.44,stadium:"NRG Stadium",location_name:"Houston, Texas",stadium_id:"HOU00"},{location:[-86.164751,39.761029],snapped_distance:135.07,stadium:"Lucas Oil Stadium",location_name:"Indianapolis, Indiana",stadium_id:"IND00"},{location:[-81.638737,30.324787],snapped_distance:155.09,stadium:"EverBank Stadium",location_name:"Jacksonville, Florida",stadium_id:"JAX00"},{location:[-94.482762,39.047949],snapped_distance:142.79,stadium:"GEHA Field at Arrowhead Stadium",location_name:"Kansas City, Missouri",stadium_id:"KAN00"},{location:[-118.337024,33.953639],snapped_distance:195.64,stadium:"SoFi Stadium",location_name:"Inglewood, CA",stadium_id:"LAX01"},{location:[-115.18531,36.09044],snapped_distance:128.36,stadium:"Allegiant Stadium",location_name:"Paradise, Nevada",stadium_id:"VEG00"},{location:[-80.240122,25.958487],snapped_distance:132.29,stadium:"Hard Rock Stadium",location_name:"Coral Gables, Florida",stadium_id:"MIA00"},{location:[-93.257268,44.974936],snapped_distance:118.94,stadium:"U.S. Bank Stadium",location_name:"Minneapolis, Minnesota",stadium_id:"MIN01"},{location:[-71.262575,42.091505],snapped_distance:130.34,stadium:"Gillette Stadium",location_name:"Foxborough, Massachusetts",stadium_id:"BOS00"},{location:[-90.081659,29.949726],snapped_distance:133.94,stadium:"Caesars Superdome",location_name:"New Orleans, Louisiana",stadium_id:"NOR00"},{location:[-74.072549,40.814068],snapped_distance:167.4,stadium:"MetLife Stadium",location_name:"East Rutherford, New Jersey",stadium_id:"NYC01"},{location:[-75.166302,39.901614],snapped_distance:134.09,stadium:"Lincoln Financial Field",location_name:"Philadelphia, Pennsylvania",stadium_id:"PHI00"},{location:[-80.016791,40.445865],snapped_distance:120.54,stadium:"Acrisure Stadium",location_name:"Pittsburgh, Pennsylvania",stadium_id:"PIT00"},{location:[-122.333253,47.595189],snapped_distance:123.99,stadium:"Lumen Field",location_name:"Seattle, WA",stadium_id:"SEA00"},{location:[-121.970788,37.404153],snapped_distance:145.87,stadium:"Levi's Stadium",location_name:"Santa Clara, California",stadium_id:"SFO01"},{location:[-82.501915,27.975695],snapped_distance:140.13,stadium:"Raymond James Stadium",location_name:"Tampa Bay, Florida",stadium_id:"TAM00"},{location:[-86.772878,36.166285],snapped_distance:134.22,stadium:"Nissan Stadium",location_name:"Nashville, Tennessee",stadium_id:"NAS00"},{location:[-76.863612,38.909135],snapped_distance:167.18,stadium:"Northwest Stadium",location_name:"Landover, Maryland",stadium_id:"WAS00"}],durations:[[0,103558.92,134950.06,128994.7,119000.02,101657.23,104691.92,117693.69,57861.56,49975.77,116052.91,112069.27,64507,97905.28,115991.16,73761.72,22334.26,19151.34,133336.38,99485.82,157014.34,84960.38,143348.61,140078.95,121485.95,86732.64,42106.27,122303.88,93326.83,133937.61],[103428.08,0,43050.93,55331.77,15739.38,45592.15,28174.49,44030.77,47169.07,82977.98,45049.94,59659.94,48006.11,33266.57,21223.49,49528.4,122771.13,110148.13,38565.23,68203.1,71186.78,28281.22,55623.75,50071.56,43433.33,152426.7,137948.38,27532.73,15903.67,40745.07],[135048.23,42944.44,0,26720.95,28086.55,42964.21,32822.48,23616.62,81474.28,99090.43,32446.18,57372.52,87227.55,37406.94,45764.11,66638.52,154391.3,139925.41,65316.81,68187.8,29689.71,67496.01,13199.04,7390.6,16729.06,158659.17,161338.03,58825.78,42323.36,3125.09],[128897.3,55156.16,27060.55,0,41617.82,33318.23,27350.02,12123.3,82985.63,89444.45,18723.22,47726.54,91186.09,31102.51,64851.48,60334.09,146925.69,130279.43,84404.17,58541.81,29394.99,75402.63,25800.86,26656.19,13955.68,149013.19,151692.05,77913.14,43808.25,28143.17],[118834.67,15811.29,28185.83,41602.77,0,48032.3,30225.56,32028.96,62575.66,93469.52,40431.61,62100.09,63127.64,36335.32,23724.15,60019.93,138177.72,125554.72,43276.84,72970.64,56320.96,43402.77,40757.93,35206.46,28567.52,162918.23,153354.97,36785.81,26395.2,25879.98],[101890.19,45968.85,43402.08,33600.31,48198.25,0,19897.58,21695.81,57368.9,57527.6,18102.18,14737.28,65569.36,12729.58,66930.34,31956.91,115008.84,98362.59,84272.08,25552.55,61619.97,55619.94,48429.01,47239.45,28667.82,116023.93,119775.2,73239.58,30472.15,44484.7],[104805.25,28128.3,32669.92,27486.93,30139.44,19721.1,0,16185.93,55957.77,69996.16,17143.34,33788.89,64158.23,7447.8,48838.3,36546.59,124148.3,111117.62,66431.53,44659.45,55506.59,48374.77,41840.85,37798.8,19205.8,134306.89,134944.13,55399.04,16780.39,33752.54],[117598.15,43857.02,23908.41,12252.94,32039.43,21432.88,16050.87,0,71686.48,77559.09,10914.84,35841.18,79886.94,19803.36,55273.09,49034.94,135040.33,118394.07,74825.78,46656.46,40272.59,64103.48,28935.34,27745.78,9174.15,137127.84,139806.69,68334.75,32509.1,24991.03],[57956.5,47084.66,81633.28,83124.02,62525.76,57410.96,55966.73,71823.01,0,47230.56,71190.36,69371.21,15384.56,53042.73,61297.04,31063.66,79363.93,68850.05,78642.25,56787.76,109443.65,30849.68,93880.62,88653.91,74842.88,119913.2,96650.29,67609.75,39759.25,80370.02],[49946.48,82564.78,99599.16,89797.4,93058.73,57823.41,69907.25,77892.9,47423.31,0,74027.15,64442.48,62022.03,62840.35,103526.27,33802.51,58636.82,41990.56,120868.01,51859.03,117817.05,77309.29,104626.09,103436.53,84864.91,73181.55,71058.27,109835.51,67015.09,100681.78],[116211.98,45007.23,32708.19,18774.18,40475.69,17676.85,17220.96,11001.92,71133.91,73593.3,0,32085.16,79334.38,18328.7,63709.34,47244.01,131074.53,114428.28,83262.03,42900.43,45590.55,65253.7,37735.12,36545.55,17973.93,133371.81,135840.91,72277.96,33659.32,33790.81],[111859.54,59354.48,57461.57,47659.8,62090.55,14761.4,33789.88,35755.3,69179.95,64320.25,32161.67,0,77706.76,26621.88,80315.98,38960.36,121801.49,105155.23,97657.72,17652.69,74741.18,68789.82,62488.5,61298.94,42727.31,108124.07,126567.86,86625.21,43804.79,58544.19],[64532.62,48098.6,87176.57,91484.12,63120.75,65771.07,64326.84,80183.12,15466.21,61686.84,79550.47,78062.06,0,61402.84,52639.51,44877.7,85940.05,83030.77,69984.72,70601.8,114986.94,21608.73,99423.91,94197.2,83202.99,133727.23,105712.05,58952.22,48119.36,85913.31],[98012.1,33564.1,37215.24,31259.87,36302.13,12496.13,7485.72,19958.87,52934.03,62898.48,18280.54,26563.93,61134.49,0,54525.59,29448.89,117355.16,104019.93,71867.33,37434.48,59279.53,49661.77,45613.79,42344.13,23751.13,127097.37,127734.6,60834.82,18067.39,38297.86],[115877.84,21180.23,45809.93,64973.52,23744.2,66582.55,48772.18,55399.71,61360.77,103968.38,63802.36,80650.34,52518.18,54256.97,0,70518.8,137285.27,129182.76,20465.09,89193.51,75129.67,32793.3,58639,52830.57,51938.27,173417.11,156983,14368.99,36894.07,43504.08],[73751.89,49108.55,66428.89,60473.52,59602.5,31704.72,36451.02,49172.52,31072.3,33868.46,47371.32,38953.91,45027.64,29384.12,70070.04,0,91636.17,74989.91,87411.78,26370.46,88493.18,51696.18,74827.45,71557.77,52964.78,103328.08,101204.78,76379.27,33558.85,67511.52],[22284.76,122888.27,154279.41,147217.53,138329.38,115243.55,124021.27,135313.03,79213.95,58655.1,131447.28,121862.62,85859.39,117234.63,137343.55,91515.01,0,17033.94,154688.77,109279.17,175237.19,106312.78,162046.23,159408.3,140815.3,70770.14,21810.19,143656.27,112656.17,153266.95],[19347.97,110288.33,140470.92,130669.16,125729.44,98695.16,111071.37,118764.65,68966.53,42106.72,114898.9,105314.23,83073.88,104004.46,129299.87,74966.63,16949.06,0,146645.08,92730.78,158688.81,98852.51,145497.84,144308.28,125736.66,68245.98,32126.3,135612.58,100056.24,140667.02],[133353.14,38643.61,65388.43,84552.02,43322.7,84045.93,66628.27,74978.22,78836.07,121431.76,83380.87,98113.72,69993.48,71720.35,20450.67,87982.18,154760.56,146658.06,0,106656.88,94708.17,50268.6,78217.5,72409.06,71516.77,190880.48,174458.31,16656.12,54357.45,63082.58],[99286.36,67779.41,68405.96,58604.2,72978.42,25705.79,44677.75,46699.69,56606.77,51747.08,43106.06,17753.55,70562.1,37509.74,88740.91,26387.18,109228.32,92582.06,106082.64,0,86623.85,74533.37,73432.89,72243.33,53671.7,91351.73,113799.05,95050.14,52229.72,69488.58],[156976.25,71190.69,29448.94,29550.85,56368.2,61514.46,55428.97,40319.53,109193.2,117640.67,45770.56,74897.47,114946.47,59181.46,74831.68,88413.05,175121.91,158475.66,94384.38,86738.04,0,95214.93,16495.7,23439.65,39584.32,177209.42,179888.28,87893.34,70042.27,32192.65],[84999.74,28382.54,67394.45,75469.97,43404.69,55508.39,48312.69,64168.97,30885.18,77087.68,65188.14,68820.68,21640.08,49643.65,32923.45,51834.39,106407.17,98707.17,50268.66,74476.83,95204.82,0,79641.79,74415.09,66478.94,148732.83,126179.17,39236.16,31860.43,66131.2],[143112.42,55669.09,13388.55,25660.54,40846.6,48020.78,41565.14,28673.18,93671.6,104146.99,37502.75,62429.09,99424.88,45317.63,58771.29,74549.21,161628.23,144981.97,78323.98,73244.36,17003.02,79693.34,0,7379.26,25237.95,163715.75,166394.59,71832.95,54520.68,16132.26],[140288.59,50055.44,7492.37,26572.4,35197.55,47131.02,37909.35,27783.42,88585.27,103257.23,36612.99,61539.33,94338.55,42493.81,52875.11,71725.39,159631.66,144092.22,72427.8,72354.6,23854.22,74607.01,7363.55,0,20895.87,162825.98,165504.84,65936.77,49434.35,10236.08],[121784.7,43471.09,16871.64,13888.02,28648.61,28403.48,19405.44,9055.88,75041.05,84529.69,17885.44,42811.79,83241.52,23989.9,51882.27,53221.48,141127.75,125364.67,71434.96,53627.06,39576.89,66559.59,25248.01,20709.01,0,144098.44,146777.3,64943.93,35863.67,17954.26],[86899.66,152028.06,159044.33,149242.56,162522.02,116344.16,134894.5,137338.06,119780.99,73161.37,133744.44,108391.93,133736.33,127669.13,172989.55,103287.72,70810.92,68150.95,190331.28,91519.5,177262.22,148684.36,164071.27,162881.7,144310.08,0,52931.69,179298.78,136478.36,160126.95],[42113.01,138038.39,161948.59,152146.83,153479.48,120172.84,135064.25,140242.33,96716.59,71158.07,136376.58,126791.91,105687.64,127838.88,157049.92,101284.42,21897.37,32184.06,174395.13,113997.32,180166.48,126141.03,166975.52,165785.95,147214.33,53082.86,0,163362.63,127806.3,163031.2],[122258,27548.47,58919.46,78083.04,36853.72,72950.8,55533.13,68509.23,67740.94,110336.63,72408.59,87018.59,58898.34,60625.21,14296.66,76887.04,143665.44,135562.92,16613.61,95561.75,88239.2,39173.46,71748.52,65940.09,65047.79,179785.34,163363.17,0,43262.31,56613.61],[93311.76,15747.6,42305.5,43911.23,26241.55,30410.49,16753.95,32610.23,39737.8,67404.99,33629.4,44224.73,47938.26,18084.91,36709.09,33955.41,112654.81,100031.8,54050.83,52630.12,70115.87,31829.49,54552.84,49326.13,35630.11,136853.72,127832.05,43018.32,0,41042.24],[133929.98,40835.45,3201.47,27883.07,25977.56,44126.34,33984.61,24778.75,80356.03,100252.55,33608.31,58534.65,86109.3,38569.07,43655.13,67800.66,153273.05,140650.03,63207.82,69349.93,32521.21,66377.77,16030.54,10222.1,17891.19,159821.31,162500.16,56716.79,41205.11,0]],distances:[[0,2979.84,3769.13,3609.68,3374.17,2901.5,2998.29,3324.82,1713.83,1464.05,3263.95,3001.79,1923.44,2813.7,3316.94,2021.19,609.01,449.16,3805.49,2719.54,4340.65,2473.56,3991.48,3864.67,3398.57,2236.4,1144.65,3494.27,2708.59,3795.21],[2982.35,0,1111.08,1443.08,389.9,1104,739.96,1158.21,1289.31,2257.67,1161.06,1449.15,1288.72,809.34,559.07,1279.25,3522.04,3159.5,1047.53,1816.79,1805.64,756.3,1414.99,1268.22,1098.8,4284.59,3923.79,736.31,398.99,1054.78],[3836.16,1109.4,0,600.53,725.81,1122.88,829.38,599.3,2226.23,2714.54,844.36,1457.79,2335.29,951.62,1218.16,1714.86,4375.85,3922.98,1750.94,1781.12,641.83,1803.45,304.67,160.01,397.84,4445.51,4574.68,1532.3,1127.13,60.21],[3599.55,1426.24,599.36,0,1046.97,844.17,687.66,294.96,2228.43,2435.83,431.94,1179.08,2394.77,794.77,1669.42,1558.01,4087.53,3644.27,2202.2,1502.41,741.35,1986.14,582.41,613.19,337.54,4166.8,4295.97,1983.56,1130.18,606.2],[3375.42,390.4,726.6,1045.72,0,1206.08,753.46,818.67,1682.38,2518,1016.82,1551.23,1683.4,938.34,619.29,1539.59,3915.11,3552.56,1152.07,1873.37,1424.73,1150.98,1034.08,883.74,717.89,4544.93,4316.86,933.43,659.33,670.3],[2893.57,1101.45,1124.63,849.91,1202.94,0,462.67,549.33,1570.08,1614.44,450.07,335.55,1736.43,287.8,1667.34,825.01,3266.14,2822.88,2155.8,658.89,1580.88,1488.17,1260.38,1224.66,738.38,3323.28,3474.57,1844.58,753.72,1131.48],[2992.73,740.24,833.73,688.04,751.88,464.31,0,403.18,1542.42,1916.51,422.79,809.45,1708.77,175.9,1283.12,938.09,3532.42,3128.75,1794.58,1131.6,1419.02,1300.13,1069.84,929.26,463.17,3773.19,3883.32,1483.36,444.18,840.58],[3314.36,1141.05,602.09,295.1,818.55,548.59,402.47,0,1943.24,2140.26,270.07,883.5,2109.59,509.58,1441,1272.82,3791.96,3348.7,1973.77,1206.84,1026.08,1700.95,737.84,702.12,215.84,3871.23,4000.4,1755.14,845,608.94],[1713.07,1285.79,2225.76,2242.99,1680.12,1569.72,1539.88,1958.13,0,1259.04,1910.26,1882.32,427.43,1460.01,1625.78,901.72,2306,1944.42,2114.33,1600.06,2910.19,841.3,2519.54,2382.89,2018.12,3525.24,2708.72,1803.11,1097.66,2184.28],[1463.06,2254.92,2717.07,2442.34,2512.28,1616.98,1916.03,2141.77,1260.14,0,2040.53,1752.43,1679.32,1742.39,2820.81,980.32,1657.75,1214.48,3309.27,1470.18,3173.32,2089.56,2852.82,2817.1,2330.82,2119.44,2084.78,2998.05,1859.83,2723.92],[3252.03,1160.54,845.67,430.44,1020.54,449.72,423.17,270.37,1906.68,2039.92,0,784.63,2073.03,446.4,1642.99,1232.71,3691.63,3248.36,2175.77,1107.97,1135.77,1720.44,981.42,945.7,459.42,3772.36,3900.06,1903.67,864.48,852.52],[2998.88,1539.49,1459.74,1185.01,1550.26,337.21,810,884.43,1880.73,1751.02,785.17,0,2044.36,635.12,2105.39,987.87,3402.72,2959.46,2593.84,445.19,1935.27,1818.08,1595.49,1559.76,1073.48,3109.58,3611.16,2282.62,1144.41,1466.58],[1919.49,1288.52,2339.09,2411.09,1682.43,1737.82,1707.98,2126.23,427.38,1678.47,2078.36,2047.77,0,1628.11,1413.35,1293.72,2512.42,2304.34,1901.9,1992.07,3023.52,569.98,2632.87,2496.22,2186.22,3917.25,3048.06,1590.68,1265.76,2297.61],[2805.06,809.38,955.64,796.19,922.18,289.62,176.38,511.33,1459.71,1741.94,449.66,634.76,1626.05,0,1375.27,763.52,3344.75,2954.18,1863.73,956.91,1527.16,1317.61,1177.99,1051.18,585.08,3590.75,3700.88,1552.51,461.65,962.49],[3313.21,559.08,1217.72,1669.38,617.89,1671.25,1282.08,1442.33,1630.47,2824.92,1640.47,2016.4,1413.86,1376.6,0,1846.5,3906.15,3559.89,537.18,2384.05,1856.67,881.43,1519.51,1374.86,1341.55,4851.84,4324.18,323.93,966.25,1161.41],[2020.13,1276.4,1719.3,1559.85,1533.75,822.51,937.51,1274.98,901.98,980.46,1229.76,987.89,1294.09,763.87,1842.29,0,2635.96,2192.7,2330.75,705.64,2290.82,1383.99,1941.65,1814.83,1348.74,3007.91,2973.26,2019.52,881.31,1726.15],[608.89,3518.85,4308.14,4093.71,3913.18,3268.34,3537.3,3793.13,2306.36,1657.16,3691.9,3403.79,2515.97,3352.71,3909.47,2635.01,0,445.18,4398.02,3121.54,4824.68,3066.1,4504.18,4403.67,3937.58,1846.59,568.06,4086.8,3247.6,4334.22],[449.99,3156.77,3924.54,3649.82,3551.11,2824.45,3126.83,3349.24,1944.98,1213.27,3248.01,2959.9,2379.14,2953.19,3558.88,2191.12,444.87,0,4047.43,2677.65,4380.79,2774.4,4060.29,4024.57,3538.29,1796.26,846.62,3736.21,2885.52,3972.14],[3800.84,1046.62,1750.08,2201.74,1150.25,2158.8,1794.76,1974.69,2118.09,3312.46,2172.83,2503.94,1901.48,1864.14,536.43,2334.05,4393.77,4047.51,0,2871.59,2389.03,1369.06,2051.87,1907.22,1873.91,5339.38,4811.81,439.36,1453.79,1693.78],[2717.72,1812.58,1782.59,1507.87,1866.47,660.06,1126.21,1207.29,1599.57,1469.87,1108.03,446.02,1991.69,951.33,2378.47,706.72,3121.57,2678.31,2866.92,0,2238.84,1969.48,1918.34,1882.62,1396.34,2666.07,3210.19,2555.7,1417.49,1789.44],[4310.56,1800.44,644.15,741.57,1421.4,1575.35,1398.67,1026.15,2905.81,3167.02,1135.78,1933.91,3014.87,1505.78,1859.23,2269.02,4818.72,4375.46,2392.01,2233.6,0,2483.03,340.27,494.52,940.65,4897.99,5027.16,2173.38,1806.71,701.28],[2469.49,756.35,1806.74,2000.21,1150.25,1486.58,1297.1,1715.35,843.51,2087.55,1718.2,1817.24,570.14,1316.92,881.18,1398.22,3062.43,2772.94,1369.73,1963.4,2491.17,0,2100.52,1963.88,1756.29,4326.43,3598.06,1058.51,857.69,1765.26],[3979.07,1414.09,305.19,580.94,1035.05,1257.8,1067.18,734.23,2519.46,2849.47,979.28,1592.71,2628.52,1174.29,1520.27,1937.53,4501.17,4057.91,2053.05,1916.05,339.99,2096.68,0,155.55,595.75,4580.44,4709.61,1834.41,1420.36,362.32],[3857.49,1266.42,160.1,612.45,882.83,1225.16,930.48,701.58,2383.25,2816.82,946.64,1560.07,2492.31,1052.71,1375.18,1815.96,4397.18,4025.26,1907.96,1883.4,492.42,1960.47,155.26,0,500.12,4547.79,4676.96,1689.32,1284.15,217.23],[3391.57,1098.2,399.51,336.95,719.16,738.16,464.55,214.59,2005.32,2329.83,459.65,1073.07,2171.67,586.79,1341.61,1350.03,3931.26,3538.27,1874.38,1396.41,945.44,1753.39,625,499.54,0,4060.8,4189.97,1655.75,907.08,406.36],[2237.4,4283.2,4447.31,4172.59,4540.56,3324.78,3773.92,3872.01,3525.25,2119.7,3772.75,3110.74,3917.37,3591.67,4849.09,3009.45,1845.74,1796.64,5337.55,2665.84,4903.56,4327.55,4583.06,4547.34,4061.06,0,1353.43,5026.33,3888.11,4454.16],[1144.21,3920.85,4578.71,4303.98,4315.19,3478.62,3853.49,4003.41,2709.06,2084.91,3902.17,3614.07,3051.29,3671.24,4322.96,2974.66,567.03,847.19,4811.52,3213.48,5034.96,3601.41,4714.46,4678.74,4192.46,1354.8,0,4500.29,3649.61,4585.56],[3490.51,736.29,1532.35,1984.01,932.52,1848.47,1484.43,1756.96,1807.76,3002.13,1905.53,2193.61,1591.15,1553.81,322.42,2023.72,4083.44,3737.18,437.33,2561.26,2171.3,1058.73,1834.14,1689.49,1656.18,5029.06,4501.48,0,1143.46,1476.04],[2708.48,396.29,1127.56,1144.52,653.64,755.89,441.4,859.66,1098.55,1860.66,862.51,1144.92,1264.9,461.23,962.18,882.24,3248.17,2885.63,1450.63,1419.78,1812,857.57,1421.35,1284.7,919.65,3887.58,3649.92,1139.41,0,1086.09],[3795.19,1053.75,60.74,608.92,670.16,1131.26,837.77,607.69,2185.26,2722.93,852.75,1466.17,2294.32,960.01,1162.51,1723.25,4334.88,3972.34,1695.28,1789.51,699.69,1762.48,362.53,217.88,406.23,4453.9,4583.07,1476.65,1086.16,0]],metadata:{id:"pro-tour",attribution:"openrouteservice.org | OpenStreetMap contributors",service:"matrix",timestamp:1763588149360,query:{locations:[[-112.263,33.528],[-84.4,33.75555555555555],[-76.62277777777777,39.278055555555554],[-78.787,42.774],[-80.85277777777777,35.225833333333334],[-87.6167,41.8623],[-84.516,39.095],[-81.699444,41.506111],[-97.09277777777777,32.74777777777778],[-104.9849,39.7392],[-83.04555555555555,42.34],[-88.06222222222222,44.50138888888889],[-95.41083333333334,29.684722222222224],[-86.16380555555556,39.76005555555555],[-81.6375,30.323888888888888],[-94.483889,39.048889],[-118.339,33.953],[-115.18388888888889,36.09055555555556],[-80.2388888888889,25.958055555555553],[-93.258,44.974],[-71.264,42.091],[-90.08111111111111,29.950833333333332],[-74.074444,40.813611],[-75.1675,39.90083333333333],[-80.015833,40.446667],[-122.3316,47.5952],[-121.97,37.403],[-82.50333333333333,27.97583333333333],[-86.7713888888889,36.16638888888889],[-76.864444,38.907778]],profile:"driving-car",profileName:"driving-car",responseType:"json",id:"pro-tour",metrics:["distance","duration"],units:"km"},engine:{version:"9.5.0",build_date:"2025-10-31T12:33:09Z",graph_date:"2025-11-16T10:59:23Z",osm_date:"2025-11-10T00:59:58Z"}}},Jf=1e3,gt=60*60*1e3;function Ya(i,{endOfDay:e=!1}={}){return jl(i,{endOfDay:e})}function Xf(i,{dateStart:e,dateEnd:t}={}){if(!Array.isArray(i))throw new TypeError("Schedule must be an array of games.");const n=Ya(e,{endOfDay:!1}),r=Ya(t,{endOfDay:!0});if(n!==null&&r!==null&&r<n)throw new Error("Date end must be greater than or equal to date start.");return i.filter(a=>!!(a!=null&&a.game_id)&&!!(a!=null&&a.gamedate)&&(a==null?void 0:a.game_type)==="REG"&&Number.isFinite(a==null?void 0:a.week)).map(a=>{const o=Date.parse(a.gamedate);return Number.isFinite(o)?{...a,gamedateTimestamp:o}:null}).filter(a=>!(!a||n!==null&&a.gamedateTimestamp<n||r!==null&&a.gamedateTimestamp>r)).sort((a,o)=>a.gamedateTimestamp-o.gamedateTimestamp)}function Qf(i){const e=()=>null;if(!i||!Array.isArray(i.stadiums)||!Array.isArray(i.durations))return e;const t=Array.isArray(i.distances)?i.distances:null,n=new Map;return i.stadiums.forEach((r,a)=>{r!=null&&r.stadium_id&&!n.has(r.stadium_id)&&n.set(r.stadium_id,a)}),(r,a)=>{const o=n.get(r),s=n.get(a);if(o===void 0||s===void 0)return null;const l=i.durations[o];if(!Array.isArray(l))return null;const u=l[s];if(!Number.isFinite(u))return null;let c=null;const d=t==null?void 0:t[o],h=Array.isArray(d)?d[s]:null;return Number.isFinite(h)&&(c=h),{travelDurationMs:u*Jf,travelDistanceKm:c}}}function eg(i){const e=Number.isFinite(i==null?void 0:i.maxTimeToNextGameMs)?i.maxTimeToNextGameMs:((i==null?void 0:i.maxTimeToNextGameHours)??0)*gt;if(!Number.isFinite(e)||e<=0)throw new Error("Restrictions must define a positive maximum time.");const t=[["oneDayGap","maxDriveOneDayGap"],["twoDayGap","maxDriveTwoDayGap"],["threeDayGap","maxDriveThreeDayGap"],["fourDayGap","maxDriveFourDayGap"]].map(([u,c])=>{const d=i==null?void 0:i[u],h=i==null?void 0:i[c];return!Number.isFinite(d)||d<=0||!Number.isFinite(h)||h<0?null:{gapMs:d*gt,maxDriveMs:h*gt}}).filter(Boolean).sort((u,c)=>u.gapMs-c.gapMs);if(t.length===0)throw new Error("Restrictions must include at least one valid gap rule.");const n=t[0].gapMs;if(e<=n)throw new Error("Maximum time between games must be greater than the minimum time.");const r=Number(_e==null?void 0:_e.minTimeToNextGameHoursFlight),a=Number(i==null?void 0:i.minTimeToNextGameHoursFlight),o=Number.isFinite(a)&&a>=0?a:Number.isFinite(r)&&r>=0?r:36,s=Math.max(0,o*gt),l=!!((i==null?void 0:i.allowFlights)??(_e==null?void 0:_e.allowFlights)??!1);return{minMs:n,maxMs:e,gapRules:t,allowFlights:l,minFlightMs:s}}function tg(i,e){e.forEach(t=>{i.hasNode(t.game_id)||i.addNode(t.game_id,{...t})})}function ng(i,e,t){if(!Number.isFinite(t)||!Array.isArray(i)||i.length===0)return!0;if(t>=e)return!1;let n=null;for(const r of i)if(e>=r.gapMs)n=r;else break;return n?t<=n.maxDriveMs:!0}function ig(i,e){return!(i!=null&&i.allowFlights)||!Number.isFinite(i.minFlightMs)?!1:e>=i.minFlightMs}function rg(i,e,t,n){for(let r=0;r<e.length;r+=1){const a=e[r];for(let o=r+1;o<e.length;o+=1){const s=e[o],l=s.gamedateTimestamp-a.gamedateTimestamp;if(l<t.minMs)continue;if(l>t.maxMs)break;const u=`${a.game_id}->${s.game_id}`;if(i.hasEdge(u))continue;const c=n(a.stadium_id,s.stadium_id),d=c==null?void 0:c.travelDurationMs;if(!Number.isFinite(d))continue;const h=Number.isFinite(c==null?void 0:c.travelDistanceKm)?c.travelDistanceKm:null;let f=!1;if(!ng(t.gapRules,l,d)){if(!ig(t,l))continue;f=!0}const m={timeBetweenGamesMs:l,timeBetweenGamesHours:l/gt,travelDurationMs:d,travelDurationHours:d/gt,travelBufferMs:l-d,travelBufferHours:(l-d)/gt,travelDistanceKm:h,isFlight:f};i.addDirectedEdgeWithKey(u,a.game_id,s.game_id,m)}}}function Hs({schedule:i,routeCosts:e=nn,restrictions:t=_e,stadiumWeights:n,teamWeights:r}={}){const a=Xf(i,{dateStart:t==null?void 0:t.dateStart,dateEnd:t==null?void 0:t.dateEnd}),o=eg(t),s=Qf(e),l=new ee({type:"directed",multi:!1,allowSelfLoops:!1}),u=n??ei(),c=r??Qn(),d=a.filter(h=>ag(h,u,c));return tg(l,d),rg(l,d,o,s),l}function ag(i,e,t){return!i||og(i.stadium_id,e)<=0||Za(i.home_team,t)<=0?!1:Za(i.away_team,t)>0}function og(i,e){const t=typeof i=="string"||typeof i=="number"?String(i).trim():"";if(!t)return 1;const n=Number(e==null?void 0:e[t]);return Number.isFinite(n)?n:1}function Za(i,e){const t=typeof i=="string"||typeof i=="number"?String(i).trim().toUpperCase():"";if(!t)return 1;const n=Number(e==null?void 0:e[t]);return Number.isFinite(n)?n:1}const sg="route-graph-dialog",pn={outerBorder:"#999",borderFallback:"#999",nodeFallback:"#f00",labelEdge:"#999",labelSelected:"#0f172a",labelConnected:"#ccc",edgeDefault:"#aaa",edgeMuted:"#999",edgeReachable:"#7f7",edgeFlightIncoming:"#faa",edgeFlightOutgoing:"#f44"},lg={outerBorder:"--color-graph-node-outer-border",borderFallback:"--color-graph-node-border-fallback",nodeFallback:"--color-graph-node-fallback",labelEdge:"--color-graph-edge-label",labelSelected:"--color-graph-label-selected",labelConnected:"--color-graph-label-connected",edgeDefault:"--color-graph-edge-default",edgeMuted:"--color-graph-edge-muted",edgeReachable:"--color-graph-edge-reachable",edgeFlightIncoming:"--color-graph-edge-flight-incoming",edgeFlightOutgoing:"--color-graph-edge-flight-outgoing"};let ye=js();const Ws=.5,ug=Ns({borders:[{size:{value:.1},color:{attribute:"outerBorderColor"}},{size:{attribute:"borderSize",defaultValue:Ws},color:{attribute:"borderColor",defaultValue:ye.borderFallback}},{size:{fill:!0},color:{attribute:"color",defaultValue:ye.nodeFallback}}]});function cg({dialogKit:i,stadiumLookup:e,openHelpTopic:t,onDialogClose:n}){let r=null;function a(){r&&(r.kill(),r=null)}function o(){ye=js(),i.open({title:T("dialog.routingGraph.title"),size:"graph",id:sg,onClose:()=>{a(),n==null||n()},build({body:l,actions:u,close:c}){const d=document.createElement("div");d.className="graph-modal-layout";const h=document.createElement("div");h.className="graph-canvas",h.setAttribute("role","application");const f=document.createElement("aside");f.className="graph-details-panel";const p=document.createElement("div");p.id="game-details",p.className="details-body",Bn(p),f.append(p),d.append(h,f),l.appendChild(d);const m=mn({topicId:"help-dialog-routing-graph",openHelpTopic:t}),y=document.createElement("button");return y.type="button",y.textContent=T("button.close"),y.classList.add("btn","btn-text","btn-primary"),y.addEventListener("click",c),u.append(m,y),s(h,p),{focusTarget:h}}})}async function s(l,u){a();const c=Te(),d=await lr(),h=dg(c,d);r=new Eh(h,l,{renderLabels:!0,renderEdgeLabels:!0,labelColor:{attribute:"labelColor",color:ye.labelEdge},edgeLabelColor:{color:ye.labelEdge},defaultNodeType:"border",nodeProgramClasses:{border:ug},defaultEdgeType:"arrow",enableEdgeHoverEvents:!0});let f=null,p=null;const m=new Set,y=new Set,k=new Set,v=new Set;function b(g){m.clear(),y.clear(),k.clear(),v.clear(),!(!g||!h.hasNode(g))&&(m.add(g),h.forEachOutNeighbor(g,w=>{m.add(w)}),h.forEachOutEdge(g,w=>{y.add(w)}),h.forEachInNeighbor(g,w=>{m.add(w),k.add(w)}),h.forEachInEdge(g,w=>{y.add(w),v.add(w)}))}r.setSetting("nodeReducer",(g,w)=>{const _=f??p,x=p===g,S=w.label??"",N=x?{...w,label:S,forceLabel:!0,labelColor:ye.labelSelected,highlighted:!0,class:"selected-node"}:{...w,label:"",forceLabel:!1};if(!_)return N;if(g===_||m.has(g)){const M={...N,label:S,forceLabel:!0,labelColor:g===_||g===p?ye.labelSelected:ye.labelConnected};if(k.has(g)&&g!==_){const E=Xa(M,.4);return{...E,size:Math.max((E.size??5.5)*.9,2.5)}}return M}if(x)return N;const L=Xa(N,.25);return{...L,size:Math.max((L.size??5.5)*.75,2.5),label:"",forceLabel:!1}}),r.setSetting("edgeReducer",(g,w)=>{const _=f??p,x=hg(w.travelDurationHours),S=_?x:"";if(!_)return{...w,color:ye.edgeDefault,label:S};if(y.has(g)){const N=v.has(g),L=!!w.isFlight,M=N?ye.edgeMuted:ye.edgeReachable,E=L?N?ye.edgeFlightIncoming:ye.edgeFlightOutgoing:M;return{...w,color:E,label:S}}return{...w,hidden:!0,label:""}}),r.on("enterNode",({node:g})=>{f=g,b(g),r.refresh();const w=h.getNodeAttributes(g);Oi(u,w,e)}),r.on("leaveNode",()=>{if(f=null,b(p),r.refresh(),p!=null){const g=h.getNodeAttributes(p);Oi(u,g,e)}else Bn(u)}),r.on("downNode",({node:g})=>{p=g,f=null,b(g),r.refresh();const w=h.getNodeAttributes(g);Oi(u,w,e)}),r.on("clickStage",()=>{f=null,p=null,b(null),r.refresh(),Bn(u)}),Bn(u)}return{openGraphModal:o,dispose:a}}function Oi(i,e,t){const n=Number.isFinite(e.week)?e.week:T("label.unknown"),r=e.game_label&&String(e.game_label).trim().length>0?`${n} - ${e.game_label}`:`${n}`,a=e.stadium_id?t.get(e.stadium_id):null,o=(a==null?void 0:a.location_name)??T("label.unknown"),s=e.stadium??e.stadium_id??T("label.unknown"),l=e.away_team??T("label.unknown"),u=e.home_team??T("label.unknown");i.innerHTML=`
    <div>${T("label.week")} ${r}</div>  
    <h3>${l} @ ${u}</h3>
    <dl>
      <dt>${T("label.kickoff")}</dt>
      <dd>${po(e,t)}</dd>
      <dt>${T("label.stadium")}</dt>
      <dd>${s}</dd>
      <dt>${T("label.location")}</dt>
      <dd>${o}</dd>
    </dl>
  `}function Bn(i){i.innerHTML=`<h3>${T("label.gameDetailsHeading")}</h3><p>${T("message.graphSelectPrompt")}</p>`}function dg(i,e){const t=Hs({restrictions:i,routeCosts:nn,schedule:e}),n=new Map;(co??[]).forEach(b=>{if(b!=null&&b.team){const g=b.color_city_dot||b.color_helmet_shell||b.color_helmet_logo||ye.borderFallback,w=b.color_city_border||b.color_helmet_logo||g||ye.borderFallback;n.set(b.team.toUpperCase(),{fill:g,border:w})}});const r=new Map,a=[],o=[];((nn==null?void 0:nn.stadiums)??[]).forEach(b=>{const g=Array.isArray(b==null?void 0:b.location)?b.location:null;b!=null&&b.stadium_id&&g&&g.length===2&&Number.isFinite(g[0])&&Number.isFinite(g[1])&&(r.set(b.stadium_id,g),a.push(g[0]),o.push(g[1]))});const s=a.length>0&&o.length>0,l=s?Math.min(...a):-130,u=s?Math.max(...a):-60,c=s?Math.min(...o):24,d=s?Math.max(...o):50,h=Math.max(u-l,1e-6),f=Math.max(d-c,1e-6),p=100/Math.max(h,f),m=h*p,y=f*p,k=m*1.5;function v(b){if(!b)return[0,0];let g=0;for(let S=0;S<b.length;S+=1)g=g*31+b.charCodeAt(S)|0;const w=.6,_=((g&4095)/4095-.5)*w,x=((g>>12&4095)/4095-.5)*w;return[_,x]}return t.forEachNode((b,g,w)=>{const _=r.get(g.stadium_id),x=_?_[0]:l+h/2,S=_?_[1]:c+f/2,N=(x-l)/h,L=(S-c)/f*3,M=Number.isFinite(g.week)?g.week:1,E=g.game_label&&String(g.game_label).trim().length>0?T("label.graphNodeTagSuffix",{tag:g.game_label}):"",A=Number.isFinite(g.week)?g.week:T("label.unknown"),F=g.away_team??T("label.unknown"),G=g.home_team??T("label.unknown"),W=T("label.graphNode",{week:A,away:F,home:G,tagSuffix:E}),Z=typeof g.home_team=="string"?g.home_team.toUpperCase():"",P=Z&&n.has(Z)?n.get(Z):null,V=(P==null?void 0:P.fill)??pn.nodeFallback,K=(P==null?void 0:P.border)??V??pn.borderFallback,[ne,fe]=v(g.game_id??String(w)),ae=N*m+(M-1)*k+ne,ke=L*y+fe;t.setNodeAttribute(b,"x",ae),t.setNodeAttribute(b,"y",ke),t.setNodeAttribute(b,"size",4),t.setNodeAttribute(b,"label",W),t.setNodeAttribute(b,"color",V),t.setNodeAttribute(b,"borderColor",K),t.setNodeAttribute(b,"outerBorderColor",ye.outerBorder),t.setNodeAttribute(b,"borderSize",Ws),t.setNodeAttribute(b,"type","border")}),t.forEachEdge(b=>{t.setEdgeAttribute(b,"color",ye.edgeDefault)}),t}function Ja(i,e){return Qa(i,e)??Qa(pn.borderFallback,e)}function Xa(i,e){const t=Ja(i.color,e),n=i.borderColor??i.color??ye.borderFallback,r=Ja(n,e);return{...i,color:t,borderColor:r}}function js(){if(typeof window>"u"||typeof document>"u")return{...pn};const i=getComputedStyle(document.documentElement);return Object.fromEntries(Object.entries(pn).map(([e,t])=>{var a;const n=lg[e];if(!n)return[e,t];const r=(a=i.getPropertyValue(n))==null?void 0:a.trim();return[e,r||t]}))}function Qa(i,e){if(!i)return null;const t=i.trim();if(!t)return null;if(t.startsWith("#")){const r=t.slice(1);if(r.length===6){const a=parseInt(r.slice(0,2),16),o=parseInt(r.slice(2,4),16),s=parseInt(r.slice(4,6),16);return`rgba(${a}, ${o}, ${s}, ${e})`}return null}const n=t.match(/\d+(\.\d+)?/g);if(n&&n.length>=3){const[r,a,o]=n.map(Number);return`rgba(${r}, ${a}, ${o}, ${e})`}return null}function hg(i){return Number.isFinite(i)?(Math.ceil(i*10-1e-9)/10).toFixed(1):""}const fg=typeof globalThis<"u"&&typeof globalThis.requestAnimationFrame=="function"?()=>new Promise(i=>globalThis.requestAnimationFrame(()=>i())):()=>new Promise(i=>setTimeout(i,0)),zi=24,gg=60*1e3,at=60*60*1e3,eo=5e3,to=2e3,pg=6,mg=32,bg=new Set(["sunday","monday","thursday"]),yg=new Set(["mnf","tnf","snf","friday"]);function vg(i){if(typeof i!="string")return null;const e=i.trim().toLowerCase();return!e||e==="any day"?null:bg.has(e)?e:null}function _g(i){if(!i)return!1;const e=typeof i.game_label=="string"?i.game_label.trim():"";if(!e)return!1;const t=e.toLowerCase();return!yg.has(t)}function wg(i,e){return i?e[String(i)]??1:1}function kg(i,e,t){const n=i?t[String(i).toUpperCase()]??1:1,r=e?t[String(e).toUpperCase()]??1:1;return Math.max(n,r)}function hn(i,e=.1){return Number.isFinite(i)?i<=0?0:i>=1?1:i:e}function xg(i,e,t,n=!1){if(!Number.isFinite(i)||i<=0)return 1;const r=n?e==null?void 0:e.flight:e==null?void 0:e.drive,a=r==null?void 0:r.min,o=r==null?void 0:r.max;if(!Number.isFinite(a)||!Number.isFinite(o)||o<=a)return 1;const s=Math.min(Math.max(i,a),o),l=(o-s)/(o-a),u=hn(t);return u+(1-u)*l}function Sg(i,e,t){return!i||((e==null?void 0:e.get(i))??0)<=0?1:hn(t)}function Eg(i,e,t,n){const r=wg(i.stadium_id,e);if(r<=0)return 0;const a=kg(i.home_team,i.away_team,t);if(a<=0)return 0;const o=_g(i)?n:1;return o<=0?0:r*a*o}function or({baseScore:i,travelDurationMs:e,travelStats:t,travelMultiplierFloor:n,travelMultiplierCeilingFlight:r,revisitMultiplierFloor:a,visitedStadiumCounts:o,stadiumId:s,isFlight:l=!1}){if(i<=0)return 0;const u=xg(e,t,n,l);if(u<=0)return 0;const c=l?u*r:u;if(c<=0)return 0;const d=Sg(s,o,a);return d<=0?0:i*c*d}function no(i){if(!i||i.size===0)return"__none__";const e=[];return i.forEach((t,n)=>{t>0&&e.push(String(n))}),e.length===0?"__none__":(e.sort(),e.join("|"))}function rn(i,e){if(!i||!e)return;const t=(i.get(e)??0)+1;i.set(e,t)}function en(i,e){if(!i||!e)return;const t=i.get(e)??0;t<=1?i.delete(e):i.set(e,t-1)}function Tg(i,e,t){i.push(t),i.sort((n,r)=>r.score-n.score),i.length>e&&(i.length=e)}function Cg(i,e){return e.map(t=>({id:t,attributes:{...i.getNodeAttributes(t)}}))}function Ng(i,e,t,n,r){if(!Array.isArray(e)||e.length===0)return[];const a=[],o=new Map;let s=null;for(const l of e){const u=i.getNodeAttributes(l),c=s?`${s}->${l}`:null,d=c?i.getEdgeAttributes(c):null,h=Number.isFinite(d==null?void 0:d.travelDurationMs)?d.travelDurationMs:null,f=Number.isFinite(d==null?void 0:d.travelDistanceKm)?d.travelDistanceKm:null,p=n.get(l)??0,m=or({baseScore:p,travelDurationMs:h??0,travelStats:t,travelMultiplierFloor:r.travel,travelMultiplierCeilingFlight:r.travelFlight,revisitMultiplierFloor:r.revisit,visitedStadiumCounts:o,stadiumId:u.stadium_id,isFlight:!!(d!=null&&d.isFlight)});a.push({nodeKey:l,score:Number.isFinite(m)?m:null,travelDurationMs:s&&Number.isFinite(h)?h:null,travelDistanceKm:s&&Number.isFinite(f)?f:null,isFlight:s?!!(d!=null&&d.isFlight):null}),rn(o,u.stadium_id),s=l}return a}async function Ag({progressInterval:i=eo,yieldInterval:e=to,onProgress:t,shouldAbort:n,restrictions:r,schedule:a,routeCosts:o,stadiumWeights:s,teamWeights:l}={}){const u=r??Te(),c=Math.trunc(u.maxRoutesToFind),d=u.maxTourLengthDays,h=s??ei(),f=l??Qn(),p=Hs({schedule:a,routeCosts:o,restrictions:u,stadiumWeights:h,teamWeights:f}),m=Math.max(1,i??eo),y=Math.max(1,e??to),k=d*zi*at,v=[],b=new Set,g=p.nodes();let _=g.length;const x=Number(u==null?void 0:u.estimatedMaxGamesPerWeek),S=Number.isFinite(x)&&x>0,N=Number(u==null?void 0:u.estimatedMinGamesPerWeek),L=Number.isFinite(N)&&N>0;let M=-1,E=0,A=0,F=0,G=0;const W=Date.now();let Z=W;const P=u==null?void 0:u.enableRouteCache,K=(u==null?void 0:u.cacheBucketHours)*at,ne=P&&K>0,fe=new Map,ae=9,ke=24,Ne=64,Le=new Map;let Oe=!1,pe=1/0,De=-1/0;p.forEachNode((U,$)=>{const H=Number($.week);Number.isFinite(H)&&(H<pe&&(pe=H),H>De&&(De=H))}),Number.isFinite(pe)||(pe=1),(!Number.isFinite(De)||De<pe)&&(De=pe);const ut=Math.max((u==null?void 0:u.oneDayGap)*at,at),Ht=Number(u==null?void 0:u.maxSearchMinutesPerStartGame),ct=Number.isFinite(Ht)&&Ht>0?Ht*gg:null,hi=Number(u==null?void 0:u.beamWidthPerStartGame),Ar=Number.isFinite(hi)&&hi>0?Math.min(Math.trunc(hi),mg):pg,fi=Number(u==null?void 0:u.maxDriveFourDayGap),Lr=Number.isFinite(fi)&&fi>0?fi*at:null,gi=Number(u==null?void 0:u.maxDriveTwoDayGap),Dr=Number.isFinite(gi)&&gi>0?gi*at:null,wt={drive:{min:1/0,max:-1/0},flight:{min:1/0,max:-1/0}},Fr={drive:{min:1/0,max:-1/0},flight:{min:1/0,max:-1/0}},vn=(U,$)=>{$<U.min&&(U.min=$),$>U.max&&(U.max=$)};p.forEachEdge((U,$)=>{const H=$==null?void 0:$.travelDurationMs;if(!(!Number.isFinite(H)||H<=0)){if($!=null&&$.isFlight){if(vn(Fr.flight,H),Dr!==null&&H<Dr)return;vn(wt.flight,H);return}vn(Fr.drive,H),!(Lr!==null&&H>Lr)&&vn(wt.drive,H)}});const Zs=hn((u==null?void 0:u.revisitMultiplierFloor)??0),Js=hn((u==null?void 0:u.travelMultiplierFloor)??0),Rr=hn((u==null?void 0:u.travelMultiplierCeilingFlight)??0,.4),Xs=(u==null?void 0:u.specialGameDayPenalty)??1,Je={revisit:Zs,travel:Js,travelFlight:Rr>0?Rr:1,specialGameDay:Xs},_n=new Map;let wn=0;p.forEachNode((U,$)=>{const H=Eg($,h,f,Je.specialGameDay);_n.set(U,H),H>wn&&(wn=H)});const Qs=wn>0?wn:1;function Mr(U){return!ne||!Number.isFinite(U)||U<0?null:Math.floor(U/K)}function el(U,$,H){if(!ne||$===null)return null;const q=fe.get(U);if(!q)return null;const B=q.get($);return B?B.get(H)??null:null}function tl(U,$,H,q){if(!ne||$===null||!q)return;let B=fe.get(U);if(!B)B=new Map,fe.set(U,B);else if(!B.has($)&&B.size>=ke){const ce=B.keys().next().value;ce!==void 0&&B.delete(ce)}let j=B.get($);if(!j)j=new Map,B.set($,j);else if(!j.has(H)&&j.size>=Ne){const ce=j.keys().next().value;ce!==void 0&&j.delete(ce)}j.set(H,q)}async function dt(U=!1){if(!t||!U&&A%m!==0)return;const $=v.map(le=>({...le,nodes:le.nodes})),H=Date.now(),q=E+(M>=0?1:0),B=Math.max(_-q,0),j=H-W;let ce=null;if(B>0)if(!Oe&&q<=1)ce=j/Math.max(q,1)*B;else{const le=(Z-W)/Math.max(q,1),ie=Math.min(ct,le)*B,J=H-Z;ce=Math.max(ie-J,0)}await t({evaluatedRoutes:A,bestRoutes:$,elapsedMs:j,totalStartNodes:_,startNodesProcessed:E,currentStartIndex:M,remainingStartNodes:B,estimatedRemainingMs:ce})}async function kn(U,$,H,q){if($<=0)return!1;const B=q-H;U.length;const j=Ng(p,U,wt,_n,Je),ce={score:$,totalDurationMs:B,totalDurationDays:B/(zi*at),nodes:Cg(p,U),nodeMetrics:j};return Tg(v,c,ce),G=v.reduce((le,ie)=>{const J=Array.isArray(ie.nodes)?ie.nodes.length:0;return J>le?J:le},0),A+=1,F+=1,t&&await dt(A===1),F>=y&&(F=0,await fg()),!!(n!=null&&n())}function pi(U,$){return U!=null&&Date.now()>=U?(Oe=!0,{aborted:!1,budgetExceeded:!0,bestSuffixScore:0,bestSuffixNodes:[],bestSuffixEndTimestamp:$,suffixes:[]}):null}function Pr({nodeKey:U,currentTimestamp:$,startTimestamp:H,visitedNodes:q,visitedStadiumCounts:B,pathLength:j}){const ce=p.outEdges(U),le=[];for(const ie of ce){const J=p.target(ie);if(q.has(J))continue;const oe=p.getEdgeAttributes(ie),te=p.getNodeAttributes(J),se=Number.isFinite(te.gamedateTimestamp)?te.gamedateTimestamp:Date.parse(te.gamedate);if(!Number.isFinite(se))continue;const Ee=se-H;if(!Number.isFinite(Ee)||Ee>k)continue;const Ve=se-$;if(!Number.isFinite(Ve)||Ve<0)continue;const Xe=(oe==null?void 0:oe.travelDurationMs)??0,kt=_n.get(J)??0,xt=or({baseScore:kt,travelDurationMs:Xe,travelStats:wt,travelMultiplierFloor:Je.travel,travelMultiplierCeilingFlight:Je.travelFlight,revisitMultiplierFloor:Je.revisit,visitedStadiumCounts:B,stadiumId:te.stadium_id,isFlight:!!(oe!=null&&oe.isFlight)});if(xt<=0)continue;const En=Number.isFinite(oe==null?void 0:oe.travelBufferMs)?oe.travelBufferMs:Ve-Xe,Wt=1/(1+(B.get(te.stadium_id)??0)),Tn=Number.isFinite(te.week)?te.week/18:.5,Cn=1/(j+1),me=Math.random()*.01,Ce=xt*1e3*Wt+En/1e3+Tn*10+Cn+me;le.push({edgeKey:ie,targetNodeKey:J,targetAttributes:te,targetTimestamp:se,edgeAttributes:oe,edgeTravelDurationMs:Xe,nodeScore:xt,priority:Ce})}return le.sort((ie,J)=>J.priority-ie.priority),le}async function nl({startNodeKey:U,startTimestamp:$,startAttributes:H,initialScore:q,beamWidth:B}){const j=new Map;rn(j,H.stadium_id);let le=[{path:[U],score:q,currentNodeKey:U,currentTimestamp:$,visitedNodes:new Set([U]),visitedStadiumCounts:j}];for(;le.length>0;){if(n!=null&&n())return!0;const ie=[];for(const J of le){const oe=Pr({nodeKey:J.currentNodeKey,currentTimestamp:J.currentTimestamp,startTimestamp:$,visitedNodes:J.visitedNodes,visitedStadiumCounts:J.visitedStadiumCounts,pathLength:J.path.length});if(oe.length===0)continue;const te=oe.slice(0,B);for(const se of te){const Ee=new Set(J.visitedNodes);Ee.add(se.targetNodeKey);const Ve=new Map(J.visitedStadiumCounts);rn(Ve,se.targetAttributes.stadium_id);const Xe=J.score+se.nodeScore,kt=[...J.path,se.targetNodeKey];if(await kn(kt,Xe,$,se.targetTimestamp))return!0;ie.push({path:kt,score:Xe,currentNodeKey:se.targetNodeKey,currentTimestamp:se.targetTimestamp,visitedNodes:Ee,visitedStadiumCounts:Ve})}}if(ie.length===0)break;ie.sort((J,oe)=>oe.score-J.score),le=ie.slice(0,B)}return!1}async function Ir(U,$,H,q,B,j,ce,le,ie){var Cn;if(n!=null&&n())return{aborted:!0,bestSuffixScore:0,bestSuffixNodes:[],bestSuffixEndTimestamp:B,suffixes:[]};if(await kn($,H,q,B))return{aborted:!0,bestSuffixScore:0,bestSuffixNodes:[],bestSuffixEndTimestamp:B,suffixes:[]};const oe=pi(ie,B);if(oe)return oe;let te=0,se=[],Ee=B;const Ve=[],Xe=Math.max(0,k-(B-q)),kt=Mr(Xe);if(v.length>=c){const me=((Cn=v[v.length-1])==null?void 0:Cn.score)??0;let Ce=Math.max(0,Math.floor(Xe/ut));if(G>$.length){const Fe=G-$.length;Fe>=0&&(Ce=Math.min(Ce,Fe))}if(H+Ce*Qs<=me)return{aborted:!1,bestSuffixScore:0,bestSuffixNodes:[],bestSuffixEndTimestamp:B,suffixes:[]}}const xt=no(j),En=pi(ie,B);if(En)return En;const zr=Pr({nodeKey:U,currentTimestamp:B,startTimestamp:q,visitedNodes:b,visitedStadiumCounts:j,pathLength:$.length});for(const me of zr){const Ce=pi(ie,B);if(Ce)return Ce;if(n!=null&&n())return{aborted:!0,bestSuffixScore:te,bestSuffixNodes:se,bestSuffixEndTimestamp:Ee,suffixes:[]};const{targetNodeKey:be,targetAttributes:Fe,targetTimestamp:ze,edgeAttributes:$g,edgeTravelDurationMs:Og,nodeScore:St}=me,vi=ze-B,ol=ze-q,Br={nodes:[be],totalScore:St,endTimestamp:ze,totalDurationMs:vi},sl=Math.max(0,k-ol),ll=Mr(sl);rn(j,Fe.stadium_id);const ul=no(j),Re=el(be,ll,ul),_i=H+St;if(Re&&Array.isArray(Re.suffixes)){const de=[...$,be];let it=await kn(de,_i,q,ze);if(it)return en(j,Fe.stadium_id),{aborted:!0,bestSuffixScore:te,bestSuffixNodes:se,bestSuffixEndTimestamp:Ee,suffixes:[]};const ki=[Br];for(const ve of Re.suffixes){if(!ve||!Array.isArray(ve.nodes))continue;const Et=ve.nodes,Ur=Number.isFinite(ve.totalScore)?ve.totalScore:0,dl=Number.isFinite(ve.totalDurationMs)?ve.totalDurationMs:0,Hr=Number.isFinite(ve.endTimestamp)?ve.endTimestamp:ze;if(Et.length>0&&(it=await kn([...de,...Et],_i+Ur,q,Hr),it))return en(j,Fe.stadium_id),{aborted:!0,bestSuffixScore:te,bestSuffixNodes:se,bestSuffixEndTimestamp:Ee,suffixes:[]};ki.push({nodes:[be,...Et],totalScore:St+Ur,endTimestamp:Hr,totalDurationMs:vi+dl})}for(const ve of ki){const Et=Number.isFinite(ve.totalScore)?ve.totalScore:0;Et>te&&(te=Et,se=[...ve.nodes],Ee=ve.endTimestamp??ze)}if(Number.isFinite(Re.bestSuffixScore)&&Re.bestSuffixScore>0){const ve=St+Re.bestSuffixScore;ve>te&&(te=ve,se=Re.bestSuffixNodes&&Re.bestSuffixNodes.length>0?[be,...Re.bestSuffixNodes]:[be],Ee=Re.bestSuffixNodes&&Re.bestSuffixNodes.length>0?Re.bestSuffixEndTimestamp:ze)}Ve.push(...ki),en(j,Fe.stadium_id);continue}b.add(be),$.push(be);const Be=await Ir(be,$,_i,q,ze,j,ce,le,ie);if($.pop(),b.delete(be),Be.aborted||Be.budgetExceeded)return en(j,Fe.stadium_id),Be;const cl=Array.isArray(Be.suffixes)?Be.suffixes:[],wi=[Br];for(const de of cl){if(!de||!Array.isArray(de.nodes))continue;const it=Number.isFinite(de.totalScore)?de.totalScore:0;wi.push({nodes:[be,...de.nodes],totalScore:St+it,endTimestamp:de.nodes.length>0&&Number.isFinite(de.endTimestamp)?de.endTimestamp:ze,totalDurationMs:vi+(Number.isFinite(de.totalDurationMs)?de.totalDurationMs:0)})}for(const de of wi){const it=Number.isFinite(de.totalScore)?de.totalScore:0;it>te&&(te=it,se=[...de.nodes],Ee=de.endTimestamp??ze)}if(Be.bestSuffixScore>0){const de=St+Be.bestSuffixScore;de>te&&(te=de,se=Be.bestSuffixNodes.length>0?[be,...Be.bestSuffixNodes]:[be],Ee=Be.bestSuffixNodes.length>0?Be.bestSuffixEndTimestamp:ze)}Ve.push(...wi),en(j,Fe.stadium_id)}const Wt=new Map;for(const me of Ve){if(!me||!Array.isArray(me.nodes)||me.nodes.length===0)continue;const Ce=me.nodes.join("->"),be=Wt.get(Ce),Fe=Number.isFinite(me.totalScore)?me.totalScore:0;(!be||Fe>(Number.isFinite(be.totalScore)?be.totalScore:0))&&Wt.set(Ce,{nodes:[...me.nodes],totalScore:Fe,endTimestamp:me.endTimestamp,totalDurationMs:me.totalDurationMs})}const Tn=Array.from(Wt.values()).sort((me,Ce)=>(Number.isFinite(Ce.totalScore)?Ce.totalScore:0)-(Number.isFinite(me.totalScore)?me.totalScore:0)).slice(0,ae);return ne&&tl(U,kt,xt,{suffixes:Tn,bestSuffixScore:te,bestSuffixNodes:se,bestSuffixEndTimestamp:Ee}),{aborted:!1,bestSuffixScore:te,bestSuffixNodes:se,bestSuffixEndTimestamp:Ee,suffixes:Tn}}const xn=[],mi=d/7,Sn=Number.isFinite(De)?De:null,il=L?Math.max(1,Math.ceil(mi*N)):1,rl=S?Math.max(1,Math.ceil(mi*x)):1/0,al=u==null?void 0:u.shortWindowDays,bi=Number.isFinite(u==null?void 0:u.dateStart)?u.dateStart:Number(Date.parse(u==null?void 0:u.dateStart)),yi=Number.isFinite(u==null?void 0:u.dateEnd)?u.dateEnd:Number(Date.parse(u==null?void 0:u.dateEnd)),Gr=Number.isFinite(bi)&&Number.isFinite(yi)&&yi>=bi?(yi-bi+1)/(zi*at):null,$r=Number.isFinite(Gr)&&Gr<=al,Or=vg(u==null?void 0:u.requiredStartDayOfWeek);for(const U of g){const $=p.getNodeAttributes(U),H=Number.isFinite($.gamedateTimestamp)?$.gamedateTimestamp:Date.parse($.gamedate);if(!Number.isFinite(H)||Or&&(typeof $.weekday=="string"?$.weekday.trim().toLowerCase():"")!==Or)continue;let q=!0;if(!$r){const B=Number($.week),j=Number.isFinite(B)&&Number.isFinite(Sn)?Math.max(Sn-B+1,0):null;if(j!==null&&j<=0)q=!1;else if(L||S){let ce=1/0;if(S){const le=j!==null?Math.max(0,Math.ceil(j*x)):1/0,ie=Math.max(0,Math.ceil(mi*x));ce=Math.min(le,ie,rl)}q=ce>=il}}q&&xn.push({nodeKey:U,startTimestamp:H})}_=xn.length,await dt(!0);for(let U=0;U<xn.length;U+=1){const{nodeKey:$,startTimestamp:H}=xn[U];if(n!=null&&n())break;const q=p.getNodeAttributes($);if(!$r&&S&&G>0){const oe=Number(q.week),te=Number.isFinite(oe)&&Number.isFinite(Sn)?Math.max(Sn-oe+1,0):null;if(te!==null&&Math.max(1,Math.ceil(te*x))<G){E+=1,await dt(!0);continue}}M=U,Z=Date.now(),await dt(!0),b.clear(),b.add($),Le.clear();const B=_n.get($)??0,j=or({baseScore:B,travelDurationMs:0,travelStats:wt,travelMultiplierFloor:Je.travel,travelMultiplierCeilingFlight:Je.travelFlight,revisitMultiplierFloor:Je.revisit,visitedStadiumCounts:Le,stadiumId:q.stadium_id,isFlight:!1});if(j<=0){E+=1,M=-1,await dt(!0);continue}rn(Le,q.stadium_id);const ce=[$],le=ct!=null?Date.now()+ct:null,ie=await Ir($,ce,j,H,H,Le,wt,Je,le);let J=ie.aborted;if(!J&&ie.budgetExceeded&&ct!=null&&Ar>0&&await nl({startNodeKey:$,startTimestamp:H,startAttributes:q,initialScore:j,beamWidth:Ar})&&(J=!0),E+=1,M=-1,Le.clear(),await dt(!0),J)break}return await dt(!0),{routes:v,evaluatedRoutes:A,elapsedMs:Date.now()-W,totalStartNodes:_,startNodesProcessed:E}}function Lg({routesView:i,controls:e}){let t=null,n=0;function r(){if(bo()){o();return}i.reset(),a()}function a(){e.setSearchState(!0),t={aborted:!1},s(t).catch(l=>{console.error("Unable to compute routes:",l),e.setSearchState(!1),i.showProgress({evaluatedRoutes:0,bestRoutes:[],elapsedMs:0,totalStartNodes:0,startNodesProcessed:0,remainingStartNodes:0,estimatedRemainingMs:null,isComplete:!0,aborted:!0})})}function o(){t&&(t.aborted=!0)}async function s(l){const u=++n;i.showProgress({evaluatedRoutes:0,bestRoutes:[],elapsedMs:0,totalStartNodes:0,startNodesProcessed:0,remainingStartNodes:0,estimatedRemainingMs:null,isComplete:!1});try{const d=()=>typeof performance<"u"&&typeof performance.now=="function"?performance.now():Date.now();let h=0,f=null,p=null;const m=S=>{l!==t||l!=null&&l.aborted||n!==u||i.showProgress({...S,isComplete:!1})},y=()=>{if(p=null,!f)return;const S=f;f=null,h=d(),m(S)},k=S=>{if(l!==t||l!=null&&l.aborted||n!==u)return;const N=d();if(N-h>=300&&!f){h=N,m(S);return}if(f=S,!p){const L=Math.max(300-(N-h),0);p=setTimeout(y,L)}},v=await lr(),b=await Ag({schedule:v,onProgress:k,shouldAbort:()=>(l==null?void 0:l.aborted)||n!==u}),g=(b==null?void 0:b.routes)??[],w={elapsedMs:(b==null?void 0:b.elapsedMs)??0};i.setRoutes(g,w);const _=(b==null?void 0:b.totalStartNodes)??0,x=(b==null?void 0:b.startNodesProcessed)??_;i.showProgress({evaluatedRoutes:(b==null?void 0:b.evaluatedRoutes)??0,bestRoutes:g,elapsedMs:(b==null?void 0:b.elapsedMs)??0,totalStartNodes:_,startNodesProcessed:x,remainingStartNodes:Math.max(_-x,0),estimatedRemainingMs:null,isComplete:!0,aborted:!!(l!=null&&l.aborted)})}catch(c){if(l!=null&&l.aborted)return;console.error("Unable to compute routes:",c),i.showProgress({evaluatedRoutes:0,bestRoutes:[],elapsedMs:0,totalStartNodes:0,startNodesProcessed:0,remainingStartNodes:0,estimatedRemainingMs:null,isComplete:!0,aborted:!0})}finally{l===t&&(t=null,e.setSearchState(!1))}}return{handleSearchButtonClick:r}}function Dg({toggleButton:i,panel:e,createOverlay:t}){if(!i||!e)return{close(){},dispose(){}};const n=i.closest("[data-app-menu]"),r=Array.from(e.querySelectorAll("[data-menu-close-on-change]"));let a=!1,o=null,s=null,l=null;const u=()=>{const b=T(a?"aria.appMenuClose":"aria.appMenuOpen");i.setAttribute("aria-label",b),i.setAttribute("title",b)},c=()=>{if(l||typeof window>"u")return;const v=b=>{e.contains(b.target)||i.contains(b.target)||f()};window.addEventListener("pointerdown",v,!0),l=()=>{window.removeEventListener("pointerdown",v,!0),l=null}},d=()=>{l&&l()},h=()=>{a||(a=!0,i.setAttribute("aria-expanded","true"),e.hidden=!1,n==null||n.classList.add("app-menu-open"),typeof t=="function"?s=t({className:"app-menu__overlay",onBackgroundPointerDown:()=>{f()}}):c(),window.addEventListener("keydown",m),u())},f=()=>{a&&(a=!1,i.setAttribute("aria-expanded","false"),e.hidden=!0,n==null||n.classList.remove("app-menu-open"),s==null||s.dispose(),s=null,d(),window.removeEventListener("keydown",m),u())},p=()=>{a?f():h()},m=v=>{v.key==="Escape"&&(f(),i.focus())},y=v=>{v.target.closest("[data-menu-close]")&&f()},k=()=>{f()};return i.addEventListener("click",p),e.addEventListener("click",y),r.forEach(v=>{v.addEventListener("change",k)}),o=Ot(()=>{u()}),u(),e.hidden=!0,{close:f,dispose(){f(),i.removeEventListener("click",p),e.removeEventListener("click",y),r.forEach(v=>{v.removeEventListener("change",k)}),o&&o()}}}const Fg=["help-app-purpose","help-data-sources"],Vs=["system","light","dark"],Ks="pro-tour-planner.theme";Rg().catch(i=>{console.error("Failed to bootstrap tour planner:",i)});async function Rg(){await $l();const i=await Kl();ru(i.scheduleRange);const e=Mg();qs(Ys());const t=Uu();io(),ro(gn()),Pg(e.languageSelect),Ig(e.themeSelect),Ot(()=>{io(),m(),y()});const n=gu({ui:e,scheduleRange:i.scheduleRange}),r=pu({root:e.modalRoot});Dg({toggleButton:e.menuToggle,panel:e.menuPanel,createOverlay:r.createOverlay});const a=ju({ui:e,stadiumLookup:i.stadiumLookup,teamLookup:i.teamLookup,favoritesManager:t}),o=()=>{var v;(v=a.refresh)==null||v.call(a)},s=Pc({dialogKit:r,onDialogClose:o}),{openTeamPreferences:l}=Lu({dialogKit:r,teamLookup:i.teamLookup,stadiumLookup:i.stadiumLookup,openHelpTopic:s.openHelpTopic}),{openCityPreferences:u}=vu({dialogKit:r,stadiumLookup:i.stadiumLookup,teamLookup:i.teamLookup,openHelpTopic:s.openHelpTopic}),{openRoutingParameters:c}=wu({dialogKit:r,scheduleRange:i.scheduleRange,controls:n,onExpertModeChange:v=>{ro(v)},openHelpTopic:s.openHelpTopic}),d=Xu({dialogKit:r,favoritesManager:t,stadiumLookup:i.stadiumLookup,teamLookup:i.teamLookup,openHelpTopic:s.openHelpTopic,onDialogClose:o}),h=cg({dialogKit:r,stadiumLookup:i.stadiumLookup,openHelpTopic:s.openHelpTopic,onDialogClose:o}),f=Lg({routesView:a,controls:n});Kt("open-team-preferences",l),Kt("open-city-preferences",u),Kt("open-routing-parameters",c),Kt("open-graph",h.openGraphModal),Kt("open-help",s.openHelp);function p(){e.teamButton.addEventListener("click",l),e.cityButton.addEventListener("click",u),e.routingButton.addEventListener("click",c),e.favoritesButton.addEventListener("click",d.openFavorites),e.showGraphButton.addEventListener("click",h.openGraphModal),e.helpButton.addEventListener("click",s.openHelp),e.searchButton.addEventListener("click",f.handleSearchButtonClick),e.tourStartInput.addEventListener("change",()=>n.handleDateInputChange("dateStart",e.tourStartInput.value)),e.tourEndInput.addEventListener("change",()=>n.handleDateInputChange("dateEnd",e.tourEndInput.value)),e.requiredStartDaySelect.addEventListener("change",()=>n.handleRequiredStartDayChange(e.requiredStartDaySelect.value)),e.maxTourLengthSelect.addEventListener("change",()=>n.handleMaxTourLengthChange(e.maxTourLengthSelect.value)),e.allowFlightsInput.addEventListener("change",()=>n.handleAllowFlightsChange(e.allowFlightsInput.value))}function m(){const v=e.helpTopicsContent,b=e.helpTopicsPanel;if(!v||!b)return;v.innerHTML="";let g=0;Fg.forEach(w=>{const _=Ic(w);_&&(v.appendChild(_),g+=1)}),b.hidden=g===0}function y(){document.querySelectorAll("[data-help-content-block]").forEach(b=>{const g=b.getAttribute("data-help-content-block");if(b.innerHTML="",!g){b.hidden=!0;return}const w=Gc(g);if(!w){b.hidden=!0;return}k(w),b.appendChild(w),b.hidden=!1})}function k(v){v.addEventListener("click",b=>{const g=b.target instanceof Element?b.target.closest("[data-help-topic-link]"):null;if(!g)return;const w=g.getAttribute("data-help-topic-link");w&&(b.preventDefault(),b.stopPropagation(),s.openHelpTopic(w))})}n.initializeDateInputs(),a.initialize(),p(),n.syncDateInputs(),n.setSearchState(!1),m(),y()}function Mg(){return{routesPanel:ue("routes-panel"),routesElement:ue("top-routes"),routesProgressElement:ue("routes-progress"),routesHeading:ue("routes-heading"),teamButton:ue("team-preferences-button"),cityButton:ue("city-preferences-button"),routingButton:ue("routing-parameters-button"),favoritesButton:ue("favorites-button"),showGraphButton:ue("show-graph-button"),helpButton:ue("help-button"),helpTopicsPanel:ue("help-topics-panel"),helpTopicsContent:ue("help-topics-content"),searchButton:ue("search-button"),tourStartInput:ue("tour-start-date"),tourEndInput:ue("tour-end-date"),requiredStartDaySelect:ue("required-start-day"),maxTourLengthSelect:ue("max-tour-length"),allowFlightsInput:ue("allow-flights"),languageSelect:ue("locale-select"),themeSelect:ue("theme-select"),modalRoot:document.getElementById("modal-root"),menuToggle:ue("app-menu-toggle"),menuPanel:ue("app-menu-panel")}}function ue(i){const e=document.getElementById(i);if(!e)throw new Error(`Missing required element: ${i}`);return e}function io(){document.documentElement.lang=st(),document.querySelectorAll("[data-i18n]").forEach(e=>{const t=e.getAttribute("data-i18n");if(!t)return;const n=T(t),r=e.getAttribute("data-i18n-attr");r?e.setAttribute(r,n):e.textContent=n}),document.title=T("label.appTitle")}function ro(i){const e=document.documentElement;e.classList.toggle("expert-on",!!i),e.classList.toggle("expert-off",!i)}function Pg(i){if(!i)return;const e=()=>{const t=st();i.innerHTML="",zl().forEach(n=>{const r=document.createElement("option");r.value=n,r.textContent=T(`option.language.${n}`),i.appendChild(r)}),i.value=t};e(),i.addEventListener("change",t=>{const n=t.target.value;n&&n!==st()&&Ol(n)}),Ot(()=>{e()})}function Ig(i){if(!i)return;const e=()=>{const t=Ys();i.innerHTML="",Vs.forEach(n=>{const r=document.createElement("option");r.value=n,r.textContent=T(`option.theme.${n}`),i.appendChild(r)}),i.value=t};e(),i.addEventListener("change",t=>{const n=Gg(t.target.value);qs(n)}),Ot(()=>{e()})}function qs(i){const e=Nr(i);document.documentElement.setAttribute("data-theme",e)}function Ys(){if(typeof localStorage>"u")return"system";try{const i=localStorage.getItem(Ks);return Nr(i)}catch{return"system"}}function Gg(i){const e=Nr(i);if(typeof localStorage<"u")try{localStorage.setItem(Ks,e)}catch{}return e}function Nr(i){return typeof i=="string"&&Vs.includes(i)?i:"system"}"serviceWorker"in navigator&&window.addEventListener("load",()=>{const i=window.location.hostname,e=["localhost","127.0.0.1","[::1]"].includes(i);!(window.location.protocol==="https:")&&!e||navigator.serviceWorker.register("/service-worker.js").catch(n=>console.error("Service worker registration failed:",n))});
